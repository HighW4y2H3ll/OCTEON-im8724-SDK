<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Octeon Software Development Kit: cvmx-pip.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>cvmx-pip.h</h1><a href="cvmx-pip_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***********************license start***************</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c) 2003-2010  Cavium Inc. (support@cavium.com). All rights</span>
<a name="l00003"></a>00003 <span class="comment"> * reserved.</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00007"></a>00007 <span class="comment"> * modification, are permitted provided that the following conditions are</span>
<a name="l00008"></a>00008 <span class="comment"> * met:</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> *   * Redistributions of source code must retain the above copyright</span>
<a name="l00011"></a>00011 <span class="comment"> *     notice, this list of conditions and the following disclaimer.</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> *   * Redistributions in binary form must reproduce the above</span>
<a name="l00014"></a>00014 <span class="comment"> *     copyright notice, this list of conditions and the following</span>
<a name="l00015"></a>00015 <span class="comment"> *     disclaimer in the documentation and/or other materials provided</span>
<a name="l00016"></a>00016 <span class="comment"> *     with the distribution.</span>
<a name="l00017"></a>00017 <span class="comment"></span>
<a name="l00018"></a>00018 <span class="comment"> *   * Neither the name of Cavium Inc. nor the names of</span>
<a name="l00019"></a>00019 <span class="comment"> *     its contributors may be used to endorse or promote products</span>
<a name="l00020"></a>00020 <span class="comment"> *     derived from this software without specific prior written</span>
<a name="l00021"></a>00021 <span class="comment"> *     permission.</span>
<a name="l00022"></a>00022 <span class="comment"></span>
<a name="l00023"></a>00023 <span class="comment"> * This Software, including technical data, may be subject to U.S. export  control</span>
<a name="l00024"></a>00024 <span class="comment"> * laws, including the U.S. Export Administration Act and its  associated</span>
<a name="l00025"></a>00025 <span class="comment"> * regulations, and may be subject to export or import  regulations in other</span>
<a name="l00026"></a>00026 <span class="comment"> * countries.</span>
<a name="l00027"></a>00027 <span class="comment"></span>
<a name="l00028"></a>00028 <span class="comment"> * TO THE MAXIMUM EXTENT PERMITTED BY LAW, THE SOFTWARE IS PROVIDED &quot;AS IS&quot;</span>
<a name="l00029"></a>00029 <span class="comment"> * AND WITH ALL FAULTS AND CAVIUM INC. MAKES NO PROMISES, REPRESENTATIONS OR</span>
<a name="l00030"></a>00030 <span class="comment"> * WARRANTIES, EITHER EXPRESS, IMPLIED, STATUTORY, OR OTHERWISE, WITH RESPECT TO</span>
<a name="l00031"></a>00031 <span class="comment"> * THE SOFTWARE, INCLUDING ITS CONDITION, ITS CONFORMITY TO ANY REPRESENTATION OR</span>
<a name="l00032"></a>00032 <span class="comment"> * DESCRIPTION, OR THE EXISTENCE OF ANY LATENT OR PATENT DEFECTS, AND CAVIUM</span>
<a name="l00033"></a>00033 <span class="comment"> * SPECIFICALLY DISCLAIMS ALL IMPLIED (IF ANY) WARRANTIES OF TITLE,</span>
<a name="l00034"></a>00034 <span class="comment"> * MERCHANTABILITY, NONINFRINGEMENT, FITNESS FOR A PARTICULAR PURPOSE, LACK OF</span>
<a name="l00035"></a>00035 <span class="comment"> * VIRUSES, ACCURACY OR COMPLETENESS, QUIET ENJOYMENT, QUIET POSSESSION OR</span>
<a name="l00036"></a>00036 <span class="comment"> * CORRESPONDENCE TO DESCRIPTION. THE ENTIRE  RISK ARISING OUT OF USE OR</span>
<a name="l00037"></a>00037 <span class="comment"> * PERFORMANCE OF THE SOFTWARE LIES WITH YOU.</span>
<a name="l00038"></a>00038 <span class="comment"> ***********************license end**************************************/</span>
<a name="l00039"></a>00039 <span class="comment"></span>
<a name="l00040"></a>00040 <span class="comment">/**</span>
<a name="l00041"></a>00041 <span class="comment"> * @file</span>
<a name="l00042"></a>00042 <span class="comment"> *</span>
<a name="l00043"></a>00043 <span class="comment"> * Interface to the hardware Packet Input Processing unit.</span>
<a name="l00044"></a>00044 <span class="comment"> *</span>
<a name="l00045"></a>00045 <span class="comment"> * &lt;hr&gt;$Revision: 137666 $&lt;hr&gt;</span>
<a name="l00046"></a>00046 <span class="comment"> */</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#ifndef __CVMX_PIP_H__</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span><span class="preprocessor">#define __CVMX_PIP_H__</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="cvmx-wqe_8h.html" title="This header file defines the work queue entry (wqe) data structure.">cvmx-wqe.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="cvmx-pki_8h.html" title="Interface to the hardware Packet Input Data unit.">cvmx-pki.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="cvmx-helper-pki_8h.html" title="Helper functions for PKI.">cvmx-helper-pki.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#ifdef CVMX_BUILD_FOR_LINUX_KERNEL</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="cvmx-pip-defs_8h.html">cvmx-pip-defs.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#endif</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="cvmx-helper_8h.html" title="Helper functions for common, but complicated tasks.">cvmx-helper.h</a>&quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;<a class="code" href="cvmx-helper-util_8h.html" title="Small helper utilities.">cvmx-helper-util.h</a>&quot;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="cvmx-pki-resources_8h.html" title="Resource management for PKI resources.">cvmx-pki-resources.h</a>&quot;</span>
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="preprocessor">#ifdef  __cplusplus</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span><span class="comment">/* *INDENT-OFF* */</span>
<a name="l00064"></a>00064 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {
<a name="l00065"></a>00065 <span class="comment">/* *INDENT-ON* */</span>
<a name="l00066"></a>00066 <span class="preprocessor">#endif</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span>
<a name="l00068"></a><a class="code" href="cvmx-pip_8h.html#aa9696230d709079d133642e4b013e364">00068</a> <span class="preprocessor">#define CVMX_PIP_NUM_INPUT_PORTS                46</span>
<a name="l00069"></a><a class="code" href="cvmx-pip_8h.html#a8fb28cb4711233ad0e6cb8a96d98fa7d">00069</a> <span class="preprocessor"></span><span class="preprocessor">#define CVMX_PIP_NUM_WATCHERS                   8</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span>
<a name="l00071"></a>00071 <span class="comment">/*</span>
<a name="l00072"></a>00072 <span class="comment"> * Encodes the different error and exception codes</span>
<a name="l00073"></a>00073 <span class="comment"> */</span>
<a name="l00074"></a><a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646">00074</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l00075"></a><a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a4594026cda174305ac7491546e21b7b4">00075</a>     <a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a4594026cda174305ac7491546e21b7b4">CVMX_PIP_L4_NO_ERR</a> = 0ull,
<a name="l00076"></a>00076     <span class="comment">/*        1  = TCP (UDP) packet not long enough to cover TCP (UDP) header */</span>
<a name="l00077"></a><a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646abc565da541d16f52d2c62cd3856c1f5a">00077</a>     <a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646abc565da541d16f52d2c62cd3856c1f5a">CVMX_PIP_L4_MAL_ERR</a> = 1ull,
<a name="l00078"></a>00078     <span class="comment">/*        2  = TCP/UDP checksum failure */</span>
<a name="l00079"></a><a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a20c2e69da1265773c4ac4af325674548">00079</a>     <a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a20c2e69da1265773c4ac4af325674548">CVMX_PIP_CHK_ERR</a> = 2ull,
<a name="l00080"></a>00080     <span class="comment">/*        3  = TCP/UDP length check (TCP/UDP length does not match IP length) */</span>
<a name="l00081"></a><a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a9ca5422db1f9bc3a2a8f39a5fc09e5e4">00081</a>     <a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a9ca5422db1f9bc3a2a8f39a5fc09e5e4">CVMX_PIP_L4_LENGTH_ERR</a> = 3ull,
<a name="l00082"></a>00082     <span class="comment">/*        4  = illegal TCP/UDP port (either source or dest port is zero) */</span>
<a name="l00083"></a><a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646af184e04438025d9e93e270c5b78076f4">00083</a>     <a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646af184e04438025d9e93e270c5b78076f4">CVMX_PIP_BAD_PRT_ERR</a> = 4ull,
<a name="l00084"></a>00084     <span class="comment">/*        8  = TCP flags = FIN only */</span>
<a name="l00085"></a><a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a36572547a637cbccd5f844d998a69cd9">00085</a>     <a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a36572547a637cbccd5f844d998a69cd9">CVMX_PIP_TCP_FLG8_ERR</a> = 8ull,
<a name="l00086"></a>00086     <span class="comment">/*        9  = TCP flags = 0 */</span>
<a name="l00087"></a><a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646af694cc98af4bdef8827c202ca9dc6d07">00087</a>     <a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646af694cc98af4bdef8827c202ca9dc6d07">CVMX_PIP_TCP_FLG9_ERR</a> = 9ull,
<a name="l00088"></a>00088     <span class="comment">/*        10 = TCP flags = FIN+RST+* */</span>
<a name="l00089"></a><a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a6dccea04092aa6df40172eee5882d617">00089</a>     <a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a6dccea04092aa6df40172eee5882d617">CVMX_PIP_TCP_FLG10_ERR</a> = 10ull,
<a name="l00090"></a>00090     <span class="comment">/*        11 = TCP flags = SYN+URG+* */</span>
<a name="l00091"></a><a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a7e89cad09d863a473882576b2a3f67bb">00091</a>     <a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a7e89cad09d863a473882576b2a3f67bb">CVMX_PIP_TCP_FLG11_ERR</a> = 11ull,
<a name="l00092"></a>00092     <span class="comment">/*        12 = TCP flags = SYN+RST+* */</span>
<a name="l00093"></a><a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646aad574037e17c2c5ad0241cd60088b6c6">00093</a>     <a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646aad574037e17c2c5ad0241cd60088b6c6">CVMX_PIP_TCP_FLG12_ERR</a> = 12ull,
<a name="l00094"></a>00094     <span class="comment">/*        13 = TCP flags = SYN+FIN+* */</span>
<a name="l00095"></a><a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a904020e10095d8ab2b71137e7e00b8a9">00095</a>     <a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646a904020e10095d8ab2b71137e7e00b8a9">CVMX_PIP_TCP_FLG13_ERR</a> = 13ull
<a name="l00096"></a>00096 } <a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646">cvmx_pip_l4_err_t</a>;
<a name="l00097"></a>00097 
<a name="l00098"></a><a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0b">00098</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {
<a name="l00099"></a>00099 
<a name="l00100"></a><a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0ba1bffe1f2b448f8034767fc23d284fa5f">00100</a>     <a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0ba1bffe1f2b448f8034767fc23d284fa5f">CVMX_PIP_IP_NO_ERR</a> = 0ull,
<a name="l00101"></a>00101     <span class="comment">/*        1 = not IPv4 or IPv6 */</span>
<a name="l00102"></a><a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0ba1c95d75f50d0cceab7c9b12c30edcc1f">00102</a>     <a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0ba1c95d75f50d0cceab7c9b12c30edcc1f">CVMX_PIP_NOT_IP</a> = 1ull,
<a name="l00103"></a>00103     <span class="comment">/*        2 = IPv4 header checksum violation */</span>
<a name="l00104"></a><a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0bafcb571acaedea3ae73d760674d10503d">00104</a>     <a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0bafcb571acaedea3ae73d760674d10503d">CVMX_PIP_IPV4_HDR_CHK</a> = 2ull,
<a name="l00105"></a>00105     <span class="comment">/*        3 = malformed (packet not long enough to cover IP hdr) */</span>
<a name="l00106"></a><a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0baa39e064fc5096ec1bac51089f487a68d">00106</a>     <a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0baa39e064fc5096ec1bac51089f487a68d">CVMX_PIP_IP_MAL_HDR</a> = 3ull,
<a name="l00107"></a>00107     <span class="comment">/*        4 = malformed (packet not long enough to cover len in IP hdr) */</span>
<a name="l00108"></a><a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0ba0bfc9643a9649f54ba7827947983ecf9">00108</a>     <a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0ba0bfc9643a9649f54ba7827947983ecf9">CVMX_PIP_IP_MAL_PKT</a> = 4ull,
<a name="l00109"></a>00109     <span class="comment">/*        5 = TTL / hop count equal zero */</span>
<a name="l00110"></a><a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0baf7b8efd640ce95138c4e35fdbc1f442c">00110</a>     <a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0baf7b8efd640ce95138c4e35fdbc1f442c">CVMX_PIP_TTL_HOP</a> = 5ull,
<a name="l00111"></a>00111     <span class="comment">/*        6 = IPv4 options / IPv6 early extension headers */</span>
<a name="l00112"></a><a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0bae5724c9d249f1db058b1d0e6b49c1e29">00112</a>     <a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0bae5724c9d249f1db058b1d0e6b49c1e29">CVMX_PIP_OPTS</a> = 6ull
<a name="l00113"></a>00113 } <a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0b">cvmx_pip_ip_exc_t</a>;
<a name="l00114"></a>00114 <span class="comment"></span>
<a name="l00115"></a>00115 <span class="comment">/**</span>
<a name="l00116"></a>00116 <span class="comment"> * NOTES</span>
<a name="l00117"></a>00117 <span class="comment"> *       late collision (data received before collision)</span>
<a name="l00118"></a>00118 <span class="comment"> *            late collisions cannot be detected by the receiver</span>
<a name="l00119"></a>00119 <span class="comment"> *            they would appear as JAM bits which would appear as bad FCS</span>
<a name="l00120"></a>00120 <span class="comment"> *            or carrier extend error which is CVMX_PIP_EXTEND_ERR</span>
<a name="l00121"></a>00121 <span class="comment"> */</span>
<a name="l00122"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241">00122</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> {<span class="comment"></span>
<a name="l00123"></a>00123 <span class="comment">    /**</span>
<a name="l00124"></a>00124 <span class="comment">     * No error</span>
<a name="l00125"></a>00125 <span class="comment">     */</span>
<a name="l00126"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a5b37ca68674a017ef602efd6935747ab">00126</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a5b37ca68674a017ef602efd6935747ab" title="No error.">CVMX_PIP_RX_NO_ERR</a> = 0ull,
<a name="l00127"></a>00127 
<a name="l00128"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241aa7350cddfd5eb5caf8734824bf7f1e5a">00128</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241aa7350cddfd5eb5caf8734824bf7f1e5a">CVMX_PIP_PARTIAL_ERR</a> = 1ull,    <span class="comment">/* RGM+SPI            1 = partially received packet (buffering/bandwidth not adequate) */</span>
<a name="l00129"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a70fb537958447cdf89c2edc1052a02e8">00129</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a70fb537958447cdf89c2edc1052a02e8">CVMX_PIP_JABBER_ERR</a> = 2ull, <span class="comment">/* RGM+SPI            2 = receive packet too large and truncated */</span>
<a name="l00130"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a014e37c8b2a24a80f413c4019f51eec8">00130</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a014e37c8b2a24a80f413c4019f51eec8">CVMX_PIP_OVER_FCS_ERR</a> = 3ull,   <span class="comment">/* RGM                3 = max frame error (pkt len &gt; max frame len) (with FCS error) */</span>
<a name="l00131"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a53b24df2c49328b9731eed3a366e8381">00131</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a53b24df2c49328b9731eed3a366e8381">CVMX_PIP_OVER_ERR</a> = 4ull,   <span class="comment">/* RGM+SPI            4 = max frame error (pkt len &gt; max frame len) */</span>
<a name="l00132"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a24a245e0505949f2eb9eec6aa8461a7d">00132</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a24a245e0505949f2eb9eec6aa8461a7d">CVMX_PIP_ALIGN_ERR</a> = 5ull,  <span class="comment">/* RGM                5 = nibble error (data not byte multiple - 100M and 10M only) */</span>
<a name="l00133"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a5f9fbe0a4636291a1004386e96bae560">00133</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a5f9fbe0a4636291a1004386e96bae560">CVMX_PIP_UNDER_FCS_ERR</a> = 6ull,  <span class="comment">/* RGM                6 = min frame error (pkt len &lt; min frame len) (with FCS error) */</span>
<a name="l00134"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241ad102b9c66f976f1a1b04d3e7b77a66c3">00134</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241ad102b9c66f976f1a1b04d3e7b77a66c3">CVMX_PIP_GMX_FCS_ERR</a> = 7ull,    <span class="comment">/* RGM                7 = FCS error */</span>
<a name="l00135"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241ad4428bed36a78ea836d0ade8a429c900">00135</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241ad4428bed36a78ea836d0ade8a429c900">CVMX_PIP_UNDER_ERR</a> = 8ull,  <span class="comment">/* RGM+SPI            8 = min frame error (pkt len &lt; min frame len) */</span>
<a name="l00136"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241aabec048088c1aed72963434638f6eaf7">00136</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241aabec048088c1aed72963434638f6eaf7">CVMX_PIP_EXTEND_ERR</a> = 9ull, <span class="comment">/* RGM                9 = Frame carrier extend error */</span>
<a name="l00137"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a290e6885305cbc986ef073503552d655">00137</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a290e6885305cbc986ef073503552d655">CVMX_PIP_TERMINATE_ERR</a> = 9ull,  <span class="comment">/* XAUI               9 = Packet was terminated with an idle cycle */</span>
<a name="l00138"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a869e6b7332a1a2971e7a1ef6b7383cf5">00138</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a869e6b7332a1a2971e7a1ef6b7383cf5">CVMX_PIP_LENGTH_ERR</a> = 10ull,    <span class="comment">/* RGM               10 = length mismatch (len did not match len in L2 length/type) */</span>
<a name="l00139"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a069c2de54f0ee66f98fde5d74cadedbe">00139</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a069c2de54f0ee66f98fde5d74cadedbe">CVMX_PIP_DAT_ERR</a> = 11ull,   <span class="comment">/* RGM               11 = Frame error (some or all data bits marked err) */</span>
<a name="l00140"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241ae8e86f5db05d0afb06d5147e9595bb85">00140</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241ae8e86f5db05d0afb06d5147e9595bb85">CVMX_PIP_DIP_ERR</a> = 11ull,   <span class="comment">/*     SPI           11 = DIP4 error */</span>
<a name="l00141"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241afcce86110232edcc8aa44ae97de82ee6">00141</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241afcce86110232edcc8aa44ae97de82ee6">CVMX_PIP_SKIP_ERR</a> = 12ull,  <span class="comment">/* RGM               12 = packet was not large enough to pass the skipper - no inspection could occur */</span>
<a name="l00142"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a0701ba482021d9e979d3fa43a299ba69">00142</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a0701ba482021d9e979d3fa43a299ba69">CVMX_PIP_NIBBLE_ERR</a> = 13ull,    <span class="comment">/* RGM               13 = studder error (data not repeated - 100M and 10M only) */</span>
<a name="l00143"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241ac89136da9cee808a9abc18c8203a1c40">00143</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241ac89136da9cee808a9abc18c8203a1c40">CVMX_PIP_PIP_FCS</a> = 16L, <span class="comment">/* RGM+SPI           16 = FCS error */</span>
<a name="l00144"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241aafd9f0128c3f18e705d52c8fdd52a222">00144</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241aafd9f0128c3f18e705d52c8fdd52a222">CVMX_PIP_PIP_SKIP_ERR</a> = 17L,    <span class="comment">/* RGM+SPI+PCI       17 = packet was not large enough to pass the skipper - no inspection could occur */</span>
<a name="l00145"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241ab8bd6534017147abf4ec5ecf4ca8563f">00145</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241ab8bd6534017147abf4ec5ecf4ca8563f">CVMX_PIP_PIP_L2_MAL_HDR</a> = 18L,  <span class="comment">/* RGM+SPI+PCI       18 = malformed l2 (packet not long enough to cover L2 hdr) */</span>
<a name="l00146"></a><a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a5313dae3f4fc1ed37769ac6f602c221d">00146</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241a5313dae3f4fc1ed37769ac6f602c221d">CVMX_PIP_PUNY_ERR</a> = 47L <span class="comment">/* SGMII             47 = PUNY error (packet was 4B or less when FCS stripping is enabled) */</span>
<a name="l00147"></a>00147         <span class="comment">/* NOTES</span>
<a name="l00148"></a>00148 <span class="comment">         *       xx = late collision (data received before collision)</span>
<a name="l00149"></a>00149 <span class="comment">         *            late collisions cannot be detected by the receiver</span>
<a name="l00150"></a>00150 <span class="comment">         *            they would appear as JAM bits which would appear as bad FCS</span>
<a name="l00151"></a>00151 <span class="comment">         *            or carrier extend error which is CVMX_PIP_EXTEND_ERR</span>
<a name="l00152"></a>00152 <span class="comment">         */</span>
<a name="l00153"></a>00153 } <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241" title="NOTES late collision (data received before collision) late collisions cannot be detected...">cvmx_pip_rcv_err_t</a>;
<a name="l00154"></a>00154 <span class="comment"></span>
<a name="l00155"></a>00155 <span class="comment">/**</span>
<a name="l00156"></a>00156 <span class="comment"> * This defines the err_code field errors in the work Q entry</span>
<a name="l00157"></a>00157 <span class="comment"> */</span>
<a name="l00158"></a><a class="code" href="unioncvmx__pip__err__t.html">00158</a> <span class="keyword">typedef</span> <span class="keyword">union </span>{
<a name="l00159"></a><a class="code" href="unioncvmx__pip__err__t.html#a998d368d6d05d6766808353b3f10191d">00159</a>     <a class="code" href="cvmx-pip_8h.html#ab456abea01c857d29d94623e29d37646">cvmx_pip_l4_err_t</a> l4_err;
<a name="l00160"></a><a class="code" href="unioncvmx__pip__err__t.html#ad9848705d2cd8150b60255e9574ed4f4">00160</a>     <a class="code" href="cvmx-pip_8h.html#ae44048d43560f67822286469c1d3ae0b">cvmx_pip_ip_exc_t</a> ip_exc;
<a name="l00161"></a><a class="code" href="unioncvmx__pip__err__t.html#af38a7445add40f2b1d380ed3ebd5cc81">00161</a>     <a class="code" href="cvmx-pip_8h.html#aa058fdc5b889fbb464ee6d255fd57241" title="NOTES late collision (data received before collision) late collisions cannot be detected...">cvmx_pip_rcv_err_t</a> rcv_err;
<a name="l00162"></a>00162 } <a class="code" href="unioncvmx__pip__err__t.html" title="This defines the err_code field errors in the work Q entry.">cvmx_pip_err_t</a>;
<a name="l00163"></a>00163 <span class="comment"></span>
<a name="l00164"></a>00164 <span class="comment">/**</span>
<a name="l00165"></a>00165 <span class="comment"> * Status statistics for a port</span>
<a name="l00166"></a>00166 <span class="comment"> */</span>
<a name="l00167"></a><a class="code" href="structcvmx__pip__port__status__t.html">00167</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00168"></a><a class="code" href="structcvmx__pip__port__status__t.html#ac0d3c0baca10c43addf0899b01b43741">00168</a>     uint64_t dropped_octets;    <span class="comment">/**&lt; Inbound octets marked to be dropped by the IPD */</span>
<a name="l00169"></a>00169     uint64_t dropped_packets;<span class="comment"></span>
<a name="l00170"></a><a class="code" href="structcvmx__pip__port__status__t.html#a707575ad06aeb5dbb2018357352460fa">00170</a> <span class="comment">                    /**&lt; Inbound packets marked to be dropped by the IPD */</span>
<a name="l00171"></a>00171     uint64_t pci_raw_packets;<span class="comment"></span>
<a name="l00172"></a><a class="code" href="structcvmx__pip__port__status__t.html#afde88d340eb4a61ee7743f84aaa8dc39">00172</a> <span class="comment">                    /**&lt; RAW PCI Packets received by PIP per port */</span>
<a name="l00173"></a><a class="code" href="structcvmx__pip__port__status__t.html#a8dd3ba6559ab59c463bd0f7c31d50b44">00173</a>     uint64_t octets;        <span class="comment">/**&lt; Number of octets processed by PIP */</span>
<a name="l00174"></a><a class="code" href="structcvmx__pip__port__status__t.html#a34207d0818f4e10879a1f0bde1f74f8a">00174</a>     uint64_t packets;       <span class="comment">/**&lt; Number of packets processed by PIP */</span>
<a name="l00175"></a>00175     uint64_t multicast_packets;<span class="comment"></span>
<a name="l00176"></a><a class="code" href="structcvmx__pip__port__status__t.html#a903dab69f24ba40f97950d4ac7aee588">00176</a> <span class="comment">                    /**&lt; Number of indentified L2 multicast packets.</span>
<a name="l00177"></a>00177 <span class="comment">                    Does not include broadcast packets.</span>
<a name="l00178"></a>00178 <span class="comment">                    Only includes packets whose parse mode is</span>
<a name="l00179"></a>00179 <span class="comment">                    SKIP_TO_L2 */</span>
<a name="l00180"></a>00180     uint64_t broadcast_packets;<span class="comment"></span>
<a name="l00181"></a><a class="code" href="structcvmx__pip__port__status__t.html#ad1f6ee5a88421c4f8109871144734ae5">00181</a> <span class="comment">                    /**&lt; Number of indentified L2 broadcast packets.</span>
<a name="l00182"></a>00182 <span class="comment">                    Does not include multicast packets.</span>
<a name="l00183"></a>00183 <span class="comment">                    Only includes packets whose parse mode is</span>
<a name="l00184"></a>00184 <span class="comment">                    SKIP_TO_L2 */</span>
<a name="l00185"></a><a class="code" href="structcvmx__pip__port__status__t.html#a1d83bd4083afd9b643ca39ceeb1c5e57">00185</a>     uint64_t len_64_packets;    <span class="comment">/**&lt; Number of 64B packets */</span>
<a name="l00186"></a>00186     uint64_t len_65_127_packets;<span class="comment"></span>
<a name="l00187"></a><a class="code" href="structcvmx__pip__port__status__t.html#ae609605decc21db1a334fdf7e72cef5c">00187</a> <span class="comment">                    /**&lt; Number of 65-127B packets */</span>
<a name="l00188"></a>00188     uint64_t len_128_255_packets;<span class="comment"></span>
<a name="l00189"></a><a class="code" href="structcvmx__pip__port__status__t.html#a42d3079840dec59da75da5be8495298a">00189</a> <span class="comment">                    /**&lt; Number of 128-255B packets */</span>
<a name="l00190"></a>00190     uint64_t len_256_511_packets;<span class="comment"></span>
<a name="l00191"></a><a class="code" href="structcvmx__pip__port__status__t.html#a995fc61f7fb3371c597dafe5cd9ca149">00191</a> <span class="comment">                    /**&lt; Number of 256-511B packets */</span>
<a name="l00192"></a>00192     uint64_t len_512_1023_packets;<span class="comment"></span>
<a name="l00193"></a><a class="code" href="structcvmx__pip__port__status__t.html#a8ea4b73adf83e50e82eb94eae11214a6">00193</a> <span class="comment">                    /**&lt; Number of 512-1023B packets */</span>
<a name="l00194"></a>00194     uint64_t len_1024_1518_packets;<span class="comment"></span>
<a name="l00195"></a><a class="code" href="structcvmx__pip__port__status__t.html#a522da90d97d61bdc022e34b2c46b32f1">00195</a> <span class="comment">                    /**&lt; Number of 1024-1518B packets */</span>
<a name="l00196"></a>00196     uint64_t len_1519_max_packets;<span class="comment"></span>
<a name="l00197"></a><a class="code" href="structcvmx__pip__port__status__t.html#aad805d39e4bd50989b1860ae100b0960">00197</a> <span class="comment">                    /**&lt; Number of 1519-max packets */</span>
<a name="l00198"></a>00198     uint64_t fcs_align_err_packets;<span class="comment"></span>
<a name="l00199"></a><a class="code" href="structcvmx__pip__port__status__t.html#a51b9939a01ced382ca8670ed094bd308">00199</a> <span class="comment">                    /**&lt; Number of packets with FCS or Align opcode errors */</span>
<a name="l00200"></a><a class="code" href="structcvmx__pip__port__status__t.html#a2e3c2fa763f6be8cc9e545880c46e84e">00200</a>     uint64_t runt_packets;      <span class="comment">/**&lt; Number of packets with length &lt; min */</span>
<a name="l00201"></a>00201     uint64_t runt_crc_packets;<span class="comment"></span>
<a name="l00202"></a><a class="code" href="structcvmx__pip__port__status__t.html#ab3138ce4b46196e46e030068a1eb0479">00202</a> <span class="comment">                    /**&lt; Number of packets with length &lt; min and FCS error */</span>
<a name="l00203"></a>00203     uint64_t oversize_packets;<span class="comment"></span>
<a name="l00204"></a><a class="code" href="structcvmx__pip__port__status__t.html#a025c2812048b363efe3e1a109693e233">00204</a> <span class="comment">                    /**&lt; Number of packets with length &gt; max */</span>
<a name="l00205"></a>00205     uint64_t oversize_crc_packets;<span class="comment"></span>
<a name="l00206"></a><a class="code" href="structcvmx__pip__port__status__t.html#aa47969d6878ce1ce535e3eb531d2e589">00206</a> <span class="comment">                    /**&lt; Number of packets with length &gt; max and FCS error */</span>
<a name="l00207"></a><a class="code" href="structcvmx__pip__port__status__t.html#a0eb0c611aaa321ff06935556499453ab">00207</a>     uint64_t inb_packets;       <span class="comment">/**&lt; Number of packets without GMX/SPX/PCI errors received by PIP */</span>
<a name="l00208"></a><a class="code" href="structcvmx__pip__port__status__t.html#a092bdeec9bad5d3c2f1c529a989a598c">00208</a>     uint64_t inb_octets;        <span class="comment">/**&lt; Total number of octets from all packets received by PIP, including CRC */</span>
<a name="l00209"></a><a class="code" href="structcvmx__pip__port__status__t.html#ac8921e9ddc1a62666d16ddb0ecd4f943">00209</a>     uint64_t inb_errors;        <span class="comment">/**&lt; Number of packets with GMX/SPX/PCI errors received by PIP */</span>
<a name="l00210"></a>00210     uint64_t mcast_l2_red_packets;<span class="comment"></span>
<a name="l00211"></a><a class="code" href="structcvmx__pip__port__status__t.html#a69fbdf3dd0d14a55f47ddf7ddbfc0b0c">00211</a> <span class="comment">                    /**&lt; Number of packets with L2 Multicast DMAC</span>
<a name="l00212"></a>00212 <span class="comment">                    that were dropped due to RED.</span>
<a name="l00213"></a>00213 <span class="comment">                    The HW will consider a packet to be an L2</span>
<a name="l00214"></a>00214 <span class="comment">                    multicast packet when the least-significant bit</span>
<a name="l00215"></a>00215 <span class="comment">                    of the first byte of the DMAC is set and the</span>
<a name="l00216"></a>00216 <span class="comment">                    packet is not an L2 broadcast packet.</span>
<a name="l00217"></a>00217 <span class="comment">                    Only applies when the parse mode for the packets</span>
<a name="l00218"></a>00218 <span class="comment">                    is SKIP-TO-L2 */</span>
<a name="l00219"></a>00219     uint64_t bcast_l2_red_packets;<span class="comment"></span>
<a name="l00220"></a><a class="code" href="structcvmx__pip__port__status__t.html#a184f20c93c6f169b6fa3ba7e54ea5ad2">00220</a> <span class="comment">                    /**&lt; Number of packets with L2 Broadcast DMAC</span>
<a name="l00221"></a>00221 <span class="comment">                    that were dropped due to RED.</span>
<a name="l00222"></a>00222 <span class="comment">                    The HW will consider a packet to be an L2</span>
<a name="l00223"></a>00223 <span class="comment">                    broadcast packet when the 48-bit DMAC is all 1&apos;s.</span>
<a name="l00224"></a>00224 <span class="comment">                    Only applies when the parse mode for the packets</span>
<a name="l00225"></a>00225 <span class="comment">                    is SKIP-TO-L2 */</span>
<a name="l00226"></a>00226     uint64_t mcast_l3_red_packets;<span class="comment"></span>
<a name="l00227"></a><a class="code" href="structcvmx__pip__port__status__t.html#a5148833b1135b8b9a8c99d0ae54352b5">00227</a> <span class="comment">                    /**&lt; Number of packets with L3 Multicast Dest Address</span>
<a name="l00228"></a>00228 <span class="comment">                    that were dropped due to RED.</span>
<a name="l00229"></a>00229 <span class="comment">                    The HW considers an IPv4 packet to be multicast</span>
<a name="l00230"></a>00230 <span class="comment">                    when the most-significant nibble of the 32-bit</span>
<a name="l00231"></a>00231 <span class="comment">                    destination address is 0xE (i.e it is a class D</span>
<a name="l00232"></a>00232 <span class="comment">                    address). The HW considers an IPv6 packet to be</span>
<a name="l00233"></a>00233 <span class="comment">                    multicast when the most-significant byte of the</span>
<a name="l00234"></a>00234 <span class="comment">                    128-bit destination address is all 1&apos;s.</span>
<a name="l00235"></a>00235 <span class="comment">                    Only applies when the parse mode for the packets</span>
<a name="l00236"></a>00236 <span class="comment">                    is SKIP-TO-L2 and the packet is IP or the parse</span>
<a name="l00237"></a>00237 <span class="comment">                    mode for the packet is SKIP-TO-IP */</span>
<a name="l00238"></a>00238     uint64_t bcast_l3_red_packets;<span class="comment"></span>
<a name="l00239"></a><a class="code" href="structcvmx__pip__port__status__t.html#a7529543289b1d2c3f70aee4fc117d0b1">00239</a> <span class="comment">                    /**&lt; Number of packets with L3 Broadcast Dest Address</span>
<a name="l00240"></a>00240 <span class="comment">                    that were dropped due to RED.</span>
<a name="l00241"></a>00241 <span class="comment">                    The HW considers an IPv4 packet to be broadcast</span>
<a name="l00242"></a>00242 <span class="comment">                    when all bits are set in the MSB of the</span>
<a name="l00243"></a>00243 <span class="comment">                    destination address. IPv6 does not have the</span>
<a name="l00244"></a>00244 <span class="comment">                    concept of a broadcast packets.</span>
<a name="l00245"></a>00245 <span class="comment">                    Only applies when the parse mode for the packet</span>
<a name="l00246"></a>00246 <span class="comment">                    is SKIP-TO-L2 and the packet is IP or the parse</span>
<a name="l00247"></a>00247 <span class="comment">                    mode for the packet is SKIP-TO-IP */</span>
<a name="l00248"></a>00248 } <a class="code" href="structcvmx__pip__port__status__t.html" title="Status statistics for a port.">cvmx_pip_port_status_t</a>;
<a name="l00249"></a>00249 <span class="comment"></span>
<a name="l00250"></a>00250 <span class="comment">/**</span>
<a name="l00251"></a>00251 <span class="comment"> * Definition of the PIP custom header that can be prepended</span>
<a name="l00252"></a>00252 <span class="comment"> * to a packet by external hardware.</span>
<a name="l00253"></a>00253 <span class="comment"> */</span>
<a name="l00254"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html">00254</a> <span class="keyword">typedef</span> <span class="keyword">union </span>{
<a name="l00255"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#ab3d9e6924c7e0eeb2cf0613e4a78cf68">00255</a>     uint64_t u64;
<a name="l00256"></a>00256     <span class="keyword">struct </span>{
<a name="l00257"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#aa1fa33a80fdd68c8c906a6bcb2b1227c">00257</a>         uint64_t rawfull:1;         <span class="comment">/**&lt; Documented as R - Set if the Packet is RAWFULL. If set,</span>
<a name="l00258"></a>00258 <span class="comment">                            this header must be the full 8 bytes */</span>
<a name="l00259"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#a765b7331fd90550af0feb481ace66d8b">00259</a>         uint64_t reserved0:5;           <span class="comment">/**&lt; Must be zero */</span>
<a name="l00260"></a>00260         <a class="code" href="cvmx-csr-enums_8h.html#a276b0f3b1f41aec509f77832cd34b6ed" title="Enumeration representing the amount of packet processing and validation performed...">cvmx_pip_port_parse_mode_t</a> parse_mode:2;<span class="comment"></span>
<a name="l00261"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#add65f1a3f84bafd959ba83e8a09c6c8e">00261</a> <span class="comment">                            /**&lt; PIP parse mode for this packet */</span>
<a name="l00262"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#ae9b506958e541a53e839f095f5ab6779">00262</a>         uint64_t reserved1:1;           <span class="comment">/**&lt; Must be zero */</span>
<a name="l00263"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#ad0aa6b23fb4b0580c5657b36f335ea2d">00263</a>         uint64_t skip_len:7;            <span class="comment">/**&lt; Skip amount, including this header, to the beginning of the packet */</span>
<a name="l00264"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#a1ac64d4775f4c0f339ec95871b27d452">00264</a>         uint64_t grpext:2;          <span class="comment">/**&lt; These bits get concatenated with the</span>
<a name="l00265"></a>00265 <span class="comment">                            PKT_INST_HDR[GRP] bits, creating a 6-bit</span>
<a name="l00266"></a>00266 <span class="comment">                            GRP field. Added in pass2. */</span>
<a name="l00267"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#a8c0266bf864662fd03e98ab56a439014">00267</a>         uint64_t nqos:1;            <span class="comment">/**&lt; Must be 0 when PKT_INST_HDR[R] = 0.</span>
<a name="l00268"></a>00268 <span class="comment">                            When set to 1, NQOS prevents PIP from directly using</span>
<a name="l00269"></a>00269 <span class="comment">                            PKT_INST_HDR[QOS] for the QOS value in WQE.</span>
<a name="l00270"></a>00270 <span class="comment">                            When PIP_GBL_CTL[IHMSK_DIS] = 1, Octeon2 does not use NQOS */</span>
<a name="l00271"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#a6e311e6a6ed957ac9087c4af9294d0b1">00271</a>         uint64_t ngrp:1;            <span class="comment">/**&lt; Must be 0 when PKT_INST_HDR[R] = 0.</span>
<a name="l00272"></a>00272 <span class="comment">                            When set to 1, NGPR prevents PIP from directly using</span>
<a name="l00273"></a>00273 <span class="comment">                            PKT_INST_HDR[GPR] for the GPR value in WQE.</span>
<a name="l00274"></a>00274 <span class="comment">                            When PIP_GBL_CTL[IHMSK_DIS] = 1, Octeon2 does not use NGRP */</span>
<a name="l00275"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#aa329f21b8f29fd91ee896aebad67d13d">00275</a>         uint64_t ntt:1;             <span class="comment">/**&lt; Must be 0 when PKT_INST_HDR[R] = 0.</span>
<a name="l00276"></a>00276 <span class="comment">                            When set to 1, NTT prevents PIP from directly using</span>
<a name="l00277"></a>00277 <span class="comment">                            PKT_INST_HDR[TT] for the TT value in WQE.</span>
<a name="l00278"></a>00278 <span class="comment">                            When PIP_GBL_CTL[IHMSK_DIS] = 1, Octeon2 does not use NTT */</span>
<a name="l00279"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#a1673ba88d4749e218e426dd1403eacaf">00279</a>         uint64_t ntag:1;            <span class="comment">/**&lt; Must be 0 when PKT_INST_HDR[R] = 0.</span>
<a name="l00280"></a>00280 <span class="comment">                            When set to 1, NTAG prevents PIP from directly using</span>
<a name="l00281"></a>00281 <span class="comment">                            PKT_INST_HDR[TAG] for the TAG value in WQE.</span>
<a name="l00282"></a>00282 <span class="comment">                            When PIP_GBL_CTL[IHMSK_DIS] = 1, Octeon2 does not use NTAG */</span>
<a name="l00283"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#a78e73fb2f7e431fa4b33cb405365d03b">00283</a>         uint64_t qos:3;             <span class="comment">/**&lt; POW input queue for this packet */</span>
<a name="l00284"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#afae6193de043b213f1e74e5247c13be7">00284</a>         uint64_t grp:4;             <span class="comment">/**&lt; POW input group for this packet */</span>
<a name="l00285"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#a5aa59ba44f49a19b91ad718f6a0d0fac">00285</a>         uint64_t rs:1;              <span class="comment">/**&lt; Flag to store this packet in the work queue entry, if possible */</span>
<a name="l00286"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#a32edaa90d683fc67c5b049da4a4f18ba">00286</a>         <a class="code" href="cvmx-csr-enums_8h.html#a556896ab26554db9f539b17e5dbc749b" title="Tag type definitions.">cvmx_pow_tag_type_t</a> tag_type:2;     <span class="comment">/**&lt; POW input tag type */</span>
<a name="l00287"></a><a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html#a25a7acf45b0d1b22c80f37ab3b9bcd2f">00287</a>         uint64_t tag:32;            <span class="comment">/**&lt; POW input tag */</span>
<a name="l00288"></a>00288     } <a class="code" href="cvmx-coremask_8c.html#a7cc33a7fd56e1ab82f778fe3f0e88c25">s</a>;
<a name="l00289"></a>00289 } <a class="code" href="unioncvmx__pip__pkt__inst__hdr__t.html" title="Definition of the PIP custom header that can be prepended to a packet by external...">cvmx_pip_pkt_inst_hdr_t</a>;
<a name="l00290"></a>00290 
<a name="l00291"></a><a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15">00291</a> <span class="keyword">enum</span> <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15">cvmx_pki_pcam_match</a> {
<a name="l00292"></a><a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15acda30f4476400f305c0214fa1c37671b">00292</a>     <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15acda30f4476400f305c0214fa1c37671b">CVMX_PKI_PCAM_MATCH_IP</a>,
<a name="l00293"></a><a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15af62758493953716e88f91c46052d54c8">00293</a>     <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15af62758493953716e88f91c46052d54c8">CVMX_PKI_PCAM_MATCH_IPV4</a>,
<a name="l00294"></a><a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15ac5a82441fe64cdb2713a09860f373f77">00294</a>     <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15ac5a82441fe64cdb2713a09860f373f77">CVMX_PKI_PCAM_MATCH_IPV6</a>,
<a name="l00295"></a><a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15a8c2cecfeea79377684b059e2af829742">00295</a>     <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15a8c2cecfeea79377684b059e2af829742">CVMX_PKI_PCAM_MATCH_TCP</a>
<a name="l00296"></a>00296 };
<a name="l00297"></a>00297 
<a name="l00298"></a>00298 <span class="comment">/* CSR typedefs have been moved to cvmx-pip-defs.h */</span>
<a name="l00299"></a><a class="code" href="cvmx-pip_8h.html#a476635da7cfd31098e796acfea7320bf">00299</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="cvmx-pip_8h.html#a476635da7cfd31098e796acfea7320bf">cvmx_pip_config_watcher</a>(<span class="keywordtype">int</span> index, <span class="keywordtype">int</span> type, uint16_t match,
<a name="l00300"></a>00300             uint16_t mask, <span class="keywordtype">int</span> grp, <span class="keywordtype">int</span> qos)
<a name="l00301"></a>00301 {
<a name="l00302"></a>00302     <span class="keywordflow">if</span> (index &gt;= <a class="code" href="cvmx-pip_8h.html#a8fb28cb4711233ad0e6cb8a96d98fa7d">CVMX_PIP_NUM_WATCHERS</a>) {
<a name="l00303"></a>00303         <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;ERROR: pip watcher %d is &gt; than supported\n&quot;</span>, index);
<a name="l00304"></a>00304         <span class="keywordflow">return</span> -1;
<a name="l00305"></a>00305     }
<a name="l00306"></a>00306     <span class="keywordflow">if</span> (<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7a26ef4abb4a4fcbba59ae3fd0553cbcab" title="Octeon has PKI block.">OCTEON_FEATURE_PKI</a>)) {
<a name="l00307"></a>00307         <span class="comment">/* store in software for now, only when the watcher is enabled program the entry*/</span>
<a name="l00308"></a>00308         <span class="keywordflow">if</span> (type == <a class="code" href="cvmx-csr-enums_8h.html#a2a9c2a5991016c36a287b6062ae361eaa495735b141cd1ad320387a6f087c6be1" title="QoS watcher will match based on the IP protocol.">CVMX_PIP_QOS_WATCH_PROTNH</a>) {
<a name="l00309"></a>00309             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#add6135ec581d7da7903429d83f5a6fd5">field</a> = <a class="code" href="cvmx-pki_8h.html#ad985daf7f453c8157b505ed69e24e4a0a01ddfafc11c8a1e0ecab910da1f9ceea">CVMX_PKI_PCAM_TERM_L3_FLAGS</a>;
<a name="l00310"></a>00310             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#ad07ba03f476315fdb282953a1177f756">data</a> = (uint32_t)(match &lt;&lt; 16);
<a name="l00311"></a>00311             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a537924336715bf42961e60f25ae39133">data_mask</a> = (uint32_t)(mask &lt;&lt; 16);
<a name="l00312"></a>00312             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a1e0211c079a0af1cbf8813de1e86104b">advance</a> = 0;
<a name="l00313"></a>00313         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="cvmx-csr-enums_8h.html#a2a9c2a5991016c36a287b6062ae361eaaea3f2fb05293364ea34807d47588e7ab" title="QoS watcher will match TCP packets to a specific destination port.">CVMX_PIP_QOS_WATCH_TCP</a>) {
<a name="l00314"></a>00314             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#add6135ec581d7da7903429d83f5a6fd5">field</a> = <a class="code" href="cvmx-pki_8h.html#ad985daf7f453c8157b505ed69e24e4a0a6ff2d6307b4c379dfb2a68617da824d4">CVMX_PKI_PCAM_TERM_L4_PORT</a>;
<a name="l00315"></a>00315             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#ad07ba03f476315fdb282953a1177f756">data</a> = 0x060000;
<a name="l00316"></a>00316             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#ad07ba03f476315fdb282953a1177f756">data</a> |= (uint32_t)match;
<a name="l00317"></a>00317             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a537924336715bf42961e60f25ae39133">data_mask</a> = (uint32_t)(mask);
<a name="l00318"></a>00318             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a1e0211c079a0af1cbf8813de1e86104b">advance</a> = 0;
<a name="l00319"></a>00319         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="cvmx-csr-enums_8h.html#a2a9c2a5991016c36a287b6062ae361eaa9b262be0b5d7b43d63b03c8faad44321" title="QoS watcher will match UDP packets to a specific destination port.">CVMX_PIP_QOS_WATCH_UDP</a>) {
<a name="l00320"></a>00320             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#add6135ec581d7da7903429d83f5a6fd5">field</a> = <a class="code" href="cvmx-pki_8h.html#ad985daf7f453c8157b505ed69e24e4a0a6ff2d6307b4c379dfb2a68617da824d4">CVMX_PKI_PCAM_TERM_L4_PORT</a>;
<a name="l00321"></a>00321             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#ad07ba03f476315fdb282953a1177f756">data</a> = 0x110000;
<a name="l00322"></a>00322             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#ad07ba03f476315fdb282953a1177f756">data</a> |= (uint32_t)match;
<a name="l00323"></a>00323             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a537924336715bf42961e60f25ae39133">data_mask</a> = (uint32_t)(mask);
<a name="l00324"></a>00324             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a1e0211c079a0af1cbf8813de1e86104b">advance</a> = 0;
<a name="l00325"></a>00325         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == 0x4 <span class="comment">/*CVMX_PIP_QOS_WATCH_ETHERTYPE*/</span>) {
<a name="l00326"></a>00326             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#add6135ec581d7da7903429d83f5a6fd5">field</a> = <a class="code" href="cvmx-pki_8h.html#ad985daf7f453c8157b505ed69e24e4a0adcc2f5b76f46a356fb8559fc194e7f84">CVMX_PKI_PCAM_TERM_ETHTYPE0</a>;
<a name="l00327"></a>00327             <span class="keywordflow">if</span> (match == 0x8100) {
<a name="l00328"></a>00328                 <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;ERROR: default vlan entry already exist, cant set watcher\n&quot;</span>);
<a name="l00329"></a>00329                 <span class="keywordflow">return</span> -1;
<a name="l00330"></a>00330             }
<a name="l00331"></a>00331             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#ad07ba03f476315fdb282953a1177f756">data</a> = (uint32_t)(match &lt;&lt; 16);
<a name="l00332"></a>00332             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a537924336715bf42961e60f25ae39133">data_mask</a> = (uint32_t)(mask &lt;&lt; 16);
<a name="l00333"></a>00333             <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a1e0211c079a0af1cbf8813de1e86104b">advance</a> = 4;
<a name="l00334"></a>00334         } <span class="keywordflow">else</span> {
<a name="l00335"></a>00335             <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;ERROR: Unsupported watcher type %d\n&quot;</span>, type);
<a name="l00336"></a>00336             <span class="keywordflow">return</span> -1;
<a name="l00337"></a>00337         }
<a name="l00338"></a>00338         <span class="keywordflow">if</span> (grp &gt;= 32) {
<a name="l00339"></a>00339             <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;ERROR: grp %d out of range for backward compat 78xx\n&quot;</span>, grp);
<a name="l00340"></a>00340             <span class="keywordflow">return</span> -1;
<a name="l00341"></a>00341         }
<a name="l00342"></a>00342         <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a2ae81e07cc166aa90a5a0088fc162c56">sso_grp</a> = (uint8_t)(grp &lt;&lt; 3 | qos);
<a name="l00343"></a>00343         <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a58f98aacdb87b3e3f6fa72896c601e6e">configured</a> = 1;
<a name="l00344"></a>00344     } <span class="keywordflow">else</span> {
<a name="l00345"></a>00345         <span class="comment">/* Implement it later */</span>
<a name="l00346"></a>00346     }
<a name="l00347"></a>00347     <span class="keywordflow">return</span> 0;
<a name="l00348"></a>00348 }
<a name="l00349"></a>00349 
<a name="l00350"></a><a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">00350</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(<span class="keywordtype">int</span> node, <span class="keywordtype">int</span> style,
<a name="l00351"></a>00351     <span class="keywordtype">int</span> tag_type, <span class="keywordtype">int</span> field)
<a name="l00352"></a>00352 {
<a name="l00353"></a>00353     <span class="keyword">struct </span><a class="code" href="structcvmx__pki__style__config.html">cvmx_pki_style_config</a> style_cfg;
<a name="l00354"></a>00354     <span class="keywordtype">int</span> style_num;
<a name="l00355"></a>00355     <span class="keywordtype">int</span> pcam_offset;
<a name="l00356"></a>00356     <span class="keywordtype">int</span> bank;
<a name="l00357"></a>00357     <span class="keyword">struct </span><a class="code" href="structcvmx__pki__pcam__input.html">cvmx_pki_pcam_input</a> pcam_input;
<a name="l00358"></a>00358     <span class="keyword">struct </span><a class="code" href="structcvmx__pki__pcam__action.html">cvmx_pki_pcam_action</a> pcam_action;
<a name="l00359"></a>00359 
<a name="l00360"></a>00360     <span class="comment">/* All other style parameters remain same except tag type */</span>
<a name="l00361"></a>00361     <a class="code" href="cvmx-pki_8c.html#aede3b4678e60760ad0a21b2209ef5bb7" title="This function reads parameters associated with style in hardware.">cvmx_pki_read_style_config</a>(node, style, <a class="code" href="cvmx-pki_8h.html#a0e527b99a59ab90d4b7563d0be5c6c26">CVMX_PKI_CLUSTER_ALL</a>, &amp;style_cfg);
<a name="l00362"></a>00362     style_cfg.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#a60b40e6b27072aadbaefeccef3add3f7" title="SSO tag type to schedule to.">tag_type</a> = (<span class="keyword">enum</span> <a class="code" href="cvmx-pki_8h.html#ab640d38c6195ff0ea5aaba4f393f0cc8" title="Tag type definitions.">cvmx_sso_tag_type</a>)tag_type;
<a name="l00363"></a>00363     style_num = <a class="code" href="cvmx-pki-resources_8c.html#aee549819600dbdacbee2d602ae5570cb" title="This function allocates/reserves a style from pool of global styles per node.">cvmx_pki_style_alloc</a>(node, -1);
<a name="l00364"></a>00364     <span class="keywordflow">if</span> (style_num &lt; 0) {
<a name="l00365"></a>00365         <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;ERROR: style not available to set tag type\n&quot;</span>);
<a name="l00366"></a>00366         <span class="keywordflow">return</span> -1;
<a name="l00367"></a>00367     }
<a name="l00368"></a>00368     <a class="code" href="cvmx-pki_8c.html#a5f8db7b0e2a92874bd713fb46219dc0d" title="This function writes/configures parameters associated with style in hardware.">cvmx_pki_write_style_config</a>(node, style_num, <a class="code" href="cvmx-pki_8h.html#a0e527b99a59ab90d4b7563d0be5c6c26">CVMX_PKI_CLUSTER_ALL</a>, &amp;style_cfg);
<a name="l00369"></a>00369     memset(&amp;pcam_input, 0, <span class="keyword">sizeof</span>(pcam_input));
<a name="l00370"></a>00370     memset(&amp;pcam_action, 0, <span class="keyword">sizeof</span>(pcam_action));
<a name="l00371"></a>00371     pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a6e85fb76549e523c87bb3de510e5f072">style</a> = style;
<a name="l00372"></a>00372     pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a7578eb680c83675100adbf7b4bff1558">style_mask</a> = 0xff;
<a name="l00373"></a>00373     <span class="keywordflow">if</span> (field == <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15acda30f4476400f305c0214fa1c37671b">CVMX_PKI_PCAM_MATCH_IP</a>) {
<a name="l00374"></a>00374         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a390c160f2f74e9b7e7d2c912c50d189b">field</a> = <a class="code" href="cvmx-pki_8h.html#ad985daf7f453c8157b505ed69e24e4a0adcc2f5b76f46a356fb8559fc194e7f84">CVMX_PKI_PCAM_TERM_ETHTYPE0</a>;
<a name="l00375"></a>00375         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a240d04b7bc6c606a47efd80b57f5baca">field_mask</a> = 0xff;
<a name="l00376"></a>00376         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a59449443ff896f2fa046a4fd8b2b6ad5">data</a> = 0x08000000;
<a name="l00377"></a>00377         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a1a9fbe0faf91fa765a5cb0625ff509a9">data_mask</a> = 0xffff0000;
<a name="l00378"></a>00378         pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#afbeaa508a3216177e4ea7b82ef79d961">pointer_advance</a> = 4;
<a name="l00379"></a>00379         <span class="comment">/* legacy will write to all clusters*/</span>
<a name="l00380"></a>00380         bank = 0;
<a name="l00381"></a>00381         pcam_offset = <a class="code" href="cvmx-pki-resources_8c.html#a78d234444b297ae628051f76ad4d2fe3" title="This function allocates/reserves a pcam entry from node.">cvmx_pki_pcam_entry_alloc</a>(node, <a class="code" href="cvmx-pki_8h.html#ae3b7bf1ed53bdf5448a2929351e26401">CVMX_PKI_FIND_AVAL_ENTRY</a>, bank, <a class="code" href="cvmx-pki_8h.html#a0e527b99a59ab90d4b7563d0be5c6c26">CVMX_PKI_CLUSTER_ALL</a>);
<a name="l00382"></a>00382         <span class="keywordflow">if</span> (pcam_offset &lt; 0) {
<a name="l00383"></a>00383             <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;ERROR: pcam entry not available to enable qos watcher\n&quot;</span>);
<a name="l00384"></a>00384             <a class="code" href="cvmx-pki-resources_8c.html#a542862873a3eef3de204cb6e21104595" title="This function frees a style from pool of global styles per node.">cvmx_pki_style_free</a>(node, style_num);
<a name="l00385"></a>00385             <span class="keywordflow">return</span> -1;
<a name="l00386"></a>00386         }
<a name="l00387"></a>00387         pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#a9fd1abb9614f9824e8d5ba5254b4ed45">parse_mode_chg</a> = <a class="code" href="cvmx-pki_8h.html#a9cc9d7cb4da581abb70ac3a898467af7ace52dabaa5590c744bd2a9426e472350">CVMX_PKI_PARSE_NO_CHG</a>;
<a name="l00388"></a>00388         pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#a0514397fd894df47cb57bf75253b3a60">layer_type_set</a> = <a class="code" href="cvmx-wqe_8h.html#a1192e8af58f86a0c2a890b74561dc679a827105058e1ac02521f9b4b90eeab597">CVMX_PKI_LTYPE_E_NONE</a>;
<a name="l00389"></a>00389         pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#a18a0ddead73b2f9a9a75d82f26284424">style_add</a> = (uint8_t)(style_num - style);
<a name="l00390"></a>00390         <a class="code" href="cvmx-pki_8c.html#a36c49d304bd5debffda4ed7a504a7a7e" title="This function writes pcam entry at given offset in pcam table in hardware.">cvmx_pki_pcam_write_entry</a>(node, pcam_offset, <a class="code" href="cvmx-pki_8h.html#a0e527b99a59ab90d4b7563d0be5c6c26">CVMX_PKI_CLUSTER_ALL</a>, pcam_input, pcam_action);
<a name="l00391"></a>00391         field = <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15ac5a82441fe64cdb2713a09860f373f77">CVMX_PKI_PCAM_MATCH_IPV6</a>;
<a name="l00392"></a>00392     }
<a name="l00393"></a>00393     <span class="keywordflow">if</span> (field == <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15af62758493953716e88f91c46052d54c8">CVMX_PKI_PCAM_MATCH_IPV4</a>) {
<a name="l00394"></a>00394         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a390c160f2f74e9b7e7d2c912c50d189b">field</a> = <a class="code" href="cvmx-pki_8h.html#ad985daf7f453c8157b505ed69e24e4a0adcc2f5b76f46a356fb8559fc194e7f84">CVMX_PKI_PCAM_TERM_ETHTYPE0</a>;
<a name="l00395"></a>00395         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a240d04b7bc6c606a47efd80b57f5baca">field_mask</a> = 0xff;
<a name="l00396"></a>00396         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a59449443ff896f2fa046a4fd8b2b6ad5">data</a> = 0x08000000;
<a name="l00397"></a>00397         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a1a9fbe0faf91fa765a5cb0625ff509a9">data_mask</a> = 0xffff0000;
<a name="l00398"></a>00398         pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#afbeaa508a3216177e4ea7b82ef79d961">pointer_advance</a> = 4;
<a name="l00399"></a>00399     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (field == <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15ac5a82441fe64cdb2713a09860f373f77">CVMX_PKI_PCAM_MATCH_IPV6</a>) {
<a name="l00400"></a>00400         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a390c160f2f74e9b7e7d2c912c50d189b">field</a> = <a class="code" href="cvmx-pki_8h.html#ad985daf7f453c8157b505ed69e24e4a0adcc2f5b76f46a356fb8559fc194e7f84">CVMX_PKI_PCAM_TERM_ETHTYPE0</a>;
<a name="l00401"></a>00401         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a240d04b7bc6c606a47efd80b57f5baca">field_mask</a> = 0xff;
<a name="l00402"></a>00402         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a59449443ff896f2fa046a4fd8b2b6ad5">data</a> = 0x86dd00000;
<a name="l00403"></a>00403         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a1a9fbe0faf91fa765a5cb0625ff509a9">data_mask</a> = 0xffff0000;
<a name="l00404"></a>00404         pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#afbeaa508a3216177e4ea7b82ef79d961">pointer_advance</a> = 4;
<a name="l00405"></a>00405     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (field == <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15a8c2cecfeea79377684b059e2af829742">CVMX_PKI_PCAM_MATCH_TCP</a>) {
<a name="l00406"></a>00406         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a390c160f2f74e9b7e7d2c912c50d189b">field</a> = <a class="code" href="cvmx-pki_8h.html#ad985daf7f453c8157b505ed69e24e4a0a6ff2d6307b4c379dfb2a68617da824d4">CVMX_PKI_PCAM_TERM_L4_PORT</a>;
<a name="l00407"></a>00407         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a240d04b7bc6c606a47efd80b57f5baca">field_mask</a> = 0xff;
<a name="l00408"></a>00408         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a59449443ff896f2fa046a4fd8b2b6ad5">data</a> = 0x60000;
<a name="l00409"></a>00409         pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a1a9fbe0faf91fa765a5cb0625ff509a9">data_mask</a> = 0xff0000;
<a name="l00410"></a>00410         pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#afbeaa508a3216177e4ea7b82ef79d961">pointer_advance</a> = 0;
<a name="l00411"></a>00411     }
<a name="l00412"></a>00412     pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#a9fd1abb9614f9824e8d5ba5254b4ed45">parse_mode_chg</a> = <a class="code" href="cvmx-pki_8h.html#a9cc9d7cb4da581abb70ac3a898467af7ace52dabaa5590c744bd2a9426e472350">CVMX_PKI_PARSE_NO_CHG</a>;
<a name="l00413"></a>00413     pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#a0514397fd894df47cb57bf75253b3a60">layer_type_set</a> = <a class="code" href="cvmx-wqe_8h.html#a1192e8af58f86a0c2a890b74561dc679a827105058e1ac02521f9b4b90eeab597">CVMX_PKI_LTYPE_E_NONE</a>;
<a name="l00414"></a>00414     pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#a18a0ddead73b2f9a9a75d82f26284424">style_add</a> = (uint8_t)(style_num - style);
<a name="l00415"></a>00415     bank = pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a390c160f2f74e9b7e7d2c912c50d189b">field</a> &amp; 0x01;
<a name="l00416"></a>00416     pcam_offset = <a class="code" href="cvmx-pki-resources_8c.html#a78d234444b297ae628051f76ad4d2fe3" title="This function allocates/reserves a pcam entry from node.">cvmx_pki_pcam_entry_alloc</a>(node, <a class="code" href="cvmx-pki_8h.html#ae3b7bf1ed53bdf5448a2929351e26401">CVMX_PKI_FIND_AVAL_ENTRY</a>, bank, <a class="code" href="cvmx-pki_8h.html#a0e527b99a59ab90d4b7563d0be5c6c26">CVMX_PKI_CLUSTER_ALL</a>);
<a name="l00417"></a>00417     <span class="keywordflow">if</span> (pcam_offset &lt; 0) {
<a name="l00418"></a>00418         <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;ERROR: pcam entry not available to enable qos watcher\n&quot;</span>);
<a name="l00419"></a>00419         <a class="code" href="cvmx-pki-resources_8c.html#a542862873a3eef3de204cb6e21104595" title="This function frees a style from pool of global styles per node.">cvmx_pki_style_free</a>(node, style_num);
<a name="l00420"></a>00420         <span class="keywordflow">return</span> -1;
<a name="l00421"></a>00421     }
<a name="l00422"></a>00422     <a class="code" href="cvmx-pki_8c.html#a36c49d304bd5debffda4ed7a504a7a7e" title="This function writes pcam entry at given offset in pcam table in hardware.">cvmx_pki_pcam_write_entry</a>(node, pcam_offset, <a class="code" href="cvmx-pki_8h.html#a0e527b99a59ab90d4b7563d0be5c6c26">CVMX_PKI_CLUSTER_ALL</a>, pcam_input, pcam_action);
<a name="l00423"></a>00423     <span class="keywordflow">return</span> style_num;
<a name="l00424"></a>00424     }
<a name="l00425"></a>00425 
<a name="l00426"></a>00426 <span class="comment">/* Only for legacy internal use */</span>
<a name="l00427"></a><a class="code" href="cvmx-pip_8h.html#ac45e7ec81ab00d3b50e568fe49872854">00427</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="cvmx-pip_8h.html#ac45e7ec81ab00d3b50e568fe49872854">__cvmx_pip_enable_watcher_78xx</a>(<span class="keywordtype">int</span> node, <span class="keywordtype">int</span> index, <span class="keywordtype">int</span> style)
<a name="l00428"></a>00428     {
<a name="l00429"></a>00429     <span class="keyword">struct </span><a class="code" href="structcvmx__pki__style__config.html">cvmx_pki_style_config</a> style_cfg;
<a name="l00430"></a>00430     <span class="keyword">struct </span><a class="code" href="structcvmx__pki__qpg__config.html">cvmx_pki_qpg_config</a> qpg_cfg;
<a name="l00431"></a>00431     <span class="keyword">struct </span><a class="code" href="structcvmx__pki__pcam__input.html">cvmx_pki_pcam_input</a> pcam_input;
<a name="l00432"></a>00432     <span class="keyword">struct </span><a class="code" href="structcvmx__pki__pcam__action.html">cvmx_pki_pcam_action</a> pcam_action;
<a name="l00433"></a>00433     <span class="keywordtype">int</span> style_num;
<a name="l00434"></a>00434     <span class="keywordtype">int</span> qpg_offset;
<a name="l00435"></a>00435     <span class="keywordtype">int</span> pcam_offset;
<a name="l00436"></a>00436     <span class="keywordtype">int</span> bank;
<a name="l00437"></a>00437 
<a name="l00438"></a>00438     <span class="keywordflow">if</span> (!<a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].configured) {
<a name="l00439"></a>00439         <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;ERROR: qos watcher %d should be configured before enable\n&quot;</span>, index);
<a name="l00440"></a>00440         <span class="keywordflow">return</span> -1;
<a name="l00441"></a>00441     }
<a name="l00442"></a>00442     <span class="comment">/* All other style parameters remain same except grp and qos and qps base */</span>
<a name="l00443"></a>00443     <a class="code" href="cvmx-pki_8c.html#aede3b4678e60760ad0a21b2209ef5bb7" title="This function reads parameters associated with style in hardware.">cvmx_pki_read_style_config</a>(node, style, <a class="code" href="cvmx-pki_8h.html#a0e527b99a59ab90d4b7563d0be5c6c26">CVMX_PKI_CLUSTER_ALL</a>, &amp;style_cfg);
<a name="l00444"></a>00444     <a class="code" href="cvmx-pki_8c.html#a36e5e0596f66338d11f9ba8a382ca943" title="This function reads qpg entry at specified offset from qpg table.">cvmx_pki_read_qpg_entry</a>(node, style_cfg.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#a450c77fd7110e16ef7f18379cd190a08" title="Base index into PKI_QPG_TBL(0..2047).">qpg_base</a>, &amp;qpg_cfg);
<a name="l00445"></a>00445     qpg_cfg.<a class="code" href="structcvmx__pki__qpg__config.html#a09e8ead01b6457a021a4b833067d29e0">qpg_base</a> = <a class="code" href="cvmx-pki_8h.html#ae3b7bf1ed53bdf5448a2929351e26401">CVMX_PKI_FIND_AVAL_ENTRY</a>;
<a name="l00446"></a>00446     qpg_cfg.<a class="code" href="structcvmx__pki__qpg__config.html#a446d0fecaaae9c75f2068f085cfd839e">grp_ok</a> = <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a2ae81e07cc166aa90a5a0088fc162c56">sso_grp</a>;
<a name="l00447"></a>00447     qpg_cfg.<a class="code" href="structcvmx__pki__qpg__config.html#af6c6ac3adec3b0a2d390177b35d23830">grp_bad</a> = <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a2ae81e07cc166aa90a5a0088fc162c56">sso_grp</a>;
<a name="l00448"></a>00448     qpg_offset = <a class="code" href="cvmx-helper-pki_8c.html#ac101e47c9bba182d4cd36fcedc73cd38" title="This function setups the qos table by allocating qpg entry and writing the provided...">cvmx_helper_pki_set_qpg_entry</a>(node, &amp;qpg_cfg);
<a name="l00449"></a>00449     <span class="keywordflow">if</span> (qpg_offset == -1) {
<a name="l00450"></a>00450         <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;Warning: no new qpg entry available to enable watcher\n&quot;</span>);
<a name="l00451"></a>00451         <span class="keywordflow">return</span> -1;
<a name="l00452"></a>00452     }
<a name="l00453"></a>00453     <span class="comment">/* try to reserve the style, if it is not configured already, reserve</span>
<a name="l00454"></a>00454 <span class="comment">    and configure it */</span>
<a name="l00455"></a>00455     style_cfg.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#a450c77fd7110e16ef7f18379cd190a08" title="Base index into PKI_QPG_TBL(0..2047).">qpg_base</a> = qpg_offset;
<a name="l00456"></a>00456     style_num = <a class="code" href="cvmx-pki-resources_8c.html#aee549819600dbdacbee2d602ae5570cb" title="This function allocates/reserves a style from pool of global styles per node.">cvmx_pki_style_alloc</a>(node, -1);
<a name="l00457"></a>00457     <span class="keywordflow">if</span> (style_num &lt; 0) {
<a name="l00458"></a>00458         <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;ERROR: style not available to enable qos watcher\n&quot;</span>);
<a name="l00459"></a>00459         <a class="code" href="cvmx-pki-resources_8c.html#a175acfade5c3f02ac65502167d880229" title="This function frees QPG table entries per node.">cvmx_pki_qpg_entry_free</a>(node, qpg_offset, 1);
<a name="l00460"></a>00460         <span class="keywordflow">return</span> -1;
<a name="l00461"></a>00461     }
<a name="l00462"></a>00462     <a class="code" href="cvmx-pki_8c.html#a5f8db7b0e2a92874bd713fb46219dc0d" title="This function writes/configures parameters associated with style in hardware.">cvmx_pki_write_style_config</a>(node, style_num, <a class="code" href="cvmx-pki_8h.html#a0e527b99a59ab90d4b7563d0be5c6c26">CVMX_PKI_CLUSTER_ALL</a>, &amp;style_cfg);
<a name="l00463"></a>00463     <span class="comment">/* legacy will write to all clusters*/</span>
<a name="l00464"></a>00464     bank = <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#add6135ec581d7da7903429d83f5a6fd5">field</a> &amp; 0x01;
<a name="l00465"></a>00465     pcam_offset = <a class="code" href="cvmx-pki-resources_8c.html#a78d234444b297ae628051f76ad4d2fe3" title="This function allocates/reserves a pcam entry from node.">cvmx_pki_pcam_entry_alloc</a>(node, <a class="code" href="cvmx-pki_8h.html#ae3b7bf1ed53bdf5448a2929351e26401">CVMX_PKI_FIND_AVAL_ENTRY</a>, bank, <a class="code" href="cvmx-pki_8h.html#a0e527b99a59ab90d4b7563d0be5c6c26">CVMX_PKI_CLUSTER_ALL</a>);
<a name="l00466"></a>00466     <span class="keywordflow">if</span> (pcam_offset &lt; 0) {
<a name="l00467"></a>00467         <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;ERROR: pcam entry not available to enable qos watcher\n&quot;</span>);
<a name="l00468"></a>00468         <a class="code" href="cvmx-pki-resources_8c.html#a542862873a3eef3de204cb6e21104595" title="This function frees a style from pool of global styles per node.">cvmx_pki_style_free</a>(node, style_num);
<a name="l00469"></a>00469         <a class="code" href="cvmx-pki-resources_8c.html#a175acfade5c3f02ac65502167d880229" title="This function frees QPG table entries per node.">cvmx_pki_qpg_entry_free</a>(node, qpg_offset, 1);
<a name="l00470"></a>00470         <span class="keywordflow">return</span> -1;
<a name="l00471"></a>00471     }
<a name="l00472"></a>00472     memset(&amp;pcam_input, 0, <span class="keyword">sizeof</span>(pcam_input));
<a name="l00473"></a>00473     memset(&amp;pcam_action, 0, <span class="keyword">sizeof</span>(pcam_action));
<a name="l00474"></a>00474     pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a6e85fb76549e523c87bb3de510e5f072">style</a> = style;
<a name="l00475"></a>00475     pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a7578eb680c83675100adbf7b4bff1558">style_mask</a> = 0xff;
<a name="l00476"></a>00476     pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a390c160f2f74e9b7e7d2c912c50d189b">field</a> = <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#add6135ec581d7da7903429d83f5a6fd5">field</a>;
<a name="l00477"></a>00477     pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a240d04b7bc6c606a47efd80b57f5baca">field_mask</a> = 0xff;
<a name="l00478"></a>00478     pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a59449443ff896f2fa046a4fd8b2b6ad5">data</a> = <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#ad07ba03f476315fdb282953a1177f756">data</a>;
<a name="l00479"></a>00479     pcam_input.<a class="code" href="structcvmx__pki__pcam__input.html#a1a9fbe0faf91fa765a5cb0625ff509a9">data_mask</a> = <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a537924336715bf42961e60f25ae39133">data_mask</a>;
<a name="l00480"></a>00480     pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#a9fd1abb9614f9824e8d5ba5254b4ed45">parse_mode_chg</a> = <a class="code" href="cvmx-pki_8h.html#a9cc9d7cb4da581abb70ac3a898467af7ace52dabaa5590c744bd2a9426e472350">CVMX_PKI_PARSE_NO_CHG</a>;
<a name="l00481"></a>00481     pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#a0514397fd894df47cb57bf75253b3a60">layer_type_set</a> = <a class="code" href="cvmx-wqe_8h.html#a1192e8af58f86a0c2a890b74561dc679a827105058e1ac02521f9b4b90eeab597">CVMX_PKI_LTYPE_E_NONE</a>;
<a name="l00482"></a>00482     pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#a18a0ddead73b2f9a9a75d82f26284424">style_add</a> = (uint8_t)(style_num - style);
<a name="l00483"></a>00483     pcam_action.<a class="code" href="structcvmx__pki__pcam__action.html#afbeaa508a3216177e4ea7b82ef79d961">pointer_advance</a> = <a class="code" href="cvmx-helper-pki_8c.html#ae9ff101adffc234dfb66188a9cacb216">qos_watcher</a>[index].<a class="code" href="structcvmx__pki__legacy__qos__watcher.html#a1e0211c079a0af1cbf8813de1e86104b">advance</a>;
<a name="l00484"></a>00484     <a class="code" href="cvmx-pki_8c.html#a36c49d304bd5debffda4ed7a504a7a7e" title="This function writes pcam entry at given offset in pcam table in hardware.">cvmx_pki_pcam_write_entry</a>(node, pcam_offset, <a class="code" href="cvmx-pki_8h.html#a0e527b99a59ab90d4b7563d0be5c6c26">CVMX_PKI_CLUSTER_ALL</a>, pcam_input, pcam_action);
<a name="l00485"></a>00485     <span class="keywordflow">return</span> 0;
<a name="l00486"></a>00486     }
<a name="l00487"></a>00487 <span class="comment"></span>
<a name="l00488"></a>00488 <span class="comment">/**</span>
<a name="l00489"></a>00489 <span class="comment"> * Configure an ethernet input port</span>
<a name="l00490"></a>00490 <span class="comment"> *</span>
<a name="l00491"></a>00491 <span class="comment"> * @param ipd_port Port number to configure</span>
<a name="l00492"></a>00492 <span class="comment"> * @param port_cfg Port hardware configuration</span>
<a name="l00493"></a>00493 <span class="comment"> * @param port_tag_cfg Port POW tagging configuration</span>
<a name="l00494"></a>00494 <span class="comment"> */</span>
<a name="l00495"></a><a class="code" href="cvmx-pip_8h.html#a3ea0a3b94e416a0050898d5ce2d80d13">00495</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cvmx-pip_8h.html#a3ea0a3b94e416a0050898d5ce2d80d13" title="Configure an ethernet input port.">cvmx_pip_config_port</a>(uint64_t ipd_port, <a class="code" href="unioncvmx__pip__prt__cfgx.html" title="cvmx_pip_prt_cfg#">cvmx_pip_prt_cfgx_t</a> port_cfg, <a class="code" href="unioncvmx__pip__prt__tagx.html" title="cvmx_pip_prt_tag#">cvmx_pip_prt_tagx_t</a> port_tag_cfg)
<a name="l00496"></a>00496     {
<a name="l00497"></a>00497     <span class="keyword">struct </span><a class="code" href="structcvmx__pki__qpg__config.html">cvmx_pki_qpg_config</a> qpg_cfg;
<a name="l00498"></a>00498     <span class="keywordtype">int</span> qpg_offset;
<a name="l00499"></a>00499     uint8_t tcp_tag = 0xff;
<a name="l00500"></a>00500     uint8_t ip_tag = 0xaa;
<a name="l00501"></a>00501     <span class="keywordtype">int</span> style, nstyle, n4style, n6style;
<a name="l00502"></a>00502 
<a name="l00503"></a>00503     <span class="keywordflow">if</span> (<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7a26ef4abb4a4fcbba59ae3fd0553cbcab" title="Octeon has PKI block.">OCTEON_FEATURE_PKI</a>)) {
<a name="l00504"></a>00504         <span class="keyword">struct </span><a class="code" href="structcvmx__pki__port__config.html">cvmx_pki_port_config</a> pki_prt_cfg;
<a name="l00505"></a>00505         <span class="keyword">struct </span><a class="code" href="structcvmx__xport.html">cvmx_xport</a> xp = <a class="code" href="cvmx-helper-util_8h.html#a98f228343a15330c4d4f23a1982f3cfa">cvmx_helper_ipd_port_to_xport</a>(ipd_port);
<a name="l00506"></a>00506 
<a name="l00507"></a>00507         <a class="code" href="cvmx-helper-pki_8c.html#ad6ad4195e1306276a8fd73b35c7e395c" title="This function gets all the PKI parameters related to that particular port from hardware...">cvmx_pki_get_port_config</a>(ipd_port, &amp;pki_prt_cfg);
<a name="l00508"></a>00508         style = pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#a62899342d353875cebaaf1ebe47b8092" title="Parameters can be configure per pkind.">pkind_cfg</a>.<a class="code" href="structcvmx__pki__pkind__config.html#a08a5640e52174b2f95160050ea93d6d0" title="Skip amount from front of packet to begin parsing at.">initial_style</a>;
<a name="l00509"></a>00509         <span class="keywordflow">if</span> (port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#a8a4ac92bab98e17502c2c07c4e121f60">ih_pri</a> || port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#af850af8e9c6a3404a24db090b7259a54">vlan_len</a> || port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#af9613b4e903d5a0b4e76bc6b8a4552bb">pad_len</a>)
<a name="l00510"></a>00510             <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;Warning: 78xx: use different config for this option\n&quot;</span>);
<a name="l00511"></a>00511         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#aa04a07cce3c0de5f49b7c1ba5df8b58f" title="Selects which PKI_FRM_LEN_CHK(0..1) register is used for this pkind for MINERR and...">minmax_sel</a> = port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#ad95fd875f21e6e56bab7afa30c401e7d">len_chk_sel</a>;
<a name="l00512"></a>00512         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#ab97fae65b4869a587b54a1720e25e026" title="L2 length error check enable.">lenerr_en</a> = port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#abd568c01d11b60ae13cc06280c8ecd5d">lenerr_en</a>;
<a name="l00513"></a>00513         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#a47bff6b41fdf2717f3fef270763f96b5" title="Max frame error check enable.">maxerr_en</a> = port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#ad493c8e8af21f13044e825cf9a1c686e">maxerr_en</a>;
<a name="l00514"></a>00514         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#a7cbb304f65f57ec01b6e16e9f01800ac" title="Min frame error check enable.">minerr_en</a> = port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#afb273e9d4fbfabcf9072b0250482a99c">minerr_en</a>;
<a name="l00515"></a>00515         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#a6231372a0fa4d148742ffb0b077e9a8d" title="FCS checking enabled.">fcs_chk</a> = port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#a871c9731ea7e78a679c90e023df9fa6f">crc_en</a>;
<a name="l00516"></a>00516         <span class="keywordflow">if</span> (port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#a78f81cafeee9d39966a0c10b8fee83b2">grp_wat</a> || port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#a6a86cd309eb1222923fb4cc68396cf9d">qos_wat</a> ||
<a name="l00517"></a>00517             port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#afd1a8c952eba54367c21cbdaf03bb61e">grp_wat_47</a> || port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#ac051ae50d2f946d84c3b2d905ab9e805">qos_wat_47</a>) {
<a name="l00518"></a>00518             uint8_t group_mask = (uint8_t)(port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#a78f81cafeee9d39966a0c10b8fee83b2">grp_wat</a> | (uint8_t)(port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#afd1a8c952eba54367c21cbdaf03bb61e">grp_wat_47</a> &lt;&lt; 4));
<a name="l00519"></a>00519             uint8_t qos_mask = (uint8_t)(port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#a6a86cd309eb1222923fb4cc68396cf9d">qos_wat</a> | (uint8_t)(port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#ac051ae50d2f946d84c3b2d905ab9e805">qos_wat_47</a> &lt;&lt; 4));
<a name="l00520"></a>00520             <span class="keywordtype">int</span> i;
<a name="l00521"></a>00521             <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="cvmx-pip_8h.html#a8fb28cb4711233ad0e6cb8a96d98fa7d">CVMX_PIP_NUM_WATCHERS</a>; i++) {
<a name="l00522"></a>00522                 <span class="keywordflow">if</span> ((group_mask &amp; (1 &lt;&lt; i)) || (qos_mask &amp; (1 &lt;&lt; i)))
<a name="l00523"></a>00523                     <a class="code" href="cvmx-pip_8h.html#ac45e7ec81ab00d3b50e568fe49872854">__cvmx_pip_enable_watcher_78xx</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, i, style);
<a name="l00524"></a>00524             }
<a name="l00525"></a>00525         }
<a name="l00526"></a>00526         <span class="keywordflow">if</span> (port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a5df4839f3c006da09ac0500ea54c52b7">tag_mode</a>) {
<a name="l00527"></a>00527             <span class="keywordflow">if</span> (<a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#a08ed81b882487e00ca2a6577bb41a8fc">OCTEON_CN78XX_PASS1_X</a>))
<a name="l00528"></a>00528                 <a class="code" href="cvmx-utils_8h.html#a9a8beaffd592aa49706deb7e8605f418">cvmx_printf</a>(<span class="stringliteral">&quot;Warning: mask tag is not supported in 78xx pass1\n&quot;</span>);
<a name="l00529"></a>00529             <span class="keywordflow">else</span> {}
<a name="l00530"></a>00530                 <span class="comment">/* need to implement for 78xx*/</span>
<a name="l00531"></a>00531         }
<a name="l00532"></a>00532         <span class="keywordflow">if</span> (port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#a99ffe150d59963fe6954da06182e3e27">tag_inc</a>)
<a name="l00533"></a>00533             <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;Warning: 78xx uses differnet method for tag generation\n&quot;</span>);
<a name="l00534"></a>00534         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#a77c72eaf53cc4dc80e533219bf08395c" title="Allow RAW packet drop 0 = Never drop packets with WQE[RAW] set.">rawdrp</a> = port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#aaca4f3c62ca688348ce75ffb385bbc87">rawdrp</a>;
<a name="l00535"></a>00535         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#a62899342d353875cebaaf1ebe47b8092" title="Parameters can be configure per pkind.">pkind_cfg</a>.<a class="code" href="structcvmx__pki__pkind__config.html#a5a1a9e40617f4cd0a38a9c5f6a60b4f5">parse_en</a>.<a class="code" href="structcvmx__pki__pkind__parse.html#ad133e8111b8c39f4acf3a3699b394921" title="INST header.">inst_hdr</a> = port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#a53080f82cf2766089528dbd995b98c40">inst_hdr</a>;
<a name="l00536"></a>00536         <span class="keywordflow">if</span> (port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#a584e40b7929085fbae3b691a35e9584e">hg_qos</a>)
<a name="l00537"></a>00537             pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#aabd2152a68ee0369574b65228e0301f1" title="Algorithm to select QoS field in QPG calculation.">qpg_qos</a> = <a class="code" href="cvmx-pki_8h.html#a13914d78589496f23478a381cf205ea5a46f6e83b1c50eeb512a8a0b1d4883610">CVMX_PKI_QPG_QOS_HIGIG</a>;
<a name="l00538"></a>00538         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#aff99e3db624219a2dc8d97a5b02bbe90">qos_vlan</a>)
<a name="l00539"></a>00539             pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#aabd2152a68ee0369574b65228e0301f1" title="Algorithm to select QoS field in QPG calculation.">qpg_qos</a> = <a class="code" href="cvmx-pki_8h.html#a13914d78589496f23478a381cf205ea5ae4e5b76b6dd1692703f905ae7f9dd4d7">CVMX_PKI_QPG_QOS_VLAN</a>;
<a name="l00540"></a>00540         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#ad3c7d1278cebf02bc42af72b9714ac81">qos_diff</a>)
<a name="l00541"></a>00541             pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#aabd2152a68ee0369574b65228e0301f1" title="Algorithm to select QoS field in QPG calculation.">qpg_qos</a> = <a class="code" href="cvmx-pki_8h.html#a13914d78589496f23478a381cf205ea5a5e53447c06ac832a42bee8b2eaaba1d6">CVMX_PKI_QPG_QOS_DIFFSERV</a>;
<a name="l00542"></a>00542         <span class="keywordflow">if</span> (port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#a3b3a48048b1ed408014bfc6ae2c0ef1e">qos_vod</a>)
<a name="l00543"></a>00543             <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;Warning: 78xx needs pcam entries installed to achieve qos_vod\n&quot;</span>);
<a name="l00544"></a>00544         <span class="keywordflow">if</span> (port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#a8a1d93bd983418aa58c6b0acd2ca577d">qos</a>) {
<a name="l00545"></a>00545             <a class="code" href="cvmx-pki_8c.html#a36e5e0596f66338d11f9ba8a382ca943" title="This function reads qpg entry at specified offset from qpg table.">cvmx_pki_read_qpg_entry</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>,
<a name="l00546"></a>00546                 pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#a450c77fd7110e16ef7f18379cd190a08" title="Base index into PKI_QPG_TBL(0..2047).">qpg_base</a>, &amp;qpg_cfg);
<a name="l00547"></a>00547             qpg_cfg.<a class="code" href="structcvmx__pki__qpg__config.html#a09e8ead01b6457a021a4b833067d29e0">qpg_base</a> = <a class="code" href="cvmx-pki_8h.html#ae3b7bf1ed53bdf5448a2929351e26401">CVMX_PKI_FIND_AVAL_ENTRY</a>;
<a name="l00548"></a>00548             qpg_cfg.<a class="code" href="structcvmx__pki__qpg__config.html#a446d0fecaaae9c75f2068f085cfd839e">grp_ok</a> |= port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#a8a1d93bd983418aa58c6b0acd2ca577d">qos</a>;
<a name="l00549"></a>00549             qpg_cfg.<a class="code" href="structcvmx__pki__qpg__config.html#af6c6ac3adec3b0a2d390177b35d23830">grp_bad</a> |= port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#a8a1d93bd983418aa58c6b0acd2ca577d">qos</a>;
<a name="l00550"></a>00550             qpg_offset = <a class="code" href="cvmx-helper-pki_8c.html#ac101e47c9bba182d4cd36fcedc73cd38" title="This function setups the qos table by allocating qpg entry and writing the provided...">cvmx_helper_pki_set_qpg_entry</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, &amp;qpg_cfg);
<a name="l00551"></a>00551             <span class="keywordflow">if</span> (qpg_offset == -1)
<a name="l00552"></a>00552                 <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;Warning: no new qpg entry available, will not modify qos\n&quot;</span>);
<a name="l00553"></a>00553             <span class="keywordflow">else</span>
<a name="l00554"></a>00554                 pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#a450c77fd7110e16ef7f18379cd190a08" title="Base index into PKI_QPG_TBL(0..2047).">qpg_base</a> = qpg_offset;
<a name="l00555"></a>00555         }
<a name="l00556"></a>00556         <span class="keywordflow">if</span> (port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#afb30f6bc53bdaa52abcee281b599ee0a">grp</a> != <a class="code" href="cvmx-helper-pki_8c.html#a6d07e5b627a7fa45d9c9f2d4d388fe66">pki_dflt_sso_grp</a>[xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>].<a class="code" href="structcvmx__pki__sso__grp__config.html#a132fecb5bbaa626b5352bff410efb1f7">group</a>) {
<a name="l00557"></a>00557             <a class="code" href="cvmx-pki_8c.html#a36e5e0596f66338d11f9ba8a382ca943" title="This function reads qpg entry at specified offset from qpg table.">cvmx_pki_read_qpg_entry</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>,
<a name="l00558"></a>00558                     pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#a450c77fd7110e16ef7f18379cd190a08" title="Base index into PKI_QPG_TBL(0..2047).">qpg_base</a>, &amp;qpg_cfg);
<a name="l00559"></a>00559             qpg_cfg.<a class="code" href="structcvmx__pki__qpg__config.html#a09e8ead01b6457a021a4b833067d29e0">qpg_base</a> = <a class="code" href="cvmx-pki_8h.html#ae3b7bf1ed53bdf5448a2929351e26401">CVMX_PKI_FIND_AVAL_ENTRY</a>;
<a name="l00560"></a>00560             qpg_cfg.<a class="code" href="structcvmx__pki__qpg__config.html#a446d0fecaaae9c75f2068f085cfd839e">grp_ok</a> |= (uint8_t)(port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#afb30f6bc53bdaa52abcee281b599ee0a">grp</a> &lt;&lt; 3);
<a name="l00561"></a>00561             qpg_cfg.<a class="code" href="structcvmx__pki__qpg__config.html#af6c6ac3adec3b0a2d390177b35d23830">grp_bad</a> |= (uint8_t)(port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#afb30f6bc53bdaa52abcee281b599ee0a">grp</a> &lt;&lt; 3);
<a name="l00562"></a>00562             qpg_offset = <a class="code" href="cvmx-helper-pki_8c.html#ac101e47c9bba182d4cd36fcedc73cd38" title="This function setups the qos table by allocating qpg entry and writing the provided...">cvmx_helper_pki_set_qpg_entry</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, &amp;qpg_cfg);
<a name="l00563"></a>00563             <span class="keywordflow">if</span> (qpg_offset == -1)
<a name="l00564"></a>00564                 <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;Warning: no new qpg entry available, will not modify group\n&quot;</span>);
<a name="l00565"></a>00565             <span class="keywordflow">else</span>
<a name="l00566"></a>00566                 pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#a450c77fd7110e16ef7f18379cd190a08" title="Base index into PKI_QPG_TBL(0..2047).">qpg_base</a> = qpg_offset;
<a name="l00567"></a>00567         }
<a name="l00568"></a>00568         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#a62899342d353875cebaaf1ebe47b8092" title="Parameters can be configure per pkind.">pkind_cfg</a>.<a class="code" href="structcvmx__pki__pkind__config.html#a5a1a9e40617f4cd0a38a9c5f6a60b4f5">parse_en</a>.<a class="code" href="structcvmx__pki__pkind__parse.html#a6ffa00f443e7f7c04dbf0aefea7a9553" title="Enable DSA parsing.">dsa_en</a> = port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#ad780e865610cc4f3a114a6482c7ce41e">dsa_en</a>;
<a name="l00569"></a>00569         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#a62899342d353875cebaaf1ebe47b8092" title="Parameters can be configure per pkind.">pkind_cfg</a>.<a class="code" href="structcvmx__pki__pkind__config.html#a5a1a9e40617f4cd0a38a9c5f6a60b4f5">parse_en</a>.<a class="code" href="structcvmx__pki__pkind__parse.html#a8c3ddf43c1a824884cad0a8f2a3872be" title="Enable HiGig parsing.">hg_en</a> = port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#ab691e533147b33827b6cbb6e80271a88">higig_en</a>;
<a name="l00570"></a>00570         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#ad2b3ba73c9ff686cfdefbb314dbf145b" title="Tag parameter configuration.">tag_cfg</a>.<a class="code" href="structcvmx__pki__style__tag__cfg.html#a6a414db7186ef3a5122c1fcd23d21bb9">tag_fields</a>.<a class="code" href="structcvmx__pki__tag__fields.html#a343bf5c273b155a36e2f13b5192de4ef">layer_c_src</a> = port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#aec83dcdb3e52f9fa18572aeff12a8280">ip6_src_flag</a> |
<a name="l00571"></a>00571                 port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a5528b9eecaf2dbc4168d7fedcceb46b8">ip4_src_flag</a>;
<a name="l00572"></a>00572         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#ad2b3ba73c9ff686cfdefbb314dbf145b" title="Tag parameter configuration.">tag_cfg</a>.<a class="code" href="structcvmx__pki__style__tag__cfg.html#a6a414db7186ef3a5122c1fcd23d21bb9">tag_fields</a>.<a class="code" href="structcvmx__pki__tag__fields.html#a1bcdf57a846b91435c2469dbb30ec788">layer_c_dst</a> = port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a6e5ed056b4356e02ae11d1e7225623d5">ip6_dst_flag</a> |
<a name="l00573"></a>00573                 port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a84e317cbaecf4d2f7a2e1ad600eb6371">ip4_dst_flag</a>;
<a name="l00574"></a>00574         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#ad2b3ba73c9ff686cfdefbb314dbf145b" title="Tag parameter configuration.">tag_cfg</a>.<a class="code" href="structcvmx__pki__style__tag__cfg.html#a6a414db7186ef3a5122c1fcd23d21bb9">tag_fields</a>.<a class="code" href="structcvmx__pki__tag__fields.html#a0e960cbc3663852628204fa14b891fac">ip_prot_nexthdr</a> = port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#aa02f64821d176b75009f1c6187e6d087">ip6_nxth_flag</a> |
<a name="l00575"></a>00575                 port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#ab871313af1f1b03e82a770279735dd15">ip4_pctl_flag</a>;
<a name="l00576"></a>00576         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#ad2b3ba73c9ff686cfdefbb314dbf145b" title="Tag parameter configuration.">tag_cfg</a>.<a class="code" href="structcvmx__pki__style__tag__cfg.html#a6a414db7186ef3a5122c1fcd23d21bb9">tag_fields</a>.<a class="code" href="structcvmx__pki__tag__fields.html#ab63f837c4b305d839c31c24cc6646331">layer_d_src</a> = port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a13854ec8996ef8c975cec477e8a0a7d7">ip6_sprt_flag</a> |
<a name="l00577"></a>00577                 port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#afe4d531db64fed1a25fa795054e4d1cc">ip4_sprt_flag</a>;
<a name="l00578"></a>00578         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#ad2b3ba73c9ff686cfdefbb314dbf145b" title="Tag parameter configuration.">tag_cfg</a>.<a class="code" href="structcvmx__pki__style__tag__cfg.html#a6a414db7186ef3a5122c1fcd23d21bb9">tag_fields</a>.<a class="code" href="structcvmx__pki__tag__fields.html#ac193b8d939323b1bfc992c16c1c3753d">layer_d_dst</a> = port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a02c2cc3a8a2db1a2902a6d0f5a2d1f3c">ip6_dprt_flag</a> |
<a name="l00579"></a>00579                 port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a66079a40efbe81aab6e1e4410559b09b">ip4_dprt_flag</a>;
<a name="l00580"></a>00580         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#ad2b3ba73c9ff686cfdefbb314dbf145b" title="Tag parameter configuration.">tag_cfg</a>.<a class="code" href="structcvmx__pki__style__tag__cfg.html#a6a414db7186ef3a5122c1fcd23d21bb9">tag_fields</a>.<a class="code" href="structcvmx__pki__tag__fields.html#ac436b48994da2dd90fe4e227815c5c22">input_port</a> = port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#ad170a16d7a9ac52aacc97c43c440c360">inc_prt_flag</a>;
<a name="l00581"></a>00581         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#ad2b3ba73c9ff686cfdefbb314dbf145b" title="Tag parameter configuration.">tag_cfg</a>.<a class="code" href="structcvmx__pki__style__tag__cfg.html#a6a414db7186ef3a5122c1fcd23d21bb9">tag_fields</a>.<a class="code" href="structcvmx__pki__tag__fields.html#af35e39bd964cef9a6239f5eee5c65096">first_vlan</a> = port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#af8966d605644e17a7813bd5c807266dd">inc_vlan</a>;
<a name="l00582"></a>00582         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#ad2b3ba73c9ff686cfdefbb314dbf145b" title="Tag parameter configuration.">tag_cfg</a>.<a class="code" href="structcvmx__pki__style__tag__cfg.html#a6a414db7186ef3a5122c1fcd23d21bb9">tag_fields</a>.<a class="code" href="structcvmx__pki__tag__fields.html#abbdae3b46659956305621b8c620b1c75">second_vlan</a> = port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#acb4fa3e3698d62d2dbc9a994697f58a8">inc_vs</a>;
<a name="l00583"></a>00583 
<a name="l00584"></a>00584         <span class="keywordflow">if</span> (port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#ad331586839597aa2075ae83cda1001a7">tcp6_tag_type</a> == port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a84807bb47f34c86c4a497b172d703b14">tcp4_tag_type</a>)
<a name="l00585"></a>00585             tcp_tag = port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#ad331586839597aa2075ae83cda1001a7">tcp6_tag_type</a>;
<a name="l00586"></a>00586         <span class="keywordflow">if</span> (port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a16d80ae619d2d06eb3082a8b76c18649">ip6_tag_type</a> == port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#aff46eac4558ee10a850a43fad5903935">ip4_tag_type</a>)
<a name="l00587"></a>00587             ip_tag = port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a16d80ae619d2d06eb3082a8b76c18649">ip6_tag_type</a>;
<a name="l00588"></a>00588         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#a60b40e6b27072aadbaefeccef3add3f7" title="SSO tag type to schedule to.">tag_type</a> = (<span class="keyword">enum</span> <a class="code" href="cvmx-pki_8h.html#ab640d38c6195ff0ea5aaba4f393f0cc8" title="Tag type definitions.">cvmx_sso_tag_type</a>)port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#acee5ce75cd9bac45db483f186d6a2279">non_tag_type</a>;
<a name="l00589"></a>00589         if (tcp_tag == ip_tag &amp;&amp; tcp_tag == port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#acee5ce75cd9bac45db483f186d6a2279">non_tag_type</a>)
<a name="l00590"></a>00590             pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#a60b40e6b27072aadbaefeccef3add3f7" title="SSO tag type to schedule to.">tag_type</a> = (<span class="keyword">enum</span> <a class="code" href="cvmx-pki_8h.html#ab640d38c6195ff0ea5aaba4f393f0cc8" title="Tag type definitions.">cvmx_sso_tag_type</a>)tcp_tag;
<a name="l00591"></a>00591         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tcp_tag == ip_tag) {
<a name="l00592"></a>00592             <span class="comment">/* allocate and copy style */</span>
<a name="l00593"></a>00593             <span class="comment">/* modify tag type */</span>
<a name="l00594"></a>00594             <span class="comment">/*pcam entry for ip6 &amp;&amp; ip4 match*/</span>
<a name="l00595"></a>00595             <span class="comment">/* default is non tag type */</span>
<a name="l00596"></a>00596             <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, style, ip_tag, <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15acda30f4476400f305c0214fa1c37671b">CVMX_PKI_PCAM_MATCH_IP</a>);
<a name="l00597"></a>00597         }
<a name="l00598"></a>00598         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ip_tag == port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#acee5ce75cd9bac45db483f186d6a2279">non_tag_type</a>)
<a name="l00599"></a>00599         {
<a name="l00600"></a>00600             <span class="comment">/* allocate and copy style */</span>
<a name="l00601"></a>00601             <span class="comment">/* modify tag type */</span>
<a name="l00602"></a>00602             <span class="comment">/*pcam entry for tcp6 &amp; tcp4 match*/</span>
<a name="l00603"></a>00603             <span class="comment">/* default is non tag type */</span>
<a name="l00604"></a>00604             <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, style, tcp_tag, <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15a8c2cecfeea79377684b059e2af829742">CVMX_PKI_PCAM_MATCH_TCP</a>);
<a name="l00605"></a>00605         }
<a name="l00606"></a>00606         <span class="keywordflow">else</span> {
<a name="l00607"></a>00607             <span class="keywordflow">if</span> (ip_tag != 0xaa) {
<a name="l00608"></a>00608                 nstyle = <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, style, ip_tag, <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15acda30f4476400f305c0214fa1c37671b">CVMX_PKI_PCAM_MATCH_IP</a>);
<a name="l00609"></a>00609                 <span class="keywordflow">if</span> (tcp_tag != 0xff)
<a name="l00610"></a>00610                     <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, nstyle, tcp_tag, <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15a8c2cecfeea79377684b059e2af829742">CVMX_PKI_PCAM_MATCH_TCP</a>);
<a name="l00611"></a>00611                 <span class="keywordflow">else</span> {
<a name="l00612"></a>00612                     n4style = <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, nstyle, ip_tag,
<a name="l00613"></a>00613                             <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15af62758493953716e88f91c46052d54c8">CVMX_PKI_PCAM_MATCH_IPV4</a>);
<a name="l00614"></a>00614                     <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, n4style, port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a84807bb47f34c86c4a497b172d703b14">tcp4_tag_type</a>,
<a name="l00615"></a>00615                             <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15a8c2cecfeea79377684b059e2af829742">CVMX_PKI_PCAM_MATCH_TCP</a>);
<a name="l00616"></a>00616                     n6style = <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, nstyle, ip_tag,
<a name="l00617"></a>00617                             <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15ac5a82441fe64cdb2713a09860f373f77">CVMX_PKI_PCAM_MATCH_IPV6</a>);
<a name="l00618"></a>00618                     <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, n6style, port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#ad331586839597aa2075ae83cda1001a7">tcp6_tag_type</a>,
<a name="l00619"></a>00619                             <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15a8c2cecfeea79377684b059e2af829742">CVMX_PKI_PCAM_MATCH_TCP</a>);
<a name="l00620"></a>00620                 }
<a name="l00621"></a>00621             }
<a name="l00622"></a>00622             <span class="keywordflow">else</span> {
<a name="l00623"></a>00623                 n4style = <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, style, port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#aff46eac4558ee10a850a43fad5903935">ip4_tag_type</a>,
<a name="l00624"></a>00624                         <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15af62758493953716e88f91c46052d54c8">CVMX_PKI_PCAM_MATCH_IPV4</a>);
<a name="l00625"></a>00625                 n6style = <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, style, port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a16d80ae619d2d06eb3082a8b76c18649">ip6_tag_type</a>,
<a name="l00626"></a>00626                         <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15ac5a82441fe64cdb2713a09860f373f77">CVMX_PKI_PCAM_MATCH_IPV6</a>);
<a name="l00627"></a>00627                 <span class="keywordflow">if</span> (tcp_tag != 0xff) {
<a name="l00628"></a>00628                     <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, n4style, tcp_tag, <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15a8c2cecfeea79377684b059e2af829742">CVMX_PKI_PCAM_MATCH_TCP</a>);
<a name="l00629"></a>00629                     <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, n6style, tcp_tag, <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15a8c2cecfeea79377684b059e2af829742">CVMX_PKI_PCAM_MATCH_TCP</a>);
<a name="l00630"></a>00630                 } <span class="keywordflow">else</span> {
<a name="l00631"></a>00631                     <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, n4style, port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a84807bb47f34c86c4a497b172d703b14">tcp4_tag_type</a>,
<a name="l00632"></a>00632                             <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15a8c2cecfeea79377684b059e2af829742">CVMX_PKI_PCAM_MATCH_TCP</a>);
<a name="l00633"></a>00633                     <a class="code" href="cvmx-pip_8h.html#a3a0f2a96aba4bda2515b7d5c642849d1">__cvmx_pip_set_tag_type</a>(xp.<a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a>, n6style, port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#ad331586839597aa2075ae83cda1001a7">tcp6_tag_type</a>,
<a name="l00634"></a>00634                             <a class="code" href="cvmx-pip_8h.html#a2db7b939f3d05513eb046c085e7e8a15a8c2cecfeea79377684b059e2af829742">CVMX_PKI_PCAM_MATCH_TCP</a>);
<a name="l00635"></a>00635                 }
<a name="l00636"></a>00636             }
<a name="l00637"></a>00637         }
<a name="l00638"></a>00638         pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#abeccb86b5d78f6196b6c4e80f2acc4f4" title="Parameters are configured per style, style is a profile, which can be applied to...">style_cfg</a>.<a class="code" href="structcvmx__pki__style__config.html#aca7476dff212097ed64b70d7bcc56c04" title="General parameter configuration.">parm_cfg</a>.<a class="code" href="structcvmx__pki__style__parm.html#adde096b409fb1a5e6936d67609bb98c8" title="Disable computing port adder by QPG algorithm.">qpg_dis_padd</a> = !port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#a4e52b48447d9a94b53ddb9b0ea3e958f">portadd_en</a>;
<a name="l00639"></a>00639 
<a name="l00640"></a>00640         <span class="keywordflow">if</span> (port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#ab001aed708857cfb9ca06b81371f6cbc">mode</a> == 0x1)
<a name="l00641"></a>00641             pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#a62899342d353875cebaaf1ebe47b8092" title="Parameters can be configure per pkind.">pkind_cfg</a>.<a class="code" href="structcvmx__pki__pkind__config.html#ade42b972878098f30711280e5f8ab88c">initial_parse_mode</a> = <a class="code" href="cvmx-pki_8h.html#a15acee92e281a9b5b8731b84441d7b7aa4674be31e0ad9a197d3a9ea50f871118">CVMX_PKI_PARSE_LA_TO_LG</a>;
<a name="l00642"></a>00642         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#ab001aed708857cfb9ca06b81371f6cbc">mode</a> == 0x2)
<a name="l00643"></a>00643             pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#a62899342d353875cebaaf1ebe47b8092" title="Parameters can be configure per pkind.">pkind_cfg</a>.<a class="code" href="structcvmx__pki__pkind__config.html#ade42b972878098f30711280e5f8ab88c">initial_parse_mode</a> = <a class="code" href="cvmx-pki_8h.html#a15acee92e281a9b5b8731b84441d7b7aac1cbd30518e04965d1497d47f56484e7">CVMX_PKI_PARSE_LC_TO_LG</a>;
<a name="l00644"></a>00644         <span class="keywordflow">else</span>
<a name="l00645"></a>00645             pki_prt_cfg.<a class="code" href="structcvmx__pki__port__config.html#a62899342d353875cebaaf1ebe47b8092" title="Parameters can be configure per pkind.">pkind_cfg</a>.<a class="code" href="structcvmx__pki__pkind__config.html#ade42b972878098f30711280e5f8ab88c">initial_parse_mode</a> = <a class="code" href="cvmx-pki_8h.html#a15acee92e281a9b5b8731b84441d7b7aac63e3f15566b2c08ebabcf8b39b800c0">CVMX_PKI_PARSE_NOTHING</a>;
<a name="l00646"></a>00646         <span class="comment">/* This is only for backward compatibility, not all the parameters are supported in 78xx */</span>
<a name="l00647"></a>00647         <a class="code" href="cvmx-helper-pki_8c.html#a1e96f7a2752913ea16bb5cd91f22493a" title="This function sets all the PKI parameters related to that particular port in hardware...">cvmx_pki_set_port_config</a>(ipd_port, &amp;pki_prt_cfg);
<a name="l00648"></a>00648     } <span class="keywordflow">else</span> {
<a name="l00649"></a>00649         <span class="keywordflow">if</span> (<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7a843fbb8e614293c03f6a0a4602e1ca6c" title="CN68XX uses port kinds for packet interface.">OCTEON_FEATURE_PKND</a>)) {
<a name="l00650"></a>00650             <span class="keywordtype">int</span> interface, index, pknd;
<a name="l00651"></a>00651 
<a name="l00652"></a>00652             interface = <a class="code" href="cvmx-helper-util_8c.html#add929ecefca011b6e476f9f90cbe501f" title="Returns the interface number for an IPD/PKO port number.">cvmx_helper_get_interface_num</a>(ipd_port);
<a name="l00653"></a>00653             index = <a class="code" href="cvmx-helper-util_8c.html#a36e4770c65dceae298dfb2b5b036ff57" title="Returns the interface index number for an IPD/PKO port number.">cvmx_helper_get_interface_index_num</a>(ipd_port);
<a name="l00654"></a>00654             pknd = <a class="code" href="cvmx-helper-util_8c.html#a2e063bd86eddaab06d8962136d3c958d" title="Get port kind for a given port in an interface.">cvmx_helper_get_pknd</a>(interface, index);
<a name="l00655"></a>00655 
<a name="l00656"></a>00656             ipd_port = pknd;    <span class="comment">/* overload port_num with pknd */</span>
<a name="l00657"></a>00657         }
<a name="l00658"></a>00658         <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#af1b3d60cfcd2839949323eb830935fbe">CVMX_PIP_PRT_CFGX</a>(ipd_port), port_cfg.<a class="code" href="unioncvmx__pip__prt__cfgx.html#aaaf9297b7407fa03dc2866001bdaaa1c">u64</a>);
<a name="l00659"></a>00659         <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ab6f4ecba4367f729d3b7d09391b065ae">CVMX_PIP_PRT_TAGX</a>(ipd_port), port_tag_cfg.<a class="code" href="unioncvmx__pip__prt__tagx.html#a5d9b0b769082bdb9c94cdf880306b682">u64</a>);
<a name="l00660"></a>00660     }
<a name="l00661"></a>00661 }
<a name="l00662"></a>00662 <span class="comment"></span>
<a name="l00663"></a>00663 <span class="comment">/**</span>
<a name="l00664"></a>00664 <span class="comment"> * Configure the VLAN priority to QoS queue mapping.</span>
<a name="l00665"></a>00665 <span class="comment"> *</span>
<a name="l00666"></a>00666 <span class="comment"> * @param vlan_priority</span>
<a name="l00667"></a>00667 <span class="comment"> *               VLAN priority (0-7)</span>
<a name="l00668"></a>00668 <span class="comment"> * @param qos    QoS queue for packets matching this watcher</span>
<a name="l00669"></a>00669 <span class="comment"> */</span>
<a name="l00670"></a><a class="code" href="cvmx-pip_8h.html#a45f08a612f53311a019f720d3fd3b627">00670</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cvmx-pip_8h.html#a45f08a612f53311a019f720d3fd3b627" title="Configure the VLAN priority to QoS queue mapping.">cvmx_pip_config_vlan_qos</a>(uint64_t vlan_priority, uint64_t qos)
<a name="l00671"></a>00671 {
<a name="l00672"></a>00672     <span class="keywordflow">if</span> (!<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7a843fbb8e614293c03f6a0a4602e1ca6c" title="CN68XX uses port kinds for packet interface.">OCTEON_FEATURE_PKND</a>)) {
<a name="l00673"></a>00673         <a class="code" href="unioncvmx__pip__qos__vlanx.html" title="cvmx_pip_qos_vlan#">cvmx_pip_qos_vlanx_t</a> pip_qos_vlanx;
<a name="l00674"></a>00674         pip_qos_vlanx.<a class="code" href="unioncvmx__pip__qos__vlanx.html#a5709271540b4a32dfa30d680875fd039">u64</a> = 0;
<a name="l00675"></a>00675         pip_qos_vlanx.<a class="code" href="unioncvmx__pip__qos__vlanx.html#a2014bd3b0755d4d0a46e9d1f635c98a7">s</a>.<a class="code" href="structcvmx__pip__qos__vlanx_1_1cvmx__pip__qos__vlanx__s.html#a25a0467e1b0f9d519e06e0233ba1c629">qos</a> = qos;
<a name="l00676"></a>00676         <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a9f40dbc570691cd2b806d3e75422ae6c">CVMX_PIP_QOS_VLANX</a>(vlan_priority), pip_qos_vlanx.<a class="code" href="unioncvmx__pip__qos__vlanx.html#a5709271540b4a32dfa30d680875fd039">u64</a>);
<a name="l00677"></a>00677     }
<a name="l00678"></a>00678 }
<a name="l00679"></a>00679 <span class="comment"></span>
<a name="l00680"></a>00680 <span class="comment">/**</span>
<a name="l00681"></a>00681 <span class="comment"> * Configure the Diffserv to QoS queue mapping.</span>
<a name="l00682"></a>00682 <span class="comment"> *</span>
<a name="l00683"></a>00683 <span class="comment"> * @param diffserv Diffserv field value (0-63)</span>
<a name="l00684"></a>00684 <span class="comment"> * @param qos      QoS queue for packets matching this watcher</span>
<a name="l00685"></a>00685 <span class="comment"> */</span>
<a name="l00686"></a><a class="code" href="cvmx-pip_8h.html#ae1dab1497fe2b16ad924912b514a791b">00686</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cvmx-pip_8h.html#ae1dab1497fe2b16ad924912b514a791b" title="Configure the Diffserv to QoS queue mapping.">cvmx_pip_config_diffserv_qos</a>(uint64_t diffserv, uint64_t qos)
<a name="l00687"></a>00687 {
<a name="l00688"></a>00688     <span class="keywordflow">if</span> (!<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7a843fbb8e614293c03f6a0a4602e1ca6c" title="CN68XX uses port kinds for packet interface.">OCTEON_FEATURE_PKND</a>)) {
<a name="l00689"></a>00689         <a class="code" href="unioncvmx__pip__qos__diffx.html" title="cvmx_pip_qos_diff#">cvmx_pip_qos_diffx_t</a> pip_qos_diffx;
<a name="l00690"></a>00690         pip_qos_diffx.<a class="code" href="unioncvmx__pip__qos__diffx.html#a8f7075e99ad8ccfc0a74c2d446ec43c1">u64</a> = 0;
<a name="l00691"></a>00691         pip_qos_diffx.<a class="code" href="unioncvmx__pip__qos__diffx.html#ad5e0a341682af54412d550dbaeaa6f8b">s</a>.<a class="code" href="structcvmx__pip__qos__diffx_1_1cvmx__pip__qos__diffx__s.html#a4325f12ffd184875c4b8785d6349996a">qos</a> = qos;
<a name="l00692"></a>00692         <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a9518c08723994fa9ecbdea8c05b3e942">CVMX_PIP_QOS_DIFFX</a>(diffserv), pip_qos_diffx.<a class="code" href="unioncvmx__pip__qos__diffx.html#a8f7075e99ad8ccfc0a74c2d446ec43c1">u64</a>);
<a name="l00693"></a>00693     }
<a name="l00694"></a>00694 }
<a name="l00695"></a>00695 <span class="comment"></span>
<a name="l00696"></a>00696 <span class="comment">/**</span>
<a name="l00697"></a>00697 <span class="comment"> * Get the status counters for a port for older non PKI chips.</span>
<a name="l00698"></a>00698 <span class="comment"> *</span>
<a name="l00699"></a>00699 <span class="comment"> * @param port_num Port number (ipd_port) to get statistics for.</span>
<a name="l00700"></a>00700 <span class="comment"> * @param clear    Set to 1 to clear the counters after they are read</span>
<a name="l00701"></a>00701 <span class="comment"> * @param status   Where to put the results.</span>
<a name="l00702"></a>00702 <span class="comment"> */</span>
<a name="l00703"></a><a class="code" href="cvmx-pip_8h.html#a1f6a15efe3144974276af11d5fbea099">00703</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cvmx-pip_8h.html#a1f6a15efe3144974276af11d5fbea099" title="Get the status counters for a port for older non PKI chips.">cvmx_pip_get_port_stats</a>(uint64_t port_num, uint64_t clear, <a class="code" href="structcvmx__pip__port__status__t.html" title="Status statistics for a port.">cvmx_pip_port_status_t</a> *status)
<a name="l00704"></a>00704 {
<a name="l00705"></a>00705     <a class="code" href="unioncvmx__pip__stat__ctl.html" title="cvmx_pip_stat_ctl">cvmx_pip_stat_ctl_t</a> pip_stat_ctl;
<a name="l00706"></a>00706     <a class="code" href="unioncvmx__pip__stat0__prtx.html" title="cvmx_pip_stat0_prt#">cvmx_pip_stat0_prtx_t</a> stat0;
<a name="l00707"></a>00707     <a class="code" href="unioncvmx__pip__stat1__prtx.html" title="cvmx_pip_stat1_prt#">cvmx_pip_stat1_prtx_t</a> stat1;
<a name="l00708"></a>00708     <a class="code" href="unioncvmx__pip__stat2__prtx.html" title="cvmx_pip_stat2_prt#">cvmx_pip_stat2_prtx_t</a> stat2;
<a name="l00709"></a>00709     <a class="code" href="unioncvmx__pip__stat3__prtx.html" title="cvmx_pip_stat3_prt#">cvmx_pip_stat3_prtx_t</a> stat3;
<a name="l00710"></a>00710     <a class="code" href="unioncvmx__pip__stat4__prtx.html" title="cvmx_pip_stat4_prt#">cvmx_pip_stat4_prtx_t</a> stat4;
<a name="l00711"></a>00711     <a class="code" href="unioncvmx__pip__stat5__prtx.html" title="cvmx_pip_stat5_prt#">cvmx_pip_stat5_prtx_t</a> stat5;
<a name="l00712"></a>00712     <a class="code" href="unioncvmx__pip__stat6__prtx.html" title="cvmx_pip_stat6_prt#">cvmx_pip_stat6_prtx_t</a> stat6;
<a name="l00713"></a>00713     <a class="code" href="unioncvmx__pip__stat7__prtx.html" title="cvmx_pip_stat7_prt#">cvmx_pip_stat7_prtx_t</a> stat7;
<a name="l00714"></a>00714     <a class="code" href="unioncvmx__pip__stat8__prtx.html" title="cvmx_pip_stat8_prt#">cvmx_pip_stat8_prtx_t</a> stat8;
<a name="l00715"></a>00715     <a class="code" href="unioncvmx__pip__stat9__prtx.html" title="cvmx_pip_stat9_prt#">cvmx_pip_stat9_prtx_t</a> stat9;
<a name="l00716"></a>00716     <a class="code" href="unioncvmx__pip__stat10__x.html" title="cvmx_pip_stat10_#">cvmx_pip_stat10_x_t</a> stat10;
<a name="l00717"></a>00717     <a class="code" href="unioncvmx__pip__stat11__x.html" title="cvmx_pip_stat11_#">cvmx_pip_stat11_x_t</a> stat11;
<a name="l00718"></a>00718     <a class="code" href="unioncvmx__pip__stat__inb__pktsx.html" title="cvmx_pip_stat_inb_pkts#">cvmx_pip_stat_inb_pktsx_t</a> pip_stat_inb_pktsx;
<a name="l00719"></a>00719     <a class="code" href="unioncvmx__pip__stat__inb__octsx.html" title="cvmx_pip_stat_inb_octs#">cvmx_pip_stat_inb_octsx_t</a> pip_stat_inb_octsx;
<a name="l00720"></a>00720     <a class="code" href="unioncvmx__pip__stat__inb__errsx.html" title="cvmx_pip_stat_inb_errs#">cvmx_pip_stat_inb_errsx_t</a> pip_stat_inb_errsx;
<a name="l00721"></a>00721     <span class="keywordtype">int</span> interface = <a class="code" href="cvmx-helper-util_8c.html#add929ecefca011b6e476f9f90cbe501f" title="Returns the interface number for an IPD/PKO port number.">cvmx_helper_get_interface_num</a>(port_num);
<a name="l00722"></a>00722     <span class="keywordtype">int</span> index = <a class="code" href="cvmx-helper-util_8c.html#a36e4770c65dceae298dfb2b5b036ff57" title="Returns the interface index number for an IPD/PKO port number.">cvmx_helper_get_interface_index_num</a>(port_num);
<a name="l00723"></a>00723 
<a name="l00724"></a>00724     pip_stat_ctl.<a class="code" href="unioncvmx__pip__stat__ctl.html#a98f76b941f2a236de11374eacf387910">u64</a> = 0;
<a name="l00725"></a>00725     pip_stat_ctl.<a class="code" href="unioncvmx__pip__stat__ctl.html#aaebeff93a51821723b6379077ffd9a20">s</a>.<a class="code" href="structcvmx__pip__stat__ctl_1_1cvmx__pip__stat__ctl__s.html#aeff720600130bd31549ba3e9e7332945">rdclr</a> = clear;
<a name="l00726"></a>00726     <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ab1d216993a6f97fa93a82cb06663f15e">CVMX_PIP_STAT_CTL</a>, pip_stat_ctl.<a class="code" href="unioncvmx__pip__stat__ctl.html#a98f76b941f2a236de11374eacf387910">u64</a>);
<a name="l00727"></a>00727 
<a name="l00728"></a>00728     <span class="keywordflow">if</span> (<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7a843fbb8e614293c03f6a0a4602e1ca6c" title="CN68XX uses port kinds for packet interface.">OCTEON_FEATURE_PKND</a>)) {
<a name="l00729"></a>00729         <span class="keywordtype">int</span> pknd = <a class="code" href="cvmx-helper-util_8c.html#a2e063bd86eddaab06d8962136d3c958d" title="Get port kind for a given port in an interface.">cvmx_helper_get_pknd</a>(interface, index);
<a name="l00730"></a>00730         <span class="comment">/*</span>
<a name="l00731"></a>00731 <span class="comment">         * PIP_STAT_CTL[MODE] 0 means pkind.</span>
<a name="l00732"></a>00732 <span class="comment">         */</span>
<a name="l00733"></a>00733         stat0.<a class="code" href="unioncvmx__pip__stat0__prtx.html#a8449d9ff8cb129c169fb6b5607cb0ff0">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ad66bbd6b5c31cae972f5ac0f5153c1c9">CVMX_PIP_STAT0_X</a>(pknd));
<a name="l00734"></a>00734         stat1.<a class="code" href="unioncvmx__pip__stat1__prtx.html#a12e81d192ff36c44a48e96da61ebdbf1">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a9f312beab08c45aec9cea5863ea0db28">CVMX_PIP_STAT1_X</a>(pknd));
<a name="l00735"></a>00735         stat2.<a class="code" href="unioncvmx__pip__stat2__prtx.html#ac772eef5d34924c70638beb7218c2647">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a87b32b4cefea159ddea368142d6c5090">CVMX_PIP_STAT2_X</a>(pknd));
<a name="l00736"></a>00736         stat3.<a class="code" href="unioncvmx__pip__stat3__prtx.html#a09746d95f3be2a8214fd5509dc82c1f7">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#afcd3eede826e4b160d4b07d74d06c70e">CVMX_PIP_STAT3_X</a>(pknd));
<a name="l00737"></a>00737         stat4.<a class="code" href="unioncvmx__pip__stat4__prtx.html#ab3fc20c85d1b46f6083f41805ea5295b">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a0aadc21ce66c67bed33309e28e80f9c5">CVMX_PIP_STAT4_X</a>(pknd));
<a name="l00738"></a>00738         stat5.<a class="code" href="unioncvmx__pip__stat5__prtx.html#a5c6f41ff67265daa67e282aab7723a7f">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a6711238aa8c065793d96ddbf171f8185">CVMX_PIP_STAT5_X</a>(pknd));
<a name="l00739"></a>00739         stat6.<a class="code" href="unioncvmx__pip__stat6__prtx.html#a4816d95833a762b213e253be4b2e1a3e">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a9841be65b6b151f15f7a1dedb5b989dd">CVMX_PIP_STAT6_X</a>(pknd));
<a name="l00740"></a>00740         stat7.<a class="code" href="unioncvmx__pip__stat7__prtx.html#ae8151c0248e42cf13e97b24be5174823">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a8b358e947d43f2aab9b90fee8c632608">CVMX_PIP_STAT7_X</a>(pknd));
<a name="l00741"></a>00741         stat8.<a class="code" href="unioncvmx__pip__stat8__prtx.html#a0893f6026ba94c840e8f49cd5f939b82">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ad9761d36883e7085a0ba4e4530582229">CVMX_PIP_STAT8_X</a>(pknd));
<a name="l00742"></a>00742         stat9.<a class="code" href="unioncvmx__pip__stat9__prtx.html#afa98c0a718a105fad35fc5d1a39934d4">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a51f4ad25e036dbfed391ec6f08d9294e">CVMX_PIP_STAT9_X</a>(pknd));
<a name="l00743"></a>00743         stat10.<a class="code" href="unioncvmx__pip__stat10__x.html#ad6fdb1faa1830c877541e1d67a74ec28">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#abc700b6cfe5246790c2fa892fe5795fd">CVMX_PIP_STAT10_X</a>(pknd));
<a name="l00744"></a>00744         stat11.<a class="code" href="unioncvmx__pip__stat11__x.html#ac6f17b8fa828f250a30f208b60b38b48">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ab4a4700e4fca3d9b705b63fbba86ee25">CVMX_PIP_STAT11_X</a>(pknd));
<a name="l00745"></a>00745     } <span class="keywordflow">else</span> {
<a name="l00746"></a>00746         <span class="keywordflow">if</span> (port_num &gt;= 40) {
<a name="l00747"></a>00747             stat0.<a class="code" href="unioncvmx__pip__stat0__prtx.html#a8449d9ff8cb129c169fb6b5607cb0ff0">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a8fb582163f9823d03a912c0d6484c45d">CVMX_PIP_XSTAT0_PRTX</a>(port_num));
<a name="l00748"></a>00748             stat1.<a class="code" href="unioncvmx__pip__stat1__prtx.html#a12e81d192ff36c44a48e96da61ebdbf1">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#addac57ec7ebbd9f721699fca50ee8de9">CVMX_PIP_XSTAT1_PRTX</a>(port_num));
<a name="l00749"></a>00749             stat2.<a class="code" href="unioncvmx__pip__stat2__prtx.html#ac772eef5d34924c70638beb7218c2647">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a9d6b15b008ac6e1b72f0aec618fd50b0">CVMX_PIP_XSTAT2_PRTX</a>(port_num));
<a name="l00750"></a>00750             stat3.<a class="code" href="unioncvmx__pip__stat3__prtx.html#a09746d95f3be2a8214fd5509dc82c1f7">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#af6406b20246262f182a75cfee0421ff8">CVMX_PIP_XSTAT3_PRTX</a>(port_num));
<a name="l00751"></a>00751             stat4.<a class="code" href="unioncvmx__pip__stat4__prtx.html#ab3fc20c85d1b46f6083f41805ea5295b">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#aff3e70503b539492cee038c839e0804b">CVMX_PIP_XSTAT4_PRTX</a>(port_num));
<a name="l00752"></a>00752             stat5.<a class="code" href="unioncvmx__pip__stat5__prtx.html#a5c6f41ff67265daa67e282aab7723a7f">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a2e9199f0fe2c416650fcf2f1e8e21f9f">CVMX_PIP_XSTAT5_PRTX</a>(port_num));
<a name="l00753"></a>00753             stat6.<a class="code" href="unioncvmx__pip__stat6__prtx.html#a4816d95833a762b213e253be4b2e1a3e">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ae84379c9056a19c83756b9f8f34aec37">CVMX_PIP_XSTAT6_PRTX</a>(port_num));
<a name="l00754"></a>00754             stat7.<a class="code" href="unioncvmx__pip__stat7__prtx.html#ae8151c0248e42cf13e97b24be5174823">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a2e79cef70fd1f02797c631aece6b379e">CVMX_PIP_XSTAT7_PRTX</a>(port_num));
<a name="l00755"></a>00755             stat8.<a class="code" href="unioncvmx__pip__stat8__prtx.html#a0893f6026ba94c840e8f49cd5f939b82">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ad73d864be733ab44d6c150cc19471175">CVMX_PIP_XSTAT8_PRTX</a>(port_num));
<a name="l00756"></a>00756             stat9.<a class="code" href="unioncvmx__pip__stat9__prtx.html#afa98c0a718a105fad35fc5d1a39934d4">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a6c05840798266f9490c398cd499ebffb">CVMX_PIP_XSTAT9_PRTX</a>(port_num));
<a name="l00757"></a>00757             <span class="keywordflow">if</span> (<a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#ae50a4d70198308cac3fcd4cafe85f50f">OCTEON_CN6XXX</a>)) {
<a name="l00758"></a>00758                 stat10.<a class="code" href="unioncvmx__pip__stat10__x.html#ad6fdb1faa1830c877541e1d67a74ec28">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#aa0b6e52cde959bca91e2579f5925486d">CVMX_PIP_XSTAT10_PRTX</a>(port_num));
<a name="l00759"></a>00759                 stat11.<a class="code" href="unioncvmx__pip__stat11__x.html#ac6f17b8fa828f250a30f208b60b38b48">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a14d0eabf305f0bb36a9b95c5b5a05780">CVMX_PIP_XSTAT11_PRTX</a>(port_num));
<a name="l00760"></a>00760             }
<a name="l00761"></a>00761         } <span class="keywordflow">else</span> {
<a name="l00762"></a>00762             stat0.<a class="code" href="unioncvmx__pip__stat0__prtx.html#a8449d9ff8cb129c169fb6b5607cb0ff0">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#af48647b7b78368b6a43015605430cbfd">CVMX_PIP_STAT0_PRTX</a>(port_num));
<a name="l00763"></a>00763             stat1.<a class="code" href="unioncvmx__pip__stat1__prtx.html#a12e81d192ff36c44a48e96da61ebdbf1">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a25bf1325041e0225122ae9f3c198f877">CVMX_PIP_STAT1_PRTX</a>(port_num));
<a name="l00764"></a>00764             stat2.<a class="code" href="unioncvmx__pip__stat2__prtx.html#ac772eef5d34924c70638beb7218c2647">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a456247a94b5c5e1e115333d05ef3b932">CVMX_PIP_STAT2_PRTX</a>(port_num));
<a name="l00765"></a>00765             stat3.<a class="code" href="unioncvmx__pip__stat3__prtx.html#a09746d95f3be2a8214fd5509dc82c1f7">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a7dc98fa3ebd68425b6c8dfc086d521e8">CVMX_PIP_STAT3_PRTX</a>(port_num));
<a name="l00766"></a>00766             stat4.<a class="code" href="unioncvmx__pip__stat4__prtx.html#ab3fc20c85d1b46f6083f41805ea5295b">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a7ef1f473bffae6bbd6350e6453b40692">CVMX_PIP_STAT4_PRTX</a>(port_num));
<a name="l00767"></a>00767             stat5.<a class="code" href="unioncvmx__pip__stat5__prtx.html#a5c6f41ff67265daa67e282aab7723a7f">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#aba0ee03a287bde3e223f095fafdfecca">CVMX_PIP_STAT5_PRTX</a>(port_num));
<a name="l00768"></a>00768             stat6.<a class="code" href="unioncvmx__pip__stat6__prtx.html#a4816d95833a762b213e253be4b2e1a3e">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a788661f318d13c51484939f5631196b8">CVMX_PIP_STAT6_PRTX</a>(port_num));
<a name="l00769"></a>00769             stat7.<a class="code" href="unioncvmx__pip__stat7__prtx.html#ae8151c0248e42cf13e97b24be5174823">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ae85b0d0c8f0eeaa1496f7a8a9c8b8732">CVMX_PIP_STAT7_PRTX</a>(port_num));
<a name="l00770"></a>00770             stat8.<a class="code" href="unioncvmx__pip__stat8__prtx.html#a0893f6026ba94c840e8f49cd5f939b82">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a9decc4a4485d6ed14351b6f3829e2d92">CVMX_PIP_STAT8_PRTX</a>(port_num));
<a name="l00771"></a>00771             stat9.<a class="code" href="unioncvmx__pip__stat9__prtx.html#afa98c0a718a105fad35fc5d1a39934d4">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a0e9d49141f9b0ee99d9eb7b43586218c">CVMX_PIP_STAT9_PRTX</a>(port_num));
<a name="l00772"></a>00772             <span class="keywordflow">if</span> (<a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#ab2f0e30e085a78717a2b98c3349c221c">OCTEON_CN52XX</a>)
<a name="l00773"></a>00773                 || <a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#aecde4ceb9a18f483ac910431675fd946">OCTEON_CN56XX</a>)
<a name="l00774"></a>00774                 || <a class="code" href="octeon-model_8h.html#a78957577097ca57aff89f64acce0084f">OCTEON_IS_OCTEON2</a>()
<a name="l00775"></a>00775                 || <a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#a65b975e6fd418a613995cd1bd685a287">OCTEON_CN70XX</a>)) {
<a name="l00776"></a>00776                 stat10.<a class="code" href="unioncvmx__pip__stat10__x.html#ad6fdb1faa1830c877541e1d67a74ec28">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a909bce5dbc3a368ab6f80ff940bb1637">CVMX_PIP_STAT10_PRTX</a>(port_num));
<a name="l00777"></a>00777                 stat11.<a class="code" href="unioncvmx__pip__stat11__x.html#ac6f17b8fa828f250a30f208b60b38b48">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a866cf3da4aab2d4c4faf4053c8929b39">CVMX_PIP_STAT11_PRTX</a>(port_num));
<a name="l00778"></a>00778             }
<a name="l00779"></a>00779         }
<a name="l00780"></a>00780     }
<a name="l00781"></a>00781     <span class="keywordflow">if</span> (<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7a843fbb8e614293c03f6a0a4602e1ca6c" title="CN68XX uses port kinds for packet interface.">OCTEON_FEATURE_PKND</a>)) {
<a name="l00782"></a>00782         <span class="keywordtype">int</span> pknd = <a class="code" href="cvmx-helper-util_8c.html#a2e063bd86eddaab06d8962136d3c958d" title="Get port kind for a given port in an interface.">cvmx_helper_get_pknd</a>(interface, index);
<a name="l00783"></a>00783 
<a name="l00784"></a>00784         pip_stat_inb_pktsx.<a class="code" href="unioncvmx__pip__stat__inb__pktsx.html#a4a87daebc26df90585b614b842b0ca73">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a6c52022164a35360c0857ef8dfa11fe5">CVMX_PIP_STAT_INB_PKTS_PKNDX</a>(pknd));
<a name="l00785"></a>00785         pip_stat_inb_octsx.<a class="code" href="unioncvmx__pip__stat__inb__octsx.html#a4adb0a68987712fa00797fb17873dde1">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a25c6e4daf3736500fe0d15306ace3c13">CVMX_PIP_STAT_INB_OCTS_PKNDX</a>(pknd));
<a name="l00786"></a>00786         pip_stat_inb_errsx.<a class="code" href="unioncvmx__pip__stat__inb__errsx.html#a5530782aa91889dee5128b71228737e7">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a92b86c386da957ac7cec15f75d242846">CVMX_PIP_STAT_INB_ERRS_PKNDX</a>(pknd));
<a name="l00787"></a>00787     } <span class="keywordflow">else</span> {
<a name="l00788"></a>00788         pip_stat_inb_pktsx.<a class="code" href="unioncvmx__pip__stat__inb__pktsx.html#a4a87daebc26df90585b614b842b0ca73">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a50eecb8a21134413a156487ed9e984c1">CVMX_PIP_STAT_INB_PKTSX</a>(port_num));
<a name="l00789"></a>00789         pip_stat_inb_octsx.<a class="code" href="unioncvmx__pip__stat__inb__octsx.html#a4adb0a68987712fa00797fb17873dde1">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a2a770d851b93935b0fc1ca768805b81c">CVMX_PIP_STAT_INB_OCTSX</a>(port_num));
<a name="l00790"></a>00790         pip_stat_inb_errsx.<a class="code" href="unioncvmx__pip__stat__inb__errsx.html#a5530782aa91889dee5128b71228737e7">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a005b080852684a15e0c5164c0632fe98">CVMX_PIP_STAT_INB_ERRSX</a>(port_num));
<a name="l00791"></a>00791     }
<a name="l00792"></a>00792 
<a name="l00793"></a>00793     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#ac0d3c0baca10c43addf0899b01b43741" title="Inbound octets marked to be dropped by the IPD.">dropped_octets</a> = stat0.<a class="code" href="unioncvmx__pip__stat0__prtx.html#a5264126d88c2a8a68580e8d0af16a352">s</a>.<a class="code" href="structcvmx__pip__stat0__prtx_1_1cvmx__pip__stat0__prtx__s.html#a37f8191f1496a7cabfba1cba86bd2e42">drp_octs</a>;
<a name="l00794"></a>00794     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a707575ad06aeb5dbb2018357352460fa" title="Inbound packets marked to be dropped by the IPD.">dropped_packets</a> = stat0.<a class="code" href="unioncvmx__pip__stat0__prtx.html#a5264126d88c2a8a68580e8d0af16a352">s</a>.<a class="code" href="structcvmx__pip__stat0__prtx_1_1cvmx__pip__stat0__prtx__s.html#af634220080e93e5b67022d88ac842f2d">drp_pkts</a>;
<a name="l00795"></a>00795     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a8dd3ba6559ab59c463bd0f7c31d50b44" title="Number of octets processed by PIP.">octets</a> = stat1.<a class="code" href="unioncvmx__pip__stat1__prtx.html#ae266b7f03ed4e547591793a6aa59c9cd">s</a>.<a class="code" href="structcvmx__pip__stat1__prtx_1_1cvmx__pip__stat1__prtx__s.html#a390bd2cf665df35341808f1a79d2b499">octs</a>;
<a name="l00796"></a>00796     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#afde88d340eb4a61ee7743f84aaa8dc39" title="RAW PCI Packets received by PIP per port.">pci_raw_packets</a> = stat2.<a class="code" href="unioncvmx__pip__stat2__prtx.html#ad547189f4850cb4946b8e827f59971e2">s</a>.<a class="code" href="structcvmx__pip__stat2__prtx_1_1cvmx__pip__stat2__prtx__s.html#ad68e89be3a9f38eee43b6a67872be79f">raw</a>;
<a name="l00797"></a>00797     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a34207d0818f4e10879a1f0bde1f74f8a" title="Number of packets processed by PIP.">packets</a> = stat2.<a class="code" href="unioncvmx__pip__stat2__prtx.html#ad547189f4850cb4946b8e827f59971e2">s</a>.<a class="code" href="structcvmx__pip__stat2__prtx_1_1cvmx__pip__stat2__prtx__s.html#ae895c8aeb5ddf84efbc670d57c5249a5">pkts</a>;
<a name="l00798"></a>00798     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a903dab69f24ba40f97950d4ac7aee588" title="Number of indentified L2 multicast packets.">multicast_packets</a> = stat3.<a class="code" href="unioncvmx__pip__stat3__prtx.html#ab44ab4ca2e44e3437fd9fa594a28a388">s</a>.<a class="code" href="structcvmx__pip__stat3__prtx_1_1cvmx__pip__stat3__prtx__s.html#a0f23ac06d53a41febccaecfc0139fa6f">mcst</a>;
<a name="l00799"></a>00799     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#ad1f6ee5a88421c4f8109871144734ae5" title="Number of indentified L2 broadcast packets.">broadcast_packets</a> = stat3.<a class="code" href="unioncvmx__pip__stat3__prtx.html#ab44ab4ca2e44e3437fd9fa594a28a388">s</a>.<a class="code" href="structcvmx__pip__stat3__prtx_1_1cvmx__pip__stat3__prtx__s.html#aaf6d4cdab22d66d9424b7387c9baf99f">bcst</a>;
<a name="l00800"></a>00800     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a1d83bd4083afd9b643ca39ceeb1c5e57" title="Number of 64B packets.">len_64_packets</a> = stat4.<a class="code" href="unioncvmx__pip__stat4__prtx.html#aba035f17a11c71dee30c14dc09cab712">s</a>.<a class="code" href="structcvmx__pip__stat4__prtx_1_1cvmx__pip__stat4__prtx__s.html#adea341befad1fea04bbbb6c85185a2ed">h64</a>;
<a name="l00801"></a>00801     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#ae609605decc21db1a334fdf7e72cef5c" title="Number of 65-127B packets.">len_65_127_packets</a> = stat4.<a class="code" href="unioncvmx__pip__stat4__prtx.html#aba035f17a11c71dee30c14dc09cab712">s</a>.<a class="code" href="structcvmx__pip__stat4__prtx_1_1cvmx__pip__stat4__prtx__s.html#a09a856a187b740f0d90309ef534104ee">h65to127</a>;
<a name="l00802"></a>00802     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a42d3079840dec59da75da5be8495298a" title="Number of 128-255B packets.">len_128_255_packets</a> = stat5.<a class="code" href="unioncvmx__pip__stat5__prtx.html#a1990f7a04c2a554d3ee94aca48d7b4ab">s</a>.<a class="code" href="structcvmx__pip__stat5__prtx_1_1cvmx__pip__stat5__prtx__s.html#ab83899933e4d65322b19ca151e958797">h128to255</a>;
<a name="l00803"></a>00803     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a995fc61f7fb3371c597dafe5cd9ca149" title="Number of 256-511B packets.">len_256_511_packets</a> = stat5.<a class="code" href="unioncvmx__pip__stat5__prtx.html#a1990f7a04c2a554d3ee94aca48d7b4ab">s</a>.<a class="code" href="structcvmx__pip__stat5__prtx_1_1cvmx__pip__stat5__prtx__s.html#a0fc60d6e29d72c4bdf26cc629de20040">h256to511</a>;
<a name="l00804"></a>00804     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a8ea4b73adf83e50e82eb94eae11214a6" title="Number of 512-1023B packets.">len_512_1023_packets</a> = stat6.<a class="code" href="unioncvmx__pip__stat6__prtx.html#a2c3a4d6113c1ba023ae4c8ae071d72fb">s</a>.<a class="code" href="structcvmx__pip__stat6__prtx_1_1cvmx__pip__stat6__prtx__s.html#aaad441c5e634832e1eadafae550a67bd">h512to1023</a>;
<a name="l00805"></a>00805     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a522da90d97d61bdc022e34b2c46b32f1" title="Number of 1024-1518B packets.">len_1024_1518_packets</a> = stat6.<a class="code" href="unioncvmx__pip__stat6__prtx.html#a2c3a4d6113c1ba023ae4c8ae071d72fb">s</a>.<a class="code" href="structcvmx__pip__stat6__prtx_1_1cvmx__pip__stat6__prtx__s.html#a832187edadbbaf5ad677edd86ed5572c">h1024to1518</a>;
<a name="l00806"></a>00806     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#aad805d39e4bd50989b1860ae100b0960" title="Number of 1519-max packets.">len_1519_max_packets</a> = stat7.<a class="code" href="unioncvmx__pip__stat7__prtx.html#abc561727b89833fc5abcfecc1b420375">s</a>.<a class="code" href="structcvmx__pip__stat7__prtx_1_1cvmx__pip__stat7__prtx__s.html#a840b69b6b1d7cf62b9c0f5491e4ba91b">h1519</a>;
<a name="l00807"></a>00807     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a51b9939a01ced382ca8670ed094bd308" title="Number of packets with FCS or Align opcode errors.">fcs_align_err_packets</a> = stat7.<a class="code" href="unioncvmx__pip__stat7__prtx.html#abc561727b89833fc5abcfecc1b420375">s</a>.<a class="code" href="structcvmx__pip__stat7__prtx_1_1cvmx__pip__stat7__prtx__s.html#a47353e77fc498ee98655e49162467af3">fcs</a>;
<a name="l00808"></a>00808     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a2e3c2fa763f6be8cc9e545880c46e84e" title="Number of packets with length &amp;lt; min.">runt_packets</a> = stat8.<a class="code" href="unioncvmx__pip__stat8__prtx.html#ab9fdac1e9ef700e710f3bb4e471d74cb">s</a>.<a class="code" href="structcvmx__pip__stat8__prtx_1_1cvmx__pip__stat8__prtx__s.html#a41ec60b14481d7ecad039e14823f4229">undersz</a>;
<a name="l00809"></a>00809     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#ab3138ce4b46196e46e030068a1eb0479" title="Number of packets with length &amp;lt; min and FCS error.">runt_crc_packets</a> = stat8.<a class="code" href="unioncvmx__pip__stat8__prtx.html#ab9fdac1e9ef700e710f3bb4e471d74cb">s</a>.<a class="code" href="structcvmx__pip__stat8__prtx_1_1cvmx__pip__stat8__prtx__s.html#a6f2638781f5bfc8416a4b9d2cb320851">frag</a>;
<a name="l00810"></a>00810     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a025c2812048b363efe3e1a109693e233" title="Number of packets with length &amp;gt; max.">oversize_packets</a> = stat9.<a class="code" href="unioncvmx__pip__stat9__prtx.html#ace45ff171c2ab05a1af84f1b5e324eea">s</a>.<a class="code" href="structcvmx__pip__stat9__prtx_1_1cvmx__pip__stat9__prtx__s.html#a3cd4ea1617e7f7f348d92b8842fc5712">oversz</a>;
<a name="l00811"></a>00811     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#aa47969d6878ce1ce535e3eb531d2e589" title="Number of packets with length &amp;gt; max and FCS error.">oversize_crc_packets</a> = stat9.<a class="code" href="unioncvmx__pip__stat9__prtx.html#ace45ff171c2ab05a1af84f1b5e324eea">s</a>.<a class="code" href="structcvmx__pip__stat9__prtx_1_1cvmx__pip__stat9__prtx__s.html#a49d6df9dd3655df6c3d573653f32c446">jabber</a>;
<a name="l00812"></a>00812     <span class="keywordflow">if</span> (<a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#ab2f0e30e085a78717a2b98c3349c221c">OCTEON_CN52XX</a>)
<a name="l00813"></a>00813         || <a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#aecde4ceb9a18f483ac910431675fd946">OCTEON_CN56XX</a>)
<a name="l00814"></a>00814         || <a class="code" href="octeon-model_8h.html#a78957577097ca57aff89f64acce0084f">OCTEON_IS_OCTEON2</a>()
<a name="l00815"></a>00815         || <a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#a65b975e6fd418a613995cd1bd685a287">OCTEON_CN70XX</a>)) {
<a name="l00816"></a>00816         status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a69fbdf3dd0d14a55f47ddf7ddbfc0b0c" title="Number of packets with L2 Multicast DMAC that were dropped due to RED.">mcast_l2_red_packets</a> = stat10.<a class="code" href="unioncvmx__pip__stat10__x.html#a6f3e102b71fd01d8a9be4239a876460e">s</a>.<a class="code" href="structcvmx__pip__stat10__x_1_1cvmx__pip__stat10__x__s.html#ac8ee6ced39ffda3097d0b6e8d467a9a8">mcast</a>;
<a name="l00817"></a>00817         status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a184f20c93c6f169b6fa3ba7e54ea5ad2" title="Number of packets with L2 Broadcast DMAC that were dropped due to RED.">bcast_l2_red_packets</a> = stat10.<a class="code" href="unioncvmx__pip__stat10__x.html#a6f3e102b71fd01d8a9be4239a876460e">s</a>.<a class="code" href="structcvmx__pip__stat10__x_1_1cvmx__pip__stat10__x__s.html#ada6fbd6d0f6761ceaef23e5ea1ac932a">bcast</a>;
<a name="l00818"></a>00818         status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a5148833b1135b8b9a8c99d0ae54352b5" title="Number of packets with L3 Multicast Dest Address that were dropped due to RED.">mcast_l3_red_packets</a> = stat11.<a class="code" href="unioncvmx__pip__stat11__x.html#ad28677a0ba671683c3d987768779e5d2">s</a>.<a class="code" href="structcvmx__pip__stat11__x_1_1cvmx__pip__stat11__x__s.html#ad951f1555c5e838e4925fa117dc50919">mcast</a>;
<a name="l00819"></a>00819         status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a7529543289b1d2c3f70aee4fc117d0b1" title="Number of packets with L3 Broadcast Dest Address that were dropped due to RED.">bcast_l3_red_packets</a> = stat11.<a class="code" href="unioncvmx__pip__stat11__x.html#ad28677a0ba671683c3d987768779e5d2">s</a>.<a class="code" href="structcvmx__pip__stat11__x_1_1cvmx__pip__stat11__x__s.html#a1879ec1712ddaea14333fed8ae00fc47">bcast</a>;
<a name="l00820"></a>00820     }
<a name="l00821"></a>00821     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a0eb0c611aaa321ff06935556499453ab" title="Number of packets without GMX/SPX/PCI errors received by PIP.">inb_packets</a> = pip_stat_inb_pktsx.<a class="code" href="unioncvmx__pip__stat__inb__pktsx.html#a77acb888ba7dd0ca24d5156c9c07b660">s</a>.<a class="code" href="structcvmx__pip__stat__inb__pktsx_1_1cvmx__pip__stat__inb__pktsx__s.html#a924caded347bee06f031e0a6d1251bbf">pkts</a>;
<a name="l00822"></a>00822     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#a092bdeec9bad5d3c2f1c529a989a598c" title="Total number of octets from all packets received by PIP, including CRC.">inb_octets</a> = pip_stat_inb_octsx.<a class="code" href="unioncvmx__pip__stat__inb__octsx.html#a910838db9eb8d29f9afb4e2d65aa16be">s</a>.<a class="code" href="structcvmx__pip__stat__inb__octsx_1_1cvmx__pip__stat__inb__octsx__s.html#afda4a947a0c7985c7f8177e2457fbabb">octs</a>;
<a name="l00823"></a>00823     status-&gt;<a class="code" href="structcvmx__pip__port__status__t.html#ac8921e9ddc1a62666d16ddb0ecd4f943" title="Number of packets with GMX/SPX/PCI errors received by PIP.">inb_errors</a> = pip_stat_inb_errsx.<a class="code" href="unioncvmx__pip__stat__inb__errsx.html#ae95904ea762e72d456b4c522809617ce">s</a>.<a class="code" href="structcvmx__pip__stat__inb__errsx_1_1cvmx__pip__stat__inb__errsx__s.html#ad197a17851e7a7a44f4cde6b83fac8c0">errs</a>;
<a name="l00824"></a>00824 }
<a name="l00825"></a>00825 <span class="comment"></span>
<a name="l00826"></a>00826 <span class="comment">/**</span>
<a name="l00827"></a>00827 <span class="comment"> * Get the status counters for a port.</span>
<a name="l00828"></a>00828 <span class="comment"> *</span>
<a name="l00829"></a>00829 <span class="comment"> * @param port_num Port number (ipd_port) to get statistics for.</span>
<a name="l00830"></a>00830 <span class="comment"> * @param clear    Set to 1 to clear the counters after they are read</span>
<a name="l00831"></a>00831 <span class="comment"> * @param status   Where to put the results.</span>
<a name="l00832"></a>00832 <span class="comment"> */</span>
<a name="l00833"></a><a class="code" href="cvmx-pip_8h.html#a8aeb8823c52e2453e56f0e15c693261f">00833</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cvmx-pip_8h.html#a8aeb8823c52e2453e56f0e15c693261f" title="Get the status counters for a port.">cvmx_pip_get_port_status</a>(uint64_t port_num, uint64_t clear, <a class="code" href="structcvmx__pip__port__status__t.html" title="Status statistics for a port.">cvmx_pip_port_status_t</a> *status)
<a name="l00834"></a>00834 {
<a name="l00835"></a>00835     <span class="keywordflow">if</span> (<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7a26ef4abb4a4fcbba59ae3fd0553cbcab" title="Octeon has PKI block.">OCTEON_FEATURE_PKI</a>)) {
<a name="l00836"></a>00836         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structcvmx__xport.html#a8fae03b3058163de6d8e50d4badff736">node</a> = <a class="code" href="cvmx-access_8h.html#a9d019c6d93cab6e1f83e62029631b017" title="Number of the node on which the program is currently running.">cvmx_get_node_num</a>();
<a name="l00837"></a>00837         <a class="code" href="cvmx-pki_8h.html#a644af7b7d803e3b7fec9d38678a24d95" title="Get the statistics counters for a port.">cvmx_pki_get_port_stats</a>(node, port_num, (<span class="keyword">struct</span> <a class="code" href="structcvmx__pki__port__stats.html" title="Status statistics for a port.">cvmx_pki_port_stats</a> *)status);
<a name="l00838"></a>00838     } <span class="keywordflow">else</span> {
<a name="l00839"></a>00839         <a class="code" href="cvmx-pip_8h.html#a1f6a15efe3144974276af11d5fbea099" title="Get the status counters for a port for older non PKI chips.">cvmx_pip_get_port_stats</a>(port_num, clear, status);
<a name="l00840"></a>00840     }
<a name="l00841"></a>00841 }
<a name="l00842"></a>00842 <span class="comment"></span>
<a name="l00843"></a>00843 <span class="comment">/**</span>
<a name="l00844"></a>00844 <span class="comment"> * Configure the hardware CRC engine</span>
<a name="l00845"></a>00845 <span class="comment"> *</span>
<a name="l00846"></a>00846 <span class="comment"> * @param interface Interface to configure (0 or 1)</span>
<a name="l00847"></a>00847 <span class="comment"> * @param invert_result</span>
<a name="l00848"></a>00848 <span class="comment"> *                 Invert the result of the CRC</span>
<a name="l00849"></a>00849 <span class="comment"> * @param reflect  Reflect</span>
<a name="l00850"></a>00850 <span class="comment"> * @param initialization_vector</span>
<a name="l00851"></a>00851 <span class="comment"> *                 CRC initialization vector</span>
<a name="l00852"></a>00852 <span class="comment"> */</span>
<a name="l00853"></a><a class="code" href="cvmx-pip_8h.html#a2fd246fbdebbbe7de057079c8aac452d">00853</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cvmx-pip_8h.html#a2fd246fbdebbbe7de057079c8aac452d" title="Configure the hardware CRC engine.">cvmx_pip_config_crc</a>(uint64_t interface, uint64_t invert_result, uint64_t reflect, uint32_t initialization_vector)
<a name="l00854"></a>00854 {
<a name="l00855"></a>00855     <span class="keywordflow">if</span> ((<a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#a57cc1539d4ccd8a3f02cbae896921e7a">OCTEON_CN38XX</a>) || <a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#a1dcb35dfe2470e48d615523821a80fe0">OCTEON_CN58XX</a>))) {
<a name="l00856"></a>00856         <a class="code" href="unioncvmx__pip__crc__ctlx.html" title="cvmx_pip_crc_ctl#">cvmx_pip_crc_ctlx_t</a> config;
<a name="l00857"></a>00857         <a class="code" href="unioncvmx__pip__crc__ivx.html" title="cvmx_pip_crc_iv#">cvmx_pip_crc_ivx_t</a> pip_crc_ivx;
<a name="l00858"></a>00858 
<a name="l00859"></a>00859         config.<a class="code" href="unioncvmx__pip__crc__ctlx.html#aa9724c5bf397913057fbd63ff16147a3">u64</a> = 0;
<a name="l00860"></a>00860         config.<a class="code" href="unioncvmx__pip__crc__ctlx.html#a520b183711a8ab40e1798c960973cd0d">s</a>.<a class="code" href="structcvmx__pip__crc__ctlx_1_1cvmx__pip__crc__ctlx__s.html#a32710a2ef0a5a00a3e119f8dbd8c70f9">invres</a> = invert_result;
<a name="l00861"></a>00861         config.<a class="code" href="unioncvmx__pip__crc__ctlx.html#a520b183711a8ab40e1798c960973cd0d">s</a>.<a class="code" href="structcvmx__pip__crc__ctlx_1_1cvmx__pip__crc__ctlx__s.html#a5ead69b1d653810f29d304835aa615c3">reflect</a> = reflect;
<a name="l00862"></a>00862         <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a02ab79c3951d2f12646ab13ca9a87fa9">CVMX_PIP_CRC_CTLX</a>(interface), config.<a class="code" href="unioncvmx__pip__crc__ctlx.html#aa9724c5bf397913057fbd63ff16147a3">u64</a>);
<a name="l00863"></a>00863 
<a name="l00864"></a>00864         pip_crc_ivx.<a class="code" href="unioncvmx__pip__crc__ivx.html#a9b877c8af0e3c59198466ed9e8d5de67">u64</a> = 0;
<a name="l00865"></a>00865         pip_crc_ivx.<a class="code" href="unioncvmx__pip__crc__ivx.html#a822950b84b08644bdbb3717a9f7f5cbe">s</a>.<a class="code" href="structcvmx__pip__crc__ivx_1_1cvmx__pip__crc__ivx__s.html#a1bf45ac739ec2fb1fbab438010326171">iv</a> = initialization_vector;
<a name="l00866"></a>00866         <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a38539cea2091b86a6863cb424c824f2e">CVMX_PIP_CRC_IVX</a>(interface), pip_crc_ivx.<a class="code" href="unioncvmx__pip__crc__ivx.html#a9b877c8af0e3c59198466ed9e8d5de67">u64</a>);
<a name="l00867"></a>00867     }
<a name="l00868"></a>00868 }
<a name="l00869"></a>00869 <span class="comment"></span>
<a name="l00870"></a>00870 <span class="comment">/**</span>
<a name="l00871"></a>00871 <span class="comment"> * Clear all bits in a tag mask. This should be called on</span>
<a name="l00872"></a>00872 <span class="comment"> * startup before any calls to cvmx_pip_tag_mask_set. Each bit</span>
<a name="l00873"></a>00873 <span class="comment"> * set in the final mask represent a byte used in the packet for</span>
<a name="l00874"></a>00874 <span class="comment"> * tag generation.</span>
<a name="l00875"></a>00875 <span class="comment"> *</span>
<a name="l00876"></a>00876 <span class="comment"> * @param mask_index Which tag mask to clear (0..3)</span>
<a name="l00877"></a>00877 <span class="comment"> */</span>
<a name="l00878"></a><a class="code" href="cvmx-pip_8h.html#a02b2d0404453117bdcad1032f9e06182">00878</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cvmx-pip_8h.html#a02b2d0404453117bdcad1032f9e06182" title="Clear all bits in a tag mask.">cvmx_pip_tag_mask_clear</a>(uint64_t mask_index)
<a name="l00879"></a>00879 {
<a name="l00880"></a>00880     uint64_t index;
<a name="l00881"></a>00881     <a class="code" href="unioncvmx__pip__tag__incx.html" title="cvmx_pip_tag_inc#">cvmx_pip_tag_incx_t</a> pip_tag_incx;
<a name="l00882"></a>00882     pip_tag_incx.<a class="code" href="unioncvmx__pip__tag__incx.html#a9ab18d6f40750235dbd6673b54a8d278">u64</a> = 0;
<a name="l00883"></a>00883     pip_tag_incx.<a class="code" href="unioncvmx__pip__tag__incx.html#add4822c2df3e0beed82c002af6bbfc3d">s</a>.<a class="code" href="structcvmx__pip__tag__incx_1_1cvmx__pip__tag__incx__s.html#af45de12fe6c68005a184905ebf6c5c62">en</a> = 0;
<a name="l00884"></a>00884     <span class="keywordflow">for</span> (index = mask_index * 16; index &lt; (mask_index + 1) * 16; index++)
<a name="l00885"></a>00885         <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#aee15960e6410f5c67e8ebaba8f5fdc17">CVMX_PIP_TAG_INCX</a>(index), pip_tag_incx.<a class="code" href="unioncvmx__pip__tag__incx.html#a9ab18d6f40750235dbd6673b54a8d278">u64</a>);
<a name="l00886"></a>00886 }
<a name="l00887"></a>00887 <span class="comment"></span>
<a name="l00888"></a>00888 <span class="comment">/**</span>
<a name="l00889"></a>00889 <span class="comment"> * Sets a range of bits in the tag mask. The tag mask is used</span>
<a name="l00890"></a>00890 <span class="comment"> * when the cvmx_pip_port_tag_cfg_t tag_mode is non zero.</span>
<a name="l00891"></a>00891 <span class="comment"> * There are four separate masks that can be configured.</span>
<a name="l00892"></a>00892 <span class="comment"> *</span>
<a name="l00893"></a>00893 <span class="comment"> * @param mask_index Which tag mask to modify (0..3)</span>
<a name="l00894"></a>00894 <span class="comment"> * @param offset     Offset into the bitmask to set bits at. Use the GCC macro</span>
<a name="l00895"></a>00895 <span class="comment"> *                   offsetof() to determine the offsets into packet headers.</span>
<a name="l00896"></a>00896 <span class="comment"> *                   For example, offsetof(ethhdr, protocol) returns the offset</span>
<a name="l00897"></a>00897 <span class="comment"> *                   of the ethernet protocol field.  The bitmask selects which bytes</span>
<a name="l00898"></a>00898 <span class="comment"> *                   to include the the tag, with bit offset X selecting byte at offset X</span>
<a name="l00899"></a>00899 <span class="comment"> *                   from the beginning of the packet data.</span>
<a name="l00900"></a>00900 <span class="comment"> * @param len        Number of bytes to include. Usually this is the sizeof()</span>
<a name="l00901"></a>00901 <span class="comment"> *                   the field.</span>
<a name="l00902"></a>00902 <span class="comment"> */</span>
<a name="l00903"></a><a class="code" href="cvmx-pip_8h.html#adb8fd964a014a51cf02a8f7ebdf278d1">00903</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cvmx-pip_8h.html#adb8fd964a014a51cf02a8f7ebdf278d1" title="Sets a range of bits in the tag mask.">cvmx_pip_tag_mask_set</a>(uint64_t mask_index, uint64_t offset, uint64_t len)
<a name="l00904"></a>00904 {
<a name="l00905"></a>00905     <span class="keywordflow">while</span> (len--) {
<a name="l00906"></a>00906         <a class="code" href="unioncvmx__pip__tag__incx.html" title="cvmx_pip_tag_inc#">cvmx_pip_tag_incx_t</a> pip_tag_incx;
<a name="l00907"></a>00907         uint64_t index = mask_index * 16 + offset / 8;
<a name="l00908"></a>00908         pip_tag_incx.<a class="code" href="unioncvmx__pip__tag__incx.html#a9ab18d6f40750235dbd6673b54a8d278">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#aee15960e6410f5c67e8ebaba8f5fdc17">CVMX_PIP_TAG_INCX</a>(index));
<a name="l00909"></a>00909         pip_tag_incx.<a class="code" href="unioncvmx__pip__tag__incx.html#add4822c2df3e0beed82c002af6bbfc3d">s</a>.<a class="code" href="structcvmx__pip__tag__incx_1_1cvmx__pip__tag__incx__s.html#af45de12fe6c68005a184905ebf6c5c62">en</a> |= 0x80 &gt;&gt; (offset &amp; 0x7);
<a name="l00910"></a>00910         <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#aee15960e6410f5c67e8ebaba8f5fdc17">CVMX_PIP_TAG_INCX</a>(index), pip_tag_incx.<a class="code" href="unioncvmx__pip__tag__incx.html#a9ab18d6f40750235dbd6673b54a8d278">u64</a>);
<a name="l00911"></a>00911         offset++;
<a name="l00912"></a>00912     }
<a name="l00913"></a>00913 }
<a name="l00914"></a>00914 <span class="comment"></span>
<a name="l00915"></a>00915 <span class="comment">/**</span>
<a name="l00916"></a>00916 <span class="comment"> * Set byte count for Max-Sized and Min Sized frame check.</span>
<a name="l00917"></a>00917 <span class="comment"> *</span>
<a name="l00918"></a>00918 <span class="comment"> * @param interface   Which interface to set the limit</span>
<a name="l00919"></a>00919 <span class="comment"> * @param max_size    Byte count for Max-Size frame check</span>
<a name="l00920"></a>00920 <span class="comment"> */</span>
<a name="l00921"></a><a class="code" href="cvmx-pip_8h.html#ad35f7f0b12c6e611d476954e2ee50afc">00921</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cvmx-pip_8h.html#ad35f7f0b12c6e611d476954e2ee50afc" title="Set byte count for Max-Sized and Min Sized frame check.">cvmx_pip_set_frame_check</a>(<span class="keywordtype">int</span> interface, uint32_t max_size)
<a name="l00922"></a>00922 {
<a name="l00923"></a>00923     <a class="code" href="unioncvmx__pip__frm__len__chkx.html" title="cvmx_pip_frm_len_chk#">cvmx_pip_frm_len_chkx_t</a> frm_len;
<a name="l00924"></a>00924 
<a name="l00925"></a>00925     <span class="comment">/* max_size and min_size are passed as 0, reset to default values. */</span>
<a name="l00926"></a>00926     <span class="keywordflow">if</span> (max_size &lt; 1536)
<a name="l00927"></a>00927         max_size = 1536;
<a name="l00928"></a>00928 
<a name="l00929"></a>00929     <span class="comment">/* On CN68XX frame check is enabled for a pkind n and</span>
<a name="l00930"></a>00930 <span class="comment">       PIP_PRT_CFG[len_chk_sel] selects which set of</span>
<a name="l00931"></a>00931 <span class="comment">       MAXLEN/MINLEN to use. */</span>
<a name="l00932"></a>00932     <span class="keywordflow">if</span> (<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7a843fbb8e614293c03f6a0a4602e1ca6c" title="CN68XX uses port kinds for packet interface.">OCTEON_FEATURE_PKND</a>)) {
<a name="l00933"></a>00933         <span class="keywordtype">int</span> <a class="code" href="structcvmx__xport.html#a2a8a69ab70c4a95b32c35cc2780db54c">port</a>;
<a name="l00934"></a>00934         <span class="keywordtype">int</span> num_ports = <a class="code" href="cvmx-helper_8c.html#a65498658b470d0b574652773be5e142c" title="Return the number of ports on an interface.">cvmx_helper_ports_on_interface</a>(interface);
<a name="l00935"></a>00935         <span class="keywordflow">for</span> (port = 0; port &lt; num_ports; port++) {
<a name="l00936"></a>00936             <span class="keywordflow">if</span> (<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7a26ef4abb4a4fcbba59ae3fd0553cbcab" title="Octeon has PKI block.">OCTEON_FEATURE_PKI</a>)) {
<a name="l00937"></a>00937                 <span class="keywordtype">int</span> ipd_port;
<a name="l00938"></a>00938                 ipd_port = <a class="code" href="cvmx-helper-util_8c.html#a6780536f9fc6a7ab67ef9fe95c0d6be8" title="Returns the IPD port number for a port on the given interface.">cvmx_helper_get_ipd_port</a>(interface, port);
<a name="l00939"></a>00939                 <a class="code" href="cvmx-helper-pki_8c.html#a457569095951cbcf21ea30d36ff8897b" title="Modifies maximum frame length to check.">cvmx_pki_set_max_frm_len</a>(ipd_port, max_size);
<a name="l00940"></a>00940             } <span class="keywordflow">else</span> {
<a name="l00941"></a>00941                 <span class="keywordtype">int</span> pknd;
<a name="l00942"></a>00942                 <span class="keywordtype">int</span> sel;
<a name="l00943"></a>00943                 <a class="code" href="unioncvmx__pip__prt__cfgx.html" title="cvmx_pip_prt_cfg#">cvmx_pip_prt_cfgx_t</a> config;
<a name="l00944"></a>00944                 pknd = <a class="code" href="cvmx-helper-util_8c.html#a2e063bd86eddaab06d8962136d3c958d" title="Get port kind for a given port in an interface.">cvmx_helper_get_pknd</a>(interface, port);
<a name="l00945"></a>00945                 config.<a class="code" href="unioncvmx__pip__prt__cfgx.html#aaaf9297b7407fa03dc2866001bdaaa1c">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#af1b3d60cfcd2839949323eb830935fbe">CVMX_PIP_PRT_CFGX</a>(pknd));
<a name="l00946"></a>00946                 sel = config.<a class="code" href="unioncvmx__pip__prt__cfgx.html#a4ab66cddab612207a961173ca16b5727">s</a>.<a class="code" href="structcvmx__pip__prt__cfgx_1_1cvmx__pip__prt__cfgx__s.html#ad95fd875f21e6e56bab7afa30c401e7d">len_chk_sel</a>;
<a name="l00947"></a>00947                 frm_len.<a class="code" href="unioncvmx__pip__frm__len__chkx.html#ad67b5bad0d199d955db79ab6d2b90a5e">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a01465d2437c009307147a26752d6529b">CVMX_PIP_FRM_LEN_CHKX</a>(sel));
<a name="l00948"></a>00948                 frm_len.<a class="code" href="unioncvmx__pip__frm__len__chkx.html#a18c1b8e189f14c367444258e9ee947a7">s</a>.<a class="code" href="structcvmx__pip__frm__len__chkx_1_1cvmx__pip__frm__len__chkx__s.html#a58511e735534ad107d54195c97b0b1ef">maxlen</a> = max_size;
<a name="l00949"></a>00949                 <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a01465d2437c009307147a26752d6529b">CVMX_PIP_FRM_LEN_CHKX</a>(sel), frm_len.<a class="code" href="unioncvmx__pip__frm__len__chkx.html#ad67b5bad0d199d955db79ab6d2b90a5e">u64</a>);
<a name="l00950"></a>00950             }
<a name="l00951"></a>00951         }
<a name="l00952"></a>00952     }
<a name="l00953"></a>00953     <span class="comment">/* Update for each interface */</span>
<a name="l00954"></a>00954     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#ab2f0e30e085a78717a2b98c3349c221c">OCTEON_CN52XX</a>)
<a name="l00955"></a>00955          || <a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#aecde4ceb9a18f483ac910431675fd946">OCTEON_CN56XX</a>)
<a name="l00956"></a>00956          || <a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#aa42aafa3d25fe1b064454703eb4c52ba">OCTEON_CN50XX</a>)) {
<a name="l00957"></a>00957         frm_len.<a class="code" href="unioncvmx__pip__frm__len__chkx.html#ad67b5bad0d199d955db79ab6d2b90a5e">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a01465d2437c009307147a26752d6529b">CVMX_PIP_FRM_LEN_CHKX</a>(interface));
<a name="l00958"></a>00958         frm_len.<a class="code" href="unioncvmx__pip__frm__len__chkx.html#a18c1b8e189f14c367444258e9ee947a7">s</a>.<a class="code" href="structcvmx__pip__frm__len__chkx_1_1cvmx__pip__frm__len__chkx__s.html#a58511e735534ad107d54195c97b0b1ef">maxlen</a> = max_size;
<a name="l00959"></a>00959         <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a01465d2437c009307147a26752d6529b">CVMX_PIP_FRM_LEN_CHKX</a>(interface), frm_len.<a class="code" href="unioncvmx__pip__frm__len__chkx.html#ad67b5bad0d199d955db79ab6d2b90a5e">u64</a>);
<a name="l00960"></a>00960     }
<a name="l00961"></a>00961     <span class="comment">/* on cn6xxx and cn7xxx models, PIP_FRM_LEN_CHK0 applies to</span>
<a name="l00962"></a>00962 <span class="comment">     *     all incoming traffic */</span>
<a name="l00963"></a>00963     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="octeon-model_8h.html#a78957577097ca57aff89f64acce0084f">OCTEON_IS_OCTEON2</a>() || <a class="code" href="octeon-model_8h.html#a9234ac9e9f35fafd7fe5eedd37c9b552">OCTEON_IS_MODEL</a>(<a class="code" href="octeon-model_8h.html#a65b975e6fd418a613995cd1bd685a287">OCTEON_CN70XX</a>)) {
<a name="l00964"></a>00964         frm_len.<a class="code" href="unioncvmx__pip__frm__len__chkx.html#ad67b5bad0d199d955db79ab6d2b90a5e">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a01465d2437c009307147a26752d6529b">CVMX_PIP_FRM_LEN_CHKX</a>(0));
<a name="l00965"></a>00965         frm_len.<a class="code" href="unioncvmx__pip__frm__len__chkx.html#a18c1b8e189f14c367444258e9ee947a7">s</a>.<a class="code" href="structcvmx__pip__frm__len__chkx_1_1cvmx__pip__frm__len__chkx__s.html#a58511e735534ad107d54195c97b0b1ef">maxlen</a> = max_size;
<a name="l00966"></a>00966         <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a01465d2437c009307147a26752d6529b">CVMX_PIP_FRM_LEN_CHKX</a>(0), frm_len.<a class="code" href="unioncvmx__pip__frm__len__chkx.html#ad67b5bad0d199d955db79ab6d2b90a5e">u64</a>);
<a name="l00967"></a>00967     }
<a name="l00968"></a>00968 }
<a name="l00969"></a>00969 <span class="comment"></span>
<a name="l00970"></a>00970 <span class="comment">/**</span>
<a name="l00971"></a>00971 <span class="comment"> * Initialize Bit Select Extractor config. Their are 8 bit positions and valids</span>
<a name="l00972"></a>00972 <span class="comment"> * to be used when using the corresponding extractor.</span>
<a name="l00973"></a>00973 <span class="comment"> *</span>
<a name="l00974"></a>00974 <span class="comment"> * @param bit     Bit Select Extractor to use</span>
<a name="l00975"></a>00975 <span class="comment"> * @param pos     Which position to update</span>
<a name="l00976"></a>00976 <span class="comment"> * @param val     The value to update the position with</span>
<a name="l00977"></a>00977 <span class="comment"> */</span>
<a name="l00978"></a><a class="code" href="cvmx-pip_8h.html#adb7b0c8f55ef1481eb9390ec0167f2aa">00978</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cvmx-pip_8h.html#adb7b0c8f55ef1481eb9390ec0167f2aa" title="Initialize Bit Select Extractor config.">cvmx_pip_set_bsel_pos</a>(<span class="keywordtype">int</span> bit, <span class="keywordtype">int</span> pos, <span class="keywordtype">int</span> val)
<a name="l00979"></a>00979 {
<a name="l00980"></a>00980     <a class="code" href="unioncvmx__pip__bsel__ext__posx.html" title="cvmx_pip_bsel_ext_pos#">cvmx_pip_bsel_ext_posx_t</a> bsel_pos;
<a name="l00981"></a>00981 
<a name="l00982"></a>00982     <span class="comment">/* The bit select extractor is available in CN61XX and CN68XX pass2.0 onwards. */</span>
<a name="l00983"></a>00983     <span class="keywordflow">if</span> (!<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7ac7fa638f0640fd617bd6359705b72667" title="Octeon has Bit Select Extractor schedulor.">OCTEON_FEATURE_BIT_EXTRACTOR</a>))
<a name="l00984"></a>00984         <span class="keywordflow">return</span>;
<a name="l00985"></a>00985 
<a name="l00986"></a>00986     <span class="keywordflow">if</span> (bit &lt; 0 || bit &gt; 3) {
<a name="l00987"></a>00987         <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;ERROR: cvmx_pip_set_bsel_pos: Invalid Bit-Select Extractor (%d) passed\n&quot;</span>, bit);
<a name="l00988"></a>00988         <span class="keywordflow">return</span>;
<a name="l00989"></a>00989     }
<a name="l00990"></a>00990 
<a name="l00991"></a>00991     bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#adb2809e341893ea3958987476f98d9ca">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a8cd069d522044e55eda70476321c3217">CVMX_PIP_BSEL_EXT_POSX</a>(bit));
<a name="l00992"></a>00992     <span class="keywordflow">switch</span> (pos) {
<a name="l00993"></a>00993     <span class="keywordflow">case</span> 0:
<a name="l00994"></a>00994         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a5cf0061799cda9b210607f476cdc7f53">pos0_val</a> = 1;
<a name="l00995"></a>00995         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a57effe83b6bbcb2a5f794d6b593e77f0">pos0</a> = val &amp; 0x7f;
<a name="l00996"></a>00996         <span class="keywordflow">break</span>;
<a name="l00997"></a>00997     <span class="keywordflow">case</span> 1:
<a name="l00998"></a>00998         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#abd7be421cb9753fbdee22a9b3f84c9db">pos1_val</a> = 1;
<a name="l00999"></a>00999         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a738b0b221b061c240c2f192e493216b8">pos1</a> = val &amp; 0x7f;
<a name="l01000"></a>01000         <span class="keywordflow">break</span>;
<a name="l01001"></a>01001     <span class="keywordflow">case</span> 2:
<a name="l01002"></a>01002         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a91411e22a3fa7076eb666fb33b6fac5a">pos2_val</a> = 1;
<a name="l01003"></a>01003         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a0f8f9989f6b51ae82234fd4f0858af54">pos2</a> = val &amp; 0x7f;
<a name="l01004"></a>01004         <span class="keywordflow">break</span>;
<a name="l01005"></a>01005     <span class="keywordflow">case</span> 3:
<a name="l01006"></a>01006         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a00b259a7f3d5c3a06987c662b4d19ba0">pos3_val</a> = 1;
<a name="l01007"></a>01007         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a6104abdd57149124a727a4989ad0c3e8">pos3</a> = val &amp; 0x7f;
<a name="l01008"></a>01008         <span class="keywordflow">break</span>;
<a name="l01009"></a>01009     <span class="keywordflow">case</span> 4:
<a name="l01010"></a>01010         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a6b24123995c6a5ded3fd7a08b8300fe9">pos4_val</a> = 1;
<a name="l01011"></a>01011         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a0b516eb3e87e05c121ad2b217791fcdd">pos4</a> = val &amp; 0x7f;
<a name="l01012"></a>01012         <span class="keywordflow">break</span>;
<a name="l01013"></a>01013     <span class="keywordflow">case</span> 5:
<a name="l01014"></a>01014         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a245d91f290b90726c08b9ecdcfc3b778">pos5_val</a> = 1;
<a name="l01015"></a>01015         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a6a77dc0014dc2c2c67c0020837419bb9">pos5</a> = val &amp; 0x7f;
<a name="l01016"></a>01016         <span class="keywordflow">break</span>;
<a name="l01017"></a>01017     <span class="keywordflow">case</span> 6:
<a name="l01018"></a>01018         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a7f22afb13cd7f2ec82897e1b993923fb">pos6_val</a> = 1;
<a name="l01019"></a>01019         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#ae1c50a967404ad70d697153d63a79690">pos6</a> = val &amp; 0x7f;
<a name="l01020"></a>01020         <span class="keywordflow">break</span>;
<a name="l01021"></a>01021     <span class="keywordflow">case</span> 7:
<a name="l01022"></a>01022         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#ab8357807e083db1c062d67eaaf8772ba">pos7_val</a> = 1;
<a name="l01023"></a>01023         bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#ae5ad9ab51ae48b4f7034b1ddcd501ac3">pos7</a> = val &amp; 0x7f;
<a name="l01024"></a>01024         <span class="keywordflow">break</span>;
<a name="l01025"></a>01025     <span class="keywordflow">default</span>:
<a name="l01026"></a>01026         <a class="code" href="cvmx-utils_8h.html#a50112e4e118a749dcf244ccafcdc37ba">cvmx_dprintf</a>(<span class="stringliteral">&quot;Warning: cvmx_pip_set_bsel_pos: Invalid pos(%d)\n&quot;</span>, pos);
<a name="l01027"></a>01027         <span class="keywordflow">break</span>;
<a name="l01028"></a>01028     }
<a name="l01029"></a>01029     <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a8cd069d522044e55eda70476321c3217">CVMX_PIP_BSEL_EXT_POSX</a>(bit), bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#adb2809e341893ea3958987476f98d9ca">u64</a>);
<a name="l01030"></a>01030 }
<a name="l01031"></a>01031 <span class="comment"></span>
<a name="l01032"></a>01032 <span class="comment">/**</span>
<a name="l01033"></a>01033 <span class="comment"> * Initialize offset and skip values to use by bit select extractor.</span>
<a name="l01034"></a>01034 <span class="comment"></span>
<a name="l01035"></a>01035 <span class="comment"> * @param bit       Bit Select Extractor to use</span>
<a name="l01036"></a>01036 <span class="comment"> * @param offset    Offset to add to extractor mem addr to get final address</span>
<a name="l01037"></a>01037 <span class="comment"> *          to lookup table.</span>
<a name="l01038"></a>01038 <span class="comment"> * @param skip      Number of bytes to skip from start of packet 0-64</span>
<a name="l01039"></a>01039 <span class="comment"> */</span>
<a name="l01040"></a><a class="code" href="cvmx-pip_8h.html#a27f6d80b2fb7c201374621c970c3b86e">01040</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="cvmx-pip_8h.html#a27f6d80b2fb7c201374621c970c3b86e" title="Initialize offset and skip values to use by bit select extractor.">cvmx_pip_bsel_config</a>(<span class="keywordtype">int</span> bit, <span class="keywordtype">int</span> offset, <span class="keywordtype">int</span> skip)
<a name="l01041"></a>01041 {
<a name="l01042"></a>01042     <a class="code" href="unioncvmx__pip__bsel__ext__cfgx.html" title="cvmx_pip_bsel_ext_cfg#">cvmx_pip_bsel_ext_cfgx_t</a> bsel_cfg;
<a name="l01043"></a>01043 
<a name="l01044"></a>01044     <span class="comment">/* The bit select extractor is available in CN61XX and CN68XX pass2.0 onwards. */</span>
<a name="l01045"></a>01045     <span class="keywordflow">if</span> (!<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7ac7fa638f0640fd617bd6359705b72667" title="Octeon has Bit Select Extractor schedulor.">OCTEON_FEATURE_BIT_EXTRACTOR</a>))
<a name="l01046"></a>01046         <span class="keywordflow">return</span>;
<a name="l01047"></a>01047 
<a name="l01048"></a>01048     bsel_cfg.<a class="code" href="unioncvmx__pip__bsel__ext__cfgx.html#ad58ca48035c1884b3a3c96317385a102">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ad2cfde5e97358655a431f050dd6021b1">CVMX_PIP_BSEL_EXT_CFGX</a>(bit));
<a name="l01049"></a>01049     bsel_cfg.<a class="code" href="unioncvmx__pip__bsel__ext__cfgx.html#a0689881c7ccfc828339a84e6cb84a836">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__cfgx_1_1cvmx__pip__bsel__ext__cfgx__s.html#a642bd63a560caa480d17fe720b1b7772">offset</a> = offset;
<a name="l01050"></a>01050     bsel_cfg.<a class="code" href="unioncvmx__pip__bsel__ext__cfgx.html#a0689881c7ccfc828339a84e6cb84a836">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__cfgx_1_1cvmx__pip__bsel__ext__cfgx__s.html#a180dc1f2ae694ea1662ed18d09be5a21">skip</a> = skip;
<a name="l01051"></a>01051     <a class="code" href="cvmx-usb_8c.html#ab647f34c57823e589be07188a96a501b">cvmx_write_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ad2cfde5e97358655a431f050dd6021b1">CVMX_PIP_BSEL_EXT_CFGX</a>(bit), bsel_cfg.<a class="code" href="unioncvmx__pip__bsel__ext__cfgx.html#ad58ca48035c1884b3a3c96317385a102">u64</a>);
<a name="l01052"></a>01052 }
<a name="l01053"></a>01053 <span class="comment"></span>
<a name="l01054"></a>01054 <span class="comment">/**</span>
<a name="l01055"></a>01055 <span class="comment"> * Get the entry for the Bit Select Extractor Table.</span>
<a name="l01056"></a>01056 <span class="comment"> * @param work   pointer to work queue entry</span>
<a name="l01057"></a>01057 <span class="comment"> * @return       Index of the Bit Select Extractor Table</span>
<a name="l01058"></a>01058 <span class="comment"> */</span>
<a name="l01059"></a><a class="code" href="cvmx-pip_8h.html#afecf7bb22f46e58cf568f94700e575b7">01059</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="cvmx-pip_8h.html#afecf7bb22f46e58cf568f94700e575b7" title="Get the entry for the Bit Select Extractor Table.">cvmx_pip_get_bsel_table_index</a>(<a class="code" href="structcvmx__wqe__s.html" title="Work queue entry format.">cvmx_wqe_t</a> *work)
<a name="l01060"></a>01060 {
<a name="l01061"></a>01061     <span class="keywordtype">int</span> bit = <a class="code" href="cvmx-wqe_8h.html#a9570b015bdd999612c72c3200ed1730b">cvmx_wqe_get_port</a>(work) &amp; 0x3;
<a name="l01062"></a>01062     <span class="comment">/* Get the Bit select table index. */</span>
<a name="l01063"></a>01063     <span class="keywordtype">int</span> index;
<a name="l01064"></a>01064     <span class="keywordtype">int</span> y;
<a name="l01065"></a>01065     <a class="code" href="unioncvmx__pip__bsel__ext__cfgx.html" title="cvmx_pip_bsel_ext_cfg#">cvmx_pip_bsel_ext_cfgx_t</a> bsel_cfg;
<a name="l01066"></a>01066     <a class="code" href="unioncvmx__pip__bsel__ext__posx.html" title="cvmx_pip_bsel_ext_pos#">cvmx_pip_bsel_ext_posx_t</a> bsel_pos;
<a name="l01067"></a>01067 
<a name="l01068"></a>01068     <span class="comment">/* The bit select extractor is available in CN61XX and CN68XX pass2.0 onwards. */</span>
<a name="l01069"></a>01069     <span class="keywordflow">if</span> (!<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7ac7fa638f0640fd617bd6359705b72667" title="Octeon has Bit Select Extractor schedulor.">OCTEON_FEATURE_BIT_EXTRACTOR</a>))
<a name="l01070"></a>01070         <span class="keywordflow">return</span> -1;
<a name="l01071"></a>01071 
<a name="l01072"></a>01072     bsel_cfg.<a class="code" href="unioncvmx__pip__bsel__ext__cfgx.html#ad58ca48035c1884b3a3c96317385a102">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ad2cfde5e97358655a431f050dd6021b1">CVMX_PIP_BSEL_EXT_CFGX</a>(bit));
<a name="l01073"></a>01073     bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#adb2809e341893ea3958987476f98d9ca">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#a8cd069d522044e55eda70476321c3217">CVMX_PIP_BSEL_EXT_POSX</a>(bit));
<a name="l01074"></a>01074 
<a name="l01075"></a>01075     <span class="keywordflow">for</span> (y = 0; y &lt; 8; y++) {
<a name="l01076"></a>01076         <span class="keywordtype">char</span> *ptr = (<span class="keywordtype">char</span> *)<a class="code" href="cvmx-access_8h.html#a9adf20d6b29145111460ecbc6fbca3dd" title="Convert a hardware physical address (uint64_t) into a memory pointer (void *).">cvmx_phys_to_ptr</a>(work-&gt;<a class="code" href="structcvmx__wqe__s.html#a5dcd5b40716d41209227039d479af803">packet_ptr</a>.<a class="code" href="unioncvmx__buf__ptr.html#a14f33b3072f84ff79b4461a40bf6d00a">s</a>.<a class="code" href="unioncvmx__buf__ptr.html#a1bb22d795f59a5f4d646e81efcdb872d">addr</a>);
<a name="l01077"></a>01077         <span class="keywordtype">int</span> bit_loc = 0;
<a name="l01078"></a>01078         <span class="keywordtype">int</span> bit;
<a name="l01079"></a>01079 
<a name="l01080"></a>01080         ptr += bsel_cfg.<a class="code" href="unioncvmx__pip__bsel__ext__cfgx.html#a0689881c7ccfc828339a84e6cb84a836">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__cfgx_1_1cvmx__pip__bsel__ext__cfgx__s.html#a180dc1f2ae694ea1662ed18d09be5a21">skip</a>;
<a name="l01081"></a>01081         <span class="keywordflow">switch</span> (y) {
<a name="l01082"></a>01082         <span class="keywordflow">case</span> 0:
<a name="l01083"></a>01083             ptr += (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a57effe83b6bbcb2a5f794d6b593e77f0">pos0</a> &gt;&gt; 3);
<a name="l01084"></a>01084             bit_loc = 7 - (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a57effe83b6bbcb2a5f794d6b593e77f0">pos0</a> &amp; 0x3);
<a name="l01085"></a>01085             <span class="keywordflow">break</span>;
<a name="l01086"></a>01086         <span class="keywordflow">case</span> 1:
<a name="l01087"></a>01087             ptr += (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a738b0b221b061c240c2f192e493216b8">pos1</a> &gt;&gt; 3);
<a name="l01088"></a>01088             bit_loc = 7 - (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a738b0b221b061c240c2f192e493216b8">pos1</a> &amp; 0x3);
<a name="l01089"></a>01089             <span class="keywordflow">break</span>;
<a name="l01090"></a>01090         <span class="keywordflow">case</span> 2:
<a name="l01091"></a>01091             ptr += (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a0f8f9989f6b51ae82234fd4f0858af54">pos2</a> &gt;&gt; 3);
<a name="l01092"></a>01092             bit_loc = 7 - (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a0f8f9989f6b51ae82234fd4f0858af54">pos2</a> &amp; 0x3);
<a name="l01093"></a>01093             <span class="keywordflow">break</span>;
<a name="l01094"></a>01094         <span class="keywordflow">case</span> 3:
<a name="l01095"></a>01095             ptr += (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a6104abdd57149124a727a4989ad0c3e8">pos3</a> &gt;&gt; 3);
<a name="l01096"></a>01096             bit_loc = 7 - (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a6104abdd57149124a727a4989ad0c3e8">pos3</a> &amp; 0x3);
<a name="l01097"></a>01097             <span class="keywordflow">break</span>;
<a name="l01098"></a>01098         <span class="keywordflow">case</span> 4:
<a name="l01099"></a>01099             ptr += (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a0b516eb3e87e05c121ad2b217791fcdd">pos4</a> &gt;&gt; 3);
<a name="l01100"></a>01100             bit_loc = 7 - (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a0b516eb3e87e05c121ad2b217791fcdd">pos4</a> &amp; 0x3);
<a name="l01101"></a>01101             <span class="keywordflow">break</span>;
<a name="l01102"></a>01102         <span class="keywordflow">case</span> 5:
<a name="l01103"></a>01103             ptr += (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a6a77dc0014dc2c2c67c0020837419bb9">pos5</a> &gt;&gt; 3);
<a name="l01104"></a>01104             bit_loc = 7 - (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#a6a77dc0014dc2c2c67c0020837419bb9">pos5</a> &amp; 0x3);
<a name="l01105"></a>01105             <span class="keywordflow">break</span>;
<a name="l01106"></a>01106         <span class="keywordflow">case</span> 6:
<a name="l01107"></a>01107             ptr += (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#ae1c50a967404ad70d697153d63a79690">pos6</a> &gt;&gt; 3);
<a name="l01108"></a>01108             bit_loc = 7 - (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#ae1c50a967404ad70d697153d63a79690">pos6</a> &amp; 0x3);
<a name="l01109"></a>01109             <span class="keywordflow">break</span>;
<a name="l01110"></a>01110         <span class="keywordflow">case</span> 7:
<a name="l01111"></a>01111             ptr += (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#ae5ad9ab51ae48b4f7034b1ddcd501ac3">pos7</a> &gt;&gt; 3);
<a name="l01112"></a>01112             bit_loc = 7 - (bsel_pos.<a class="code" href="unioncvmx__pip__bsel__ext__posx.html#a3cb5a90c652201dcc5ca55e6d1779b43">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__posx_1_1cvmx__pip__bsel__ext__posx__s.html#ae5ad9ab51ae48b4f7034b1ddcd501ac3">pos7</a> &amp; 0x3);
<a name="l01113"></a>01113             <span class="keywordflow">break</span>;
<a name="l01114"></a>01114         }
<a name="l01115"></a>01115         bit = (*ptr &gt;&gt; bit_loc) &amp; 1;
<a name="l01116"></a>01116         index |= bit &lt;&lt; y;
<a name="l01117"></a>01117     }
<a name="l01118"></a>01118     index += bsel_cfg.<a class="code" href="unioncvmx__pip__bsel__ext__cfgx.html#a0689881c7ccfc828339a84e6cb84a836">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__cfgx_1_1cvmx__pip__bsel__ext__cfgx__s.html#a642bd63a560caa480d17fe720b1b7772">offset</a>;
<a name="l01119"></a>01119     index &amp;= 0x1ff;
<a name="l01120"></a>01120     <span class="keywordflow">return</span> index;
<a name="l01121"></a>01121 }
<a name="l01122"></a>01122 
<a name="l01123"></a><a class="code" href="cvmx-pip_8h.html#a54b446f202141927b9a1651c7bc5ea19">01123</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="cvmx-pip_8h.html#a54b446f202141927b9a1651c7bc5ea19">cvmx_pip_get_bsel_qos</a>(<a class="code" href="structcvmx__wqe__s.html" title="Work queue entry format.">cvmx_wqe_t</a> *work)
<a name="l01124"></a>01124 {
<a name="l01125"></a>01125     <span class="keywordtype">int</span> index = <a class="code" href="cvmx-pip_8h.html#afecf7bb22f46e58cf568f94700e575b7" title="Get the entry for the Bit Select Extractor Table.">cvmx_pip_get_bsel_table_index</a>(work);
<a name="l01126"></a>01126     <a class="code" href="unioncvmx__pip__bsel__tbl__entx.html" title="cvmx_pip_bsel_tbl_ent#">cvmx_pip_bsel_tbl_entx_t</a> bsel_tbl;
<a name="l01127"></a>01127 
<a name="l01128"></a>01128     <span class="comment">/* The bit select extractor is available in CN61XX and CN68XX pass2.0 onwards. */</span>
<a name="l01129"></a>01129     <span class="keywordflow">if</span> (!<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7ac7fa638f0640fd617bd6359705b72667" title="Octeon has Bit Select Extractor schedulor.">OCTEON_FEATURE_BIT_EXTRACTOR</a>))
<a name="l01130"></a>01130         <span class="keywordflow">return</span> -1;
<a name="l01131"></a>01131 
<a name="l01132"></a>01132     bsel_tbl.<a class="code" href="unioncvmx__pip__bsel__tbl__entx.html#a662ca1677bc23df58cf5c1a58ef5c55b">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ae754a0d12219502e621da4a8af423980">CVMX_PIP_BSEL_TBL_ENTX</a>(index));
<a name="l01133"></a>01133 
<a name="l01134"></a>01134     <span class="keywordflow">return</span> bsel_tbl.<a class="code" href="unioncvmx__pip__bsel__tbl__entx.html#acf708e10c80a435583de204eee5bd9a6">s</a>.<a class="code" href="structcvmx__pip__bsel__tbl__entx_1_1cvmx__pip__bsel__tbl__entx__s.html#abb7bc4fe93b30152171bf1f7a57f8609">qos</a>;
<a name="l01135"></a>01135 }
<a name="l01136"></a>01136 
<a name="l01137"></a><a class="code" href="cvmx-pip_8h.html#a230e1cb44c834f1723ac175ea830a006">01137</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="cvmx-pip_8h.html#a230e1cb44c834f1723ac175ea830a006">cvmx_pip_get_bsel_grp</a>(<a class="code" href="structcvmx__wqe__s.html" title="Work queue entry format.">cvmx_wqe_t</a> *work)
<a name="l01138"></a>01138 {
<a name="l01139"></a>01139     <span class="keywordtype">int</span> index = <a class="code" href="cvmx-pip_8h.html#afecf7bb22f46e58cf568f94700e575b7" title="Get the entry for the Bit Select Extractor Table.">cvmx_pip_get_bsel_table_index</a>(work);
<a name="l01140"></a>01140     <a class="code" href="unioncvmx__pip__bsel__tbl__entx.html" title="cvmx_pip_bsel_tbl_ent#">cvmx_pip_bsel_tbl_entx_t</a> bsel_tbl;
<a name="l01141"></a>01141 
<a name="l01142"></a>01142     <span class="comment">/* The bit select extractor is available in CN61XX and CN68XX pass2.0 onwards. */</span>
<a name="l01143"></a>01143     <span class="keywordflow">if</span> (!<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7ac7fa638f0640fd617bd6359705b72667" title="Octeon has Bit Select Extractor schedulor.">OCTEON_FEATURE_BIT_EXTRACTOR</a>))
<a name="l01144"></a>01144         <span class="keywordflow">return</span> -1;
<a name="l01145"></a>01145 
<a name="l01146"></a>01146     bsel_tbl.<a class="code" href="unioncvmx__pip__bsel__tbl__entx.html#a662ca1677bc23df58cf5c1a58ef5c55b">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ae754a0d12219502e621da4a8af423980">CVMX_PIP_BSEL_TBL_ENTX</a>(index));
<a name="l01147"></a>01147 
<a name="l01148"></a>01148     <span class="keywordflow">return</span> bsel_tbl.<a class="code" href="unioncvmx__pip__bsel__tbl__entx.html#acf708e10c80a435583de204eee5bd9a6">s</a>.<a class="code" href="structcvmx__pip__bsel__tbl__entx_1_1cvmx__pip__bsel__tbl__entx__s.html#a0ec74bbe9fc41b46f89441c07ef31461">grp</a>;
<a name="l01149"></a>01149 }
<a name="l01150"></a>01150 
<a name="l01151"></a><a class="code" href="cvmx-pip_8h.html#a66977f71b58325f0de9a25587e55990b">01151</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="cvmx-pip_8h.html#a66977f71b58325f0de9a25587e55990b">cvmx_pip_get_bsel_tt</a>(<a class="code" href="structcvmx__wqe__s.html" title="Work queue entry format.">cvmx_wqe_t</a> *work)
<a name="l01152"></a>01152 {
<a name="l01153"></a>01153     <span class="keywordtype">int</span> index = <a class="code" href="cvmx-pip_8h.html#afecf7bb22f46e58cf568f94700e575b7" title="Get the entry for the Bit Select Extractor Table.">cvmx_pip_get_bsel_table_index</a>(work);
<a name="l01154"></a>01154     <a class="code" href="unioncvmx__pip__bsel__tbl__entx.html" title="cvmx_pip_bsel_tbl_ent#">cvmx_pip_bsel_tbl_entx_t</a> bsel_tbl;
<a name="l01155"></a>01155 
<a name="l01156"></a>01156     <span class="comment">/* The bit select extractor is available in CN61XX and CN68XX pass2.0 onwards. */</span>
<a name="l01157"></a>01157     <span class="keywordflow">if</span> (!<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7ac7fa638f0640fd617bd6359705b72667" title="Octeon has Bit Select Extractor schedulor.">OCTEON_FEATURE_BIT_EXTRACTOR</a>))
<a name="l01158"></a>01158         <span class="keywordflow">return</span> -1;
<a name="l01159"></a>01159 
<a name="l01160"></a>01160     bsel_tbl.<a class="code" href="unioncvmx__pip__bsel__tbl__entx.html#a662ca1677bc23df58cf5c1a58ef5c55b">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ae754a0d12219502e621da4a8af423980">CVMX_PIP_BSEL_TBL_ENTX</a>(index));
<a name="l01161"></a>01161 
<a name="l01162"></a>01162     <span class="keywordflow">return</span> bsel_tbl.<a class="code" href="unioncvmx__pip__bsel__tbl__entx.html#acf708e10c80a435583de204eee5bd9a6">s</a>.<a class="code" href="structcvmx__pip__bsel__tbl__entx_1_1cvmx__pip__bsel__tbl__entx__s.html#a004d13eef37534ef4f9a4afabf7750e9">tt</a>;
<a name="l01163"></a>01163 }
<a name="l01164"></a>01164 
<a name="l01165"></a><a class="code" href="cvmx-pip_8h.html#ab6470d311fa9e6ae0d9bdf619e7ed9f4">01165</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="cvmx-pip_8h.html#ab6470d311fa9e6ae0d9bdf619e7ed9f4">cvmx_pip_get_bsel_tag</a>(<a class="code" href="structcvmx__wqe__s.html" title="Work queue entry format.">cvmx_wqe_t</a> *work)
<a name="l01166"></a>01166 {
<a name="l01167"></a>01167     <span class="keywordtype">int</span> index = <a class="code" href="cvmx-pip_8h.html#afecf7bb22f46e58cf568f94700e575b7" title="Get the entry for the Bit Select Extractor Table.">cvmx_pip_get_bsel_table_index</a>(work);
<a name="l01168"></a>01168     <span class="keywordtype">int</span> <a class="code" href="structcvmx__xport.html#a2a8a69ab70c4a95b32c35cc2780db54c">port</a> = <a class="code" href="cvmx-wqe_8h.html#a9570b015bdd999612c72c3200ed1730b">cvmx_wqe_get_port</a>(work);
<a name="l01169"></a>01169     <span class="keywordtype">int</span> bit = port &amp; 0x3;
<a name="l01170"></a>01170     <span class="keywordtype">int</span> upper_tag = 0;
<a name="l01171"></a>01171     <a class="code" href="unioncvmx__pip__bsel__tbl__entx.html" title="cvmx_pip_bsel_tbl_ent#">cvmx_pip_bsel_tbl_entx_t</a> bsel_tbl;
<a name="l01172"></a>01172     <a class="code" href="unioncvmx__pip__bsel__ext__cfgx.html" title="cvmx_pip_bsel_ext_cfg#">cvmx_pip_bsel_ext_cfgx_t</a> bsel_cfg;
<a name="l01173"></a>01173     <a class="code" href="unioncvmx__pip__prt__tagx.html" title="cvmx_pip_prt_tag#">cvmx_pip_prt_tagx_t</a> prt_tag;
<a name="l01174"></a>01174 
<a name="l01175"></a>01175     <span class="comment">/* The bit select extractor is available in CN61XX and CN68XX pass2.0 onwards. */</span>
<a name="l01176"></a>01176     <span class="keywordflow">if</span> (!<a class="code" href="octeon-feature_8h.html#aff993843ac5c34fbf4ce933f7274e2f9">octeon_has_feature</a>(<a class="code" href="octeon-feature_8h.html#ae50822e9c863ca2dea27ff57d39ba3d7ac7fa638f0640fd617bd6359705b72667" title="Octeon has Bit Select Extractor schedulor.">OCTEON_FEATURE_BIT_EXTRACTOR</a>))
<a name="l01177"></a>01177         <span class="keywordflow">return</span> -1;
<a name="l01178"></a>01178 
<a name="l01179"></a>01179     bsel_tbl.<a class="code" href="unioncvmx__pip__bsel__tbl__entx.html#a662ca1677bc23df58cf5c1a58ef5c55b">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ae754a0d12219502e621da4a8af423980">CVMX_PIP_BSEL_TBL_ENTX</a>(index));
<a name="l01180"></a>01180     bsel_cfg.<a class="code" href="unioncvmx__pip__bsel__ext__cfgx.html#ad58ca48035c1884b3a3c96317385a102">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ad2cfde5e97358655a431f050dd6021b1">CVMX_PIP_BSEL_EXT_CFGX</a>(bit));
<a name="l01181"></a>01181 
<a name="l01182"></a>01182     prt_tag.<a class="code" href="unioncvmx__pip__prt__tagx.html#a5d9b0b769082bdb9c94cdf880306b682">u64</a> = <a class="code" href="cvmx-usb_8c.html#af74058148304a28824f934994c132b63">cvmx_read_csr</a>(<a class="code" href="cvmx-pip-defs_8h.html#ab6f4ecba4367f729d3b7d09391b065ae">CVMX_PIP_PRT_TAGX</a>(port));
<a name="l01183"></a>01183     <span class="keywordflow">if</span> (prt_tag.<a class="code" href="unioncvmx__pip__prt__tagx.html#a349ad126ce5abb6be784ecd20f47436a">s</a>.<a class="code" href="structcvmx__pip__prt__tagx_1_1cvmx__pip__prt__tagx__s.html#ad170a16d7a9ac52aacc97c43c440c360">inc_prt_flag</a> == 0)
<a name="l01184"></a>01184         upper_tag = bsel_cfg.<a class="code" href="unioncvmx__pip__bsel__ext__cfgx.html#a0689881c7ccfc828339a84e6cb84a836">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__cfgx_1_1cvmx__pip__bsel__ext__cfgx__s.html#a76779948544747b578abcc2662ed8a2a">upper_tag</a>;
<a name="l01185"></a>01185     <span class="keywordflow">return</span> bsel_tbl.<a class="code" href="unioncvmx__pip__bsel__tbl__entx.html#acf708e10c80a435583de204eee5bd9a6">s</a>.<a class="code" href="structcvmx__pip__bsel__tbl__entx_1_1cvmx__pip__bsel__tbl__entx__s.html#aeee129ec1e19f04f3f0110df1883103b">tag</a> | ((bsel_cfg.<a class="code" href="unioncvmx__pip__bsel__ext__cfgx.html#a0689881c7ccfc828339a84e6cb84a836">s</a>.<a class="code" href="structcvmx__pip__bsel__ext__cfgx_1_1cvmx__pip__bsel__ext__cfgx__s.html#ae5a3c2bacb0f832a0fd89a7add2ba761">tag</a> &lt;&lt; 8) &amp; 0xff00) | ((upper_tag &lt;&lt; 16) &amp; 0xffff0000);
<a name="l01186"></a>01186 }
<a name="l01187"></a>01187 
<a name="l01188"></a>01188 <span class="preprocessor">#ifdef  __cplusplus</span>
<a name="l01189"></a>01189 <span class="preprocessor"></span><span class="comment">/* *INDENT-OFF* */</span>
<a name="l01190"></a>01190 }
<a name="l01191"></a>01191 <span class="comment">/* *INDENT-ON* */</span>
<a name="l01192"></a>01192 <span class="preprocessor">#endif</span>
<a name="l01193"></a>01193 <span class="preprocessor"></span>
<a name="l01194"></a>01194 <span class="preprocessor">#endif </span><span class="comment">/*  __CVMX_PIP_H__ */</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 27 Oct 2017 for Octeon Software Development Kit by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
