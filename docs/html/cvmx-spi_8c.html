<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Octeon Software Development Kit: cvmx-spi.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>cvmx-spi.c File Reference</h1>
<p>Support library for the SPI.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="cvmx_8h_source.html">cvmx.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cvmx-sysinfo_8h_source.html">cvmx-sysinfo.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cvmx-hwpko_8h_source.html">cvmx-hwpko.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cvmx-spi_8h_source.html">cvmx-spi.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cvmx-clock_8h_source.html">cvmx-clock.h</a>&quot;</code><br/>
<div class="dynheader">
Include dependency graph for cvmx-spi.c:</div>
<div class="dynsection">
<div class="center"><img src="cvmx-spi_8c__incl.png" border="0" usemap="#cvmx-spi_8c_map" alt=""/></div>
<map name="cvmx-spi_8c_map" id="cvmx-spi_8c">
<area shape="rect" id="node3" href="cvmx_8h.html" title="Main Octeon executive header file (This should be the second header file included..." alt="" coords="1229,392,1299,421"/><area shape="rect" id="node36" href="cvmx-sysinfo_8h.html" title="This module provides system/board information obtained by the bootloader." alt="" coords="1897,469,2020,499"/><area shape="rect" id="node62" href="cvmx-clock_8h.html" title="Interface to Core, IO and DDR Clock." alt="" coords="1764,469,1873,499"/><area shape="rect" id="node82" href="cvmx-hwpko_8h.html" title="Interface to the hardware Packet Output unit." alt="" coords="711,83,828,112"/><area shape="rect" id="node133" href="cvmx-spi_8h.html" title="This file contains defines for the SPI interface." alt="" coords="1849,83,1943,112"/><area shape="rect" id="node5" href="cvmx-platform_8h.html" title="This file is resposible for including all system dependent headers for the cvmx&#45;*..." alt="" coords="1229,547,1363,576"/><area shape="rect" id="node25" href="cvmx-access_8h.html" title="Function prototypes for accessing memory and CSRs on Octeon." alt="" coords="1457,547,1580,576"/><area shape="rect" id="node27" href="cvmx-address_8h.html" title="Typedefs and defines for working with Octeon physical addresses." alt="" coords="828,469,956,499"/><area shape="rect" id="node30" href="cvmx-asm_8h.html" title="This is file defines ASM primitives for the executive." alt="" coords="843,701,947,731"/><area shape="rect" id="node32" href="cvmx-packet_8h.html" title="Packet buffer defines." alt="" coords="1252,469,1375,499"/><area shape="rect" id="node34" href="cvmx-warn_8h.html" title="Functions for warning users about errors and such." alt="" coords="680,469,789,499"/><area shape="rect" id="node46" href="octeon-model_8h.html" title="File defining different Octeon model IDs and macros to compare them." alt="" coords="1399,469,1527,499"/><area shape="rect" id="node48" href="cvmx-csr_8h.html" title="Configuration and status register (CSR) address and type definitions for Octoen." alt="" coords="980,469,1076,499"/><area shape="rect" id="node59" href="cvmx-utils_8h.html" title="Small utility functions and macros to ease programming of Octeon." alt="" coords="1675,547,1779,576"/><area shape="rect" id="node65" href="octeon-feature_8h.html" title="File defining checks for different Octeon features." alt="" coords="1551,469,1689,499"/><area shape="rect" id="node67" href="cvmx-fpa_8h.html" title="Interface to the hardware Free Pool Allocator." alt="" coords="529,469,628,499"/><area shape="rect" id="node7" href="cvmx-abi_8h.html" title="This file defines macros for use in determining the current calling ABI." alt="" coords="932,624,1028,653"/><area shape="rect" id="node38" href="cvmx-app-init_8h.html" title="Header file for simple executive application initialization." alt="" coords="1803,547,1931,576"/><area shape="rect" id="node40" href="cvmx-coremask_8h.html" title="Module to support operations on bitmap of cores." alt="" coords="1796,624,1937,653"/><area shape="rect" id="node51" href="cvmx-csr-enums_8h.html" title="Definitions for enumerations used with Octeon CSRs." alt="" coords="936,547,1083,576"/><area shape="rect" id="node53" href="cvmx-csr-typedefs_8h.html" title="Configuration and status register (CSR) address and type definitions for Octeon." alt="" coords="699,547,861,576"/><area shape="rect" id="node55" href="cvmx-fpa-defs_8h.html" title="cvmx&#45;fpa&#45;defs.h" alt="" coords="595,624,728,653"/><area shape="rect" id="node57" href="cvmx-pko-defs_8h.html" title="cvmx&#45;pko&#45;defs.h" alt="" coords="437,624,571,653"/><area shape="rect" id="node69" href="cvmx-scratch_8h.html" title="This file provides support for the processor local scratch memory." alt="" coords="285,624,413,653"/><area shape="rect" id="node73" href="cvmx-fpa1_8h.html" title="Interface to the hardware Free Pool Allocator on Octeon chips." alt="" coords="387,547,493,576"/><area shape="rect" id="node77" href="cvmx-fpa3_8h.html" title="Interface to the CN78XX Free Pool Allocator, a.k.a." alt="" coords="517,547,624,576"/><area shape="rect" id="node84" href="cvmx-hwfau_8h.html" title="Interface to the hardware Fetch and Add Unit." alt="" coords="663,160,780,189"/><area shape="rect" id="node87" href="cvmx-pow_8h.html" title="Interface to the hardware Scheduling unit." alt="" coords="643,315,744,344"/><area shape="rect" id="node94" href="cvmx-pko3_8h.html" title="cvmx&#45;pko3.h" alt="" coords="353,160,460,189"/><area shape="rect" id="node99" href="cvmx-helper_8h.html" title="Helper functions for common, but complicated tasks." alt="" coords="1023,237,1140,267"/><area shape="rect" id="node111" href="cvmx-helper-util_8h.html" title="Small helper utilities." alt="" coords="768,315,912,344"/><area shape="rect" id="node123" href="cvmx-cmd-queue_8h.html" title="Support functions for managing command queues used for various hardware blocks." alt="" coords="5,160,160,189"/><area shape="rect" id="node128" href="cvmx-helper-cfg_8h.html" title="Helper Functions for the Configuration Framework." alt="" coords="855,237,999,267"/><area shape="rect" id="node131" href="cvmx-helper-pko_8h.html" title="PKO helper, configuration API." alt="" coords="905,160,1052,189"/><area shape="rect" id="node90" href="cvmx-wqe_8h.html" title="This header file defines the work queue entry (wqe) data structure." alt="" coords="897,392,1001,421"/><area shape="rect" id="node97" href="cvmx-pko3-queue_8h.html" title="cvmx&#45;pko3&#45;queue.h" alt="" coords="387,237,541,267"/><area shape="rect" id="node116" href="cvmx-ilk_8h.html" title="This file contains defines for the ILK interface." alt="" coords="565,237,656,267"/><area shape="rect" id="node119" href="cvmx-atomic_8h.html" title="This file provides atomic operations." alt="" coords="35,237,157,267"/><area shape="rect" id="node102" href="cvmx-helper-fpa_8h.html" title="Helper functions for FPA setup." alt="" coords="987,315,1131,344"/><area shape="rect" id="node104" href="cvmx-helper-agl_8h.html" title="Functions for AGL (RGMII) initialization, configuration, and monitoring." alt="" coords="1344,315,1485,344"/><area shape="rect" id="node108" href="cvmx-helper-errata_8h.html" title="Fixes and workaround for Octeon chip errata." alt="" coords="1155,315,1320,344"/></map>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvmx-spi_8c.html#a9b97745ad42a45ff411055c7544e3deb">INVOKE_CB</a>(function_p, args...)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvmx-spi_8c.html#a34287897ae0869dc8dc286ce3f6de4a7">cvmx_spi_get_callbacks</a> (<a class="el" href="structcvmx__spi__callbacks__t.html">cvmx_spi_callbacks_t</a> *callbacks)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get current SPI4 initialization callbacks.  <a href="#a34287897ae0869dc8dc286ce3f6de4a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvmx-spi_8c.html#a9560dc3435d8abef9697229d08add61c">cvmx_spi_set_callbacks</a> (<a class="el" href="structcvmx__spi__callbacks__t.html">cvmx_spi_callbacks_t</a> *new_callbacks)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set new SPI4 initialization callbacks.  <a href="#a9560dc3435d8abef9697229d08add61c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvmx-spi_8c.html#a707be6d1afe85158db5d545f58f37e46">cvmx_spi_start_interface</a> (int interface, <a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a> mode, int timeout, int num_ports)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize and start the SPI interface.  <a href="#a707be6d1afe85158db5d545f58f37e46"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvmx-spi_8c.html#a0e31ef09c3897ab6343286d27cbf9ec2">cvmx_spi_restart_interface</a> (int interface, <a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a> mode, int timeout)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This routine restarts the SPI interface after it has lost synchronization with its correspondent system.  <a href="#a0e31ef09c3897ab6343286d27cbf9ec2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvmx-spi_8c.html#afb7412134cc2ce92944972c7db1d4818">EXPORT_SYMBOL</a> (cvmx_spi_restart_interface)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvmx-spi_8c.html#a6d81ea3725d3051f6e1ba08f3f71b029">cvmx_spi_reset_cb</a> (int interface, <a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a> mode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Callback to perform SPI4 reset.  <a href="#a6d81ea3725d3051f6e1ba08f3f71b029"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvmx-spi_8c.html#a1475ec897234b01130107eb767d2a7c5">cvmx_spi_calendar_setup_cb</a> (int interface, <a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a> mode, int num_ports)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Callback to setup calendar and miscellaneous settings before clock detection.  <a href="#a1475ec897234b01130107eb767d2a7c5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvmx-spi_8c.html#a9855423a848dadd4f2ab463f0093783b">cvmx_spi_clock_detect_cb</a> (int interface, <a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a> mode, int timeout)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Callback to perform clock detection.  <a href="#a9855423a848dadd4f2ab463f0093783b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvmx-spi_8c.html#a4c178908c3a7c4dde235b38374d398ce">cvmx_spi_training_cb</a> (int interface, <a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a> mode, int timeout)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Callback to perform link training.  <a href="#a4c178908c3a7c4dde235b38374d398ce"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvmx-spi_8c.html#a944acdbed7c7342615dc08545888435b">cvmx_spi_calendar_sync_cb</a> (int interface, <a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a> mode, int timeout)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Callback to perform calendar data synchronization.  <a href="#a944acdbed7c7342615dc08545888435b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvmx-spi_8c.html#adc3221ad169e9bd473e4b6eda7400089">cvmx_spi_interface_up_cb</a> (int interface, <a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a> mode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Callback to handle interface up.  <a href="#adc3221ad169e9bd473e4b6eda7400089"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structcvmx__spi__callbacks__t.html">cvmx_spi_callbacks_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cvmx-spi_8c.html#ad61fcc180efdaed5b8c90361a999a595">cvmx_spi_callbacks</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Support library for the SPI. </p>
<hr/>
<dl class="rcs"><dt><b>Revision</b></dt><dd>95258 </dd></dl>
<hr/>
 <hr/><h2>Define Documentation</h2>
<a class="anchor" id="a9b97745ad42a45ff411055c7544e3deb"></a><!-- doxytag: member="cvmx&#45;spi.c::INVOKE_CB" ref="a9b97745ad42a45ff411055c7544e3deb" args="(function_p, args...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INVOKE_CB</td>
          <td>(</td>
          <td class="paramtype">function_p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">args...&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keywordflow">do</span> {                    \
        <span class="keywordflow">if</span> (function_p) {       \
            res = function_p(args); \
            <span class="keywordflow">if</span> (res)        \
                <span class="keywordflow">return</span> res; \
        }               \
    } <span class="keywordflow">while</span> (0)
</pre></div>
</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a1475ec897234b01130107eb767d2a7c5"></a><!-- doxytag: member="cvmx&#45;spi.c::cvmx_spi_calendar_setup_cb" ref="a1475ec897234b01130107eb767d2a7c5" args="(int interface, cvmx_spi_mode_t mode, int num_ports)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cvmx_spi_calendar_setup_cb </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>interface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>num_ports</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Callback to setup calendar and miscellaneous settings before clock detection. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>interface</em>&nbsp;</td><td>The identifier of the packet interface to configure and use as a SPI interface. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>The operating mode for the SPI interface. The interface can operate as a full duplex (both Tx and Rx data paths active) or as a halfplex (either the Tx data path is active or the Rx data path is active, but not both). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>num_ports</em>&nbsp;</td><td>Number of ports to configure on SPI </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Zero on success, non-zero error code on failure (will cause SPI initialization to abort) </dd></dl>

</div>
</div>
<a class="anchor" id="a944acdbed7c7342615dc08545888435b"></a><!-- doxytag: member="cvmx&#45;spi.c::cvmx_spi_calendar_sync_cb" ref="a944acdbed7c7342615dc08545888435b" args="(int interface, cvmx_spi_mode_t mode, int timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cvmx_spi_calendar_sync_cb </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>interface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Callback to perform calendar data synchronization. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>interface</em>&nbsp;</td><td>The identifier of the packet interface to configure and use as a SPI interface. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>The operating mode for the SPI interface. The interface can operate as a full duplex (both Tx and Rx data paths active) or as a halfplex (either the Tx data path is active or the Rx data path is active, but not both). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>Timeout to wait for calendar data in seconds </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Zero on success, non-zero error code on failure (will cause SPI initialization to abort) </dd></dl>

</div>
</div>
<a class="anchor" id="a9855423a848dadd4f2ab463f0093783b"></a><!-- doxytag: member="cvmx&#45;spi.c::cvmx_spi_clock_detect_cb" ref="a9855423a848dadd4f2ab463f0093783b" args="(int interface, cvmx_spi_mode_t mode, int timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cvmx_spi_clock_detect_cb </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>interface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Callback to perform clock detection. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>interface</em>&nbsp;</td><td>The identifier of the packet interface to configure and use as a SPI interface. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>The operating mode for the SPI interface. The interface can operate as a full duplex (both Tx and Rx data paths active) or as a halfplex (either the Tx data path is active or the Rx data path is active, but not both). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>Timeout to wait for clock synchronization in seconds </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Zero on success, non-zero error code on failure (will cause SPI initialization to abort) </dd></dl>

</div>
</div>
<a class="anchor" id="a34287897ae0869dc8dc286ce3f6de4a7"></a><!-- doxytag: member="cvmx&#45;spi.c::cvmx_spi_get_callbacks" ref="a34287897ae0869dc8dc286ce3f6de4a7" args="(cvmx_spi_callbacks_t *callbacks)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cvmx_spi_get_callbacks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcvmx__spi__callbacks__t.html">cvmx_spi_callbacks_t</a> *&nbsp;</td>
          <td class="paramname"> <em>callbacks</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get current SPI4 initialization callbacks. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>callbacks</em>&nbsp;</td><td>Pointer to the callbacks structure.to fill</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Pointer to <a class="el" href="structcvmx__spi__callbacks__t.html" title="Callbacks structure to customize SPI4 initialization sequence.">cvmx_spi_callbacks_t</a> structure. </dd></dl>

</div>
</div>
<a class="anchor" id="adc3221ad169e9bd473e4b6eda7400089"></a><!-- doxytag: member="cvmx&#45;spi.c::cvmx_spi_interface_up_cb" ref="adc3221ad169e9bd473e4b6eda7400089" args="(int interface, cvmx_spi_mode_t mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cvmx_spi_interface_up_cb </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>interface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Callback to handle interface up. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>interface</em>&nbsp;</td><td>The identifier of the packet interface to configure and use as a SPI interface. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>The operating mode for the SPI interface. The interface can operate as a full duplex (both Tx and Rx data paths active) or as a halfplex (either the Tx data path is active or the Rx data path is active, but not both). </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Zero on success, non-zero error code on failure (will cause SPI initialization to abort) </dd></dl>

</div>
</div>
<a class="anchor" id="a6d81ea3725d3051f6e1ba08f3f71b029"></a><!-- doxytag: member="cvmx&#45;spi.c::cvmx_spi_reset_cb" ref="a6d81ea3725d3051f6e1ba08f3f71b029" args="(int interface, cvmx_spi_mode_t mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cvmx_spi_reset_cb </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>interface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Callback to perform SPI4 reset. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>interface</em>&nbsp;</td><td>The identifier of the packet interface to configure and use as a SPI interface. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>The operating mode for the SPI interface. The interface can operate as a full duplex (both Tx and Rx data paths active) or as a halfplex (either the Tx data path is active or the Rx data path is active, but not both). </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Zero on success, non-zero error code on failure (will cause SPI initialization to abort) </dd></dl>

</div>
</div>
<a class="anchor" id="a0e31ef09c3897ab6343286d27cbf9ec2"></a><!-- doxytag: member="cvmx&#45;spi.c::cvmx_spi_restart_interface" ref="a0e31ef09c3897ab6343286d27cbf9ec2" args="(int interface, cvmx_spi_mode_t mode, int timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cvmx_spi_restart_interface </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>interface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This routine restarts the SPI interface after it has lost synchronization with its correspondent system. </p>
<p>This routine restarts the SPI interface after it has lost synchronization with its corespondant system.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>interface</em>&nbsp;</td><td>The identifier of the packet interface to configure and use as a SPI interface. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>The operating mode for the SPI interface. The interface can operate as a full duplex (both Tx and Rx data paths active) or as a halfplex (either the Tx data path is active or the Rx data path is active, but not both). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>Timeout to wait for clock synchronization in seconds </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Zero on success, negative of failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a9560dc3435d8abef9697229d08add61c"></a><!-- doxytag: member="cvmx&#45;spi.c::cvmx_spi_set_callbacks" ref="a9560dc3435d8abef9697229d08add61c" args="(cvmx_spi_callbacks_t *new_callbacks)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cvmx_spi_set_callbacks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcvmx__spi__callbacks__t.html">cvmx_spi_callbacks_t</a> *&nbsp;</td>
          <td class="paramname"> <em>new_callbacks</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set new SPI4 initialization callbacks. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>new_callbacks</em>&nbsp;</td><td>Pointer to an updated callbacks structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a707be6d1afe85158db5d545f58f37e46"></a><!-- doxytag: member="cvmx&#45;spi.c::cvmx_spi_start_interface" ref="a707be6d1afe85158db5d545f58f37e46" args="(int interface, cvmx_spi_mode_t mode, int timeout, int num_ports)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cvmx_spi_start_interface </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>interface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>num_ports</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize and start the SPI interface. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>interface</em>&nbsp;</td><td>The identifier of the packet interface to configure and use as a SPI interface. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>The operating mode for the SPI interface. The interface can operate as a full duplex (both Tx and Rx data paths active) or as a halfplex (either the Tx data path is active or the Rx data path is active, but not both). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>Timeout to wait for clock synchronization in seconds </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>num_ports</em>&nbsp;</td><td>Number of SPI ports to configure</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Zero on success, negative of failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a4c178908c3a7c4dde235b38374d398ce"></a><!-- doxytag: member="cvmx&#45;spi.c::cvmx_spi_training_cb" ref="a4c178908c3a7c4dde235b38374d398ce" args="(int interface, cvmx_spi_mode_t mode, int timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cvmx_spi_training_cb </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>interface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cvmx-spi_8h.html#aeba9ea10ca44f4837e40cd31441cb3ca">cvmx_spi_mode_t</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Callback to perform link training. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>interface</em>&nbsp;</td><td>The identifier of the packet interface to configure and use as a SPI interface. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>The operating mode for the SPI interface. The interface can operate as a full duplex (both Tx and Rx data paths active) or as a halfplex (either the Tx data path is active or the Rx data path is active, but not both). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>Timeout to wait for link to be trained (in seconds) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Zero on success, non-zero error code on failure (will cause SPI initialization to abort) </dd></dl>

</div>
</div>
<a class="anchor" id="afb7412134cc2ce92944972c7db1d4818"></a><!-- doxytag: member="cvmx&#45;spi.c::EXPORT_SYMBOL" ref="afb7412134cc2ce92944972c7db1d4818" args="(cvmx_spi_restart_interface)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EXPORT_SYMBOL </td>
          <td>(</td>
          <td class="paramtype">cvmx_spi_restart_interface&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ad61fcc180efdaed5b8c90361a999a595"></a><!-- doxytag: member="cvmx&#45;spi.c::cvmx_spi_callbacks" ref="ad61fcc180efdaed5b8c90361a999a595" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcvmx__spi__callbacks__t.html">cvmx_spi_callbacks_t</a> <a class="el" href="cvmx-spi_8c.html#ad61fcc180efdaed5b8c90361a999a595">cvmx_spi_callbacks</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    .reset_cb = <a class="code" href="cvmx-spi_8c.html#a6d81ea3725d3051f6e1ba08f3f71b029" title="Callback to perform SPI4 reset.">cvmx_spi_reset_cb</a>,
    .calendar_setup_cb = <a class="code" href="cvmx-spi_8c.html#a1475ec897234b01130107eb767d2a7c5" title="Callback to setup calendar and miscellaneous settings before clock detection.">cvmx_spi_calendar_setup_cb</a>,
    .clock_detect_cb = <a class="code" href="cvmx-spi_8c.html#a9855423a848dadd4f2ab463f0093783b" title="Callback to perform clock detection.">cvmx_spi_clock_detect_cb</a>,
    .training_cb = <a class="code" href="cvmx-spi_8c.html#a4c178908c3a7c4dde235b38374d398ce" title="Callback to perform link training.">cvmx_spi_training_cb</a>,
    .calendar_sync_cb = <a class="code" href="cvmx-spi_8c.html#a944acdbed7c7342615dc08545888435b" title="Callback to perform calendar data synchronization.">cvmx_spi_calendar_sync_cb</a>,
    .interface_up_cb = <a class="code" href="cvmx-spi_8c.html#adc3221ad169e9bd473e4b6eda7400089" title="Callback to handle interface up.">cvmx_spi_interface_up_cb</a>
}
</pre></div>
</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 27 Oct 2017 for Octeon Software Development Kit by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
