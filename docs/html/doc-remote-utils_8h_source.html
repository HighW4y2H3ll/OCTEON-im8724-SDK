<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Octeon Software Development Kit: doc-remote-utils.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>doc-remote-utils.h</h1><a href="doc-remote-utils_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***********************license start************************************</span>
<a name="l00002"></a>00002 <span class="comment"> * OCTEON SDK</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Copyright (c) 2009 Cavium Inc.. All rights reserved.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * This file, which is part of the OCTEON SDK from Cavium Inc.,</span>
<a name="l00007"></a>00007 <span class="comment"> * contains proprietary and confidential information of Cavium Inc. and</span>
<a name="l00008"></a>00008 <span class="comment"> * its suppliers.</span>
<a name="l00009"></a>00009 <span class="comment"> * Contact Cavium Inc. at info@cavium.com for more information.</span>
<a name="l00010"></a>00010 <span class="comment"> **********************license end**************************************/</span>
<a name="l00011"></a>00011 <span class="comment"></span>
<a name="l00012"></a>00012 <span class="comment">/**</span>
<a name="l00013"></a>00013 <span class="comment"> * @file</span>
<a name="l00014"></a>00014 <span class="comment"> *</span>
<a name="l00015"></a>00015 <span class="comment"> * Remote access to Octeon through PCI, EJTAG, etc.</span>
<a name="l00016"></a>00016 <span class="comment"> * @ref octeon_remote</span>
<a name="l00017"></a>00017 <span class="comment"> */</span>
<a name="l00018"></a>00018 <span class="comment"></span>
<a name="l00019"></a>00019 <span class="comment">/**</span>
<a name="l00020"></a>00020 <span class="comment"></span>
<a name="l00021"></a>00021 <span class="comment">@page octeon_remote Remotely Controlling an OCTEON through PCI, PCIe, or EJTAG.</span>
<a name="l00022"></a>00022 <span class="comment"></span>
<a name="l00023"></a>00023 <span class="comment">@section octeon_remote_intro 1. Introduction</span>
<a name="l00024"></a>00024 <span class="comment"></span>
<a name="l00025"></a>00025 <span class="comment">In development, and production, it may be useful to access and control</span>
<a name="l00026"></a>00026 <span class="comment">OCTEON from a remote host or other communication path.  For example, a PC</span>
<a name="l00027"></a>00027 <span class="comment">may need to boot OCTEON through PCI/PCIe.  At other times you may want to</span>
<a name="l00028"></a>00028 <span class="comment">read registers through EJTAG.  In order to support these conditions,</span>
<a name="l00029"></a>00029 <span class="comment">Cavium Inc has developed a remote protocol library and a number of</span>
<a name="l00030"></a>00030 <span class="comment">special purpose command line utilities.  These utilities allow common</span>
<a name="l00031"></a>00031 <span class="comment">operations like register dumps, read and write of CSRs, and profiling to</span>
<a name="l00032"></a>00032 <span class="comment">be done outside of OCTEON.</span>
<a name="l00033"></a>00033 <span class="comment"></span>
<a name="l00034"></a>00034 <span class="comment">This document provides detailed information on the following aspects of</span>
<a name="l00035"></a>00035 <span class="comment">controlling OCTEON remotely:</span>
<a name="l00036"></a>00036 <span class="comment"></span>
<a name="l00037"></a>00037 <span class="comment">    - @ref octeon_remote_intro</span>
<a name="l00038"></a>00038 <span class="comment">    - @ref octeon_remote_protocols</span>
<a name="l00039"></a>00039 <span class="comment">    - @ref octeon_remote_backwards</span>
<a name="l00040"></a>00040 <span class="comment">    - @ref octeon_remote_boot</span>
<a name="l00041"></a>00041 <span class="comment">    - @ref octeon_remote_bootcmd</span>
<a name="l00042"></a>00042 <span class="comment">    - @ref octeon_remote_console</span>
<a name="l00043"></a>00043 <span class="comment">    - @ref octeon_remote_core</span>
<a name="l00044"></a>00044 <span class="comment">    - @ref octeon_remote_csr</span>
<a name="l00045"></a>00045 <span class="comment">    - @ref octeon_remote_ddr</span>
<a name="l00046"></a>00046 <span class="comment">    - @ref octeon_remote_load</span>
<a name="l00047"></a>00047 <span class="comment">    - @ref octeon_remote_memory</span>
<a name="l00048"></a>00048 <span class="comment">    - @ref octeon_remote_pow</span>
<a name="l00049"></a>00049 <span class="comment">    - @ref octeon_remote_reset</span>
<a name="l00050"></a>00050 <span class="comment">    - @ref octeon_remote_save</span>
<a name="l00051"></a>00051 <span class="comment">    - @ref octeon_remote_tra</span>
<a name="l00052"></a>00052 <span class="comment">    - @ref pci_target_gdb</span>
<a name="l00053"></a>00053 <span class="comment">    - @ref oct-remote-app-ctl</span>
<a name="l00054"></a>00054 <span class="comment"></span>
<a name="l00055"></a>00055 <span class="comment"></span>
<a name="l00056"></a>00056 <span class="comment"></span>
<a name="l00057"></a>00057 <span class="comment"></span>
<a name="l00058"></a>00058 <span class="comment">@section octeon_remote_protocols 2. Supported Remote Protocols</span>
<a name="l00059"></a>00059 <span class="comment"></span>
<a name="l00060"></a>00060 <span class="comment">The OCTEON remote library supports a number of possible protocols for</span>
<a name="l00061"></a>00061 <span class="comment">connecting to OCTEON.  The choice of which protocol to use is controlled</span>
<a name="l00062"></a>00062 <span class="comment">by the environment variable @b OCTEON_REMOTE_PROTOCOL.  If this</span>
<a name="l00063"></a>00063 <span class="comment">environment variable isn&apos;t set, the utilities will display a message</span>
<a name="l00064"></a>00064 <span class="comment">showing the possible supported protocols.  Here is a list of some of the</span>
<a name="l00065"></a>00065 <span class="comment">support protocols:</span>
<a name="l00066"></a>00066 <span class="comment"></span>
<a name="l00067"></a>00067 <span class="comment">- OCTEON_REMOTE_PROTOCOL = PCI[:device]</span>
<a name="l00068"></a>00068 <span class="comment">    - Use PCI/PCIe to access OCTEON from the host or root complex. If</span>
<a name="l00069"></a>00069 <span class="comment">    multiple OCTEON&apos;s are present, the optional &quot;device&quot; number specifies</span>
<a name="l00070"></a>00070 <span class="comment">    which one to use. The first device is number 0.</span>
<a name="l00071"></a>00071 <span class="comment">- OCTEON_REMOTE_PROTOCOL = PCIHOST</span>
<a name="l00072"></a>00072 <span class="comment">    - Use PCI/PCIe to connect to the host OCTEON from a target. This is</span>
<a name="l00073"></a>00073 <span class="comment">    normally only used during development for profiling and register</span>
<a name="l00074"></a>00074 <span class="comment">    dumps. This allows an OCTEON PCI/PCIe target to access the host&apos;s (or</span>
<a name="l00075"></a>00075 <span class="comment">    root complex&apos;s) registers.</span>
<a name="l00076"></a>00076 <span class="comment">- OCTEON_REMOTE_PROTOCOL = MACRAIGOR:name,tcp_port</span>
<a name="l00077"></a>00077 <span class="comment">    - Use a Macraigor mpDemon to access OCTEON through EJTAG. &quot;name&quot; is</span>
<a name="l00078"></a>00078 <span class="comment">    either the host name or IP address of the mpDemon probe. &quot;tcp_port&quot; is</span>
<a name="l00079"></a>00079 <span class="comment">    the TCP port of the probe (normally 1000).</span>
<a name="l00080"></a>00080 <span class="comment">- OCTEON_REMOTE_PROTOCOL = GDB:name,tcp_port</span>
<a name="l00081"></a>00081 <span class="comment">    - Use the GDB remote protocol to access OCTEON. Many brands of EJTAG</span>
<a name="l00082"></a>00082 <span class="comment">    probes supply GDB remote stubs for debugging. The remote utilities</span>
<a name="l00083"></a>00083 <span class="comment">    can use this protocol directly. Abatron, Mentor Graphics, and Macraigor</span>
<a name="l00084"></a>00084 <span class="comment">    are all known to work with this protocol. &quot;name&quot; is either the host</span>
<a name="l00085"></a>00085 <span class="comment">    name or IP address of the GDB stub. &quot;tcp_port&quot; is the TCP port of the</span>
<a name="l00086"></a>00086 <span class="comment">    first core. Each additional core increments the TCP port by one. The</span>
<a name="l00087"></a>00087 <span class="comment">    README.txt files in the sdk/ejtag directory have more information about</span>
<a name="l00088"></a>00088 <span class="comment">    specific probes.</span>
<a name="l00089"></a>00089 <span class="comment">- OCTEON_REMOTE_PROTOCOL = LINUX</span>
<a name="l00090"></a>00090 <span class="comment">    - Assume the utility is running under Linux userspace native on the</span>
<a name="l00091"></a>00091 <span class="comment">    OCTEON. mmap() and debug exception handlers are used to access the</span>
<a name="l00092"></a>00092 <span class="comment">    local OCTEON without modifying the kernel.</span>
<a name="l00093"></a>00093 <span class="comment"></span>
<a name="l00094"></a>00094 <span class="comment">In the event of problems, the environment variable OCTEON_REMOTE_DEBUG can</span>
<a name="l00095"></a>00095 <span class="comment">be used to enable detailed diagnostic information.  Increasing numbers,</span>
<a name="l00096"></a>00096 <span class="comment">show more detail:</span>
<a name="l00097"></a>00097 <span class="comment"></span>
<a name="l00098"></a>00098 <span class="comment">- OCTEON_REMOTE_DEBUG = 0</span>
<a name="l00099"></a>00099 <span class="comment">    - Disables all diagnostic output.</span>
<a name="l00100"></a>00100 <span class="comment">- OCTEON_REMOTE_DEBUG = 1</span>
<a name="l00101"></a>00101 <span class="comment">    - Enables a small amount of informational data.</span>
<a name="l00102"></a>00102 <span class="comment">- OCTEON_REMOTE_DEBUG = 2</span>
<a name="l00103"></a>00103 <span class="comment">    - More diagnostic data is generated.</span>
<a name="l00104"></a>00104 <span class="comment">- OCTEON_REMOTE_DEBUG = 3</span>
<a name="l00105"></a>00105 <span class="comment">    - Call traces of octeon-remote are generated.</span>
<a name="l00106"></a>00106 <span class="comment">- OCTEON_REMOTE_DEBUG = ...</span>
<a name="l00107"></a>00107 <span class="comment">- OCTEON_REMOTE_DEBUG = 9</span>
<a name="l00108"></a>00108 <span class="comment">    - All possible output is enabled.</span>
<a name="l00109"></a>00109 <span class="comment"></span>
<a name="l00110"></a>00110 <span class="comment">Normally debug output from the remote library is color coded based on the</span>
<a name="l00111"></a>00111 <span class="comment">diagnostic level. If you wish to turn the color off, add 256 to the debug</span>
<a name="l00112"></a>00112 <span class="comment">level.</span>
<a name="l00113"></a>00113 <span class="comment"></span>
<a name="l00114"></a>00114 <span class="comment"></span>
<a name="l00115"></a>00115 <span class="comment">@section octeon_remote_backwards 3. Backwards Compatibility with Previous Utilities</span>
<a name="l00116"></a>00116 <span class="comment"></span>
<a name="l00117"></a>00117 <span class="comment">The OCTEON SDK contains a number of trivial shell scripts to allow the</span>
<a name="l00118"></a>00118 <span class="comment">oct-remote-* utilities to act as a drop in replacement for the oct-pci-*</span>
<a name="l00119"></a>00119 <span class="comment">and oct-linux-* utilities provided in previous SDKs.  The functionality of</span>
<a name="l00120"></a>00120 <span class="comment">the older utilities is implemented in the remote utilities when the</span>
<a name="l00121"></a>00121 <span class="comment">OCTEON_REMOTE_PROTOCOL is set appropriately.</span>
<a name="l00122"></a>00122 <span class="comment"></span>
<a name="l00123"></a>00123 <span class="comment">- The scripts for oct-pci-* set OCTEON_REMOTE_PROTOCOL=pci.</span>
<a name="l00124"></a>00124 <span class="comment">- The scripts for oct-linux-* set OCTEON_REMOTE_PROTOCOL=linux.</span>
<a name="l00125"></a>00125 <span class="comment"></span>
<a name="l00126"></a>00126 <span class="comment"></span>
<a name="l00127"></a>00127 <span class="comment"></span>
<a name="l00128"></a>00128 <span class="comment"></span>
<a name="l00129"></a>00129 <span class="comment">@section octeon_remote_boot 4. Booting over PCI or EJTAG (oct-remote-boot)</span>
<a name="l00130"></a>00130 <span class="comment"></span>
<a name="l00131"></a>00131 <span class="comment">OCTEON can be booted from a remote host without the need for a boot flash on</span>
<a name="l00132"></a>00132 <span class="comment">the OCTEON board.  For PCI targets, the OCTEON board must be configured for PCI boot</span>
<a name="l00133"></a>00133 <span class="comment">mode.  This keeps all cores in reset after the chip</span>
<a name="l00134"></a>00134 <span class="comment">is taken out of reset.  For EJTAG boot, the board must _not_ be configured for PCI boot mode,</span>
<a name="l00135"></a>00135 <span class="comment">as core 0 must be running for the EJTAG probe to use. The oct-remote-boot program configures the memory</span>
<a name="l00136"></a>00136 <span class="comment">controller, copies the bootloader to DRAM, and then boots the bootloader.</span>
<a name="l00137"></a>00137 <span class="comment">By default the provided bootloader (target/bin/u-boot-pci.bin) for the detected board is used.  A</span>
<a name="l00138"></a>00138 <span class="comment">different bootloader image can be specified on the command line.</span>
<a name="l00139"></a>00139 <span class="comment">oct-remote-boot also supports a &apos;generic&apos; board type and bootloader that should support</span>
<a name="l00140"></a>00140 <span class="comment">most OCTEON boards.  In order to use the generic board mode, certain board configuration parameters must</span>
<a name="l00141"></a>00141 <span class="comment">be passed on the command line so that oct-remote-boot can configure the memory controller properly.</span>
<a name="l00142"></a>00142 <span class="comment">(The SPD addresses for the DIMMS are required in all cases.)</span>
<a name="l00143"></a>00143 <span class="comment"></span>
<a name="l00144"></a>00144 <span class="comment">For this command to not report an error, stdin must include bootcmd.  This will likely change in</span>
<a name="l00145"></a>00145 <span class="comment">the future to requiring stdin to contain PCI.  By default, both of these are</span>
<a name="l00146"></a>00146 <span class="comment">enabled on boards that support it.</span>
<a name="l00147"></a>00147 <span class="comment"></span>
<a name="l00148"></a>00148 <span class="comment"></span>
<a name="l00149"></a>00149 <span class="comment">@verbatim</span>
<a name="l00150"></a>00150 <span class="comment">Usage: ./oct-remote-boot [--memonly] [--board=board_name] [bootloader filename]</span>
<a name="l00151"></a>00151 <span class="comment">    Boot OCTEON and load bootloader over remote connection (PCI or EJTAG).</span>
<a name="l00152"></a>00152 <span class="comment">    --help: Show this usage.</span>
<a name="l00153"></a>00153 <span class="comment">    --memonly: If specified only the memory controller is configured.</span>
<a name="l00154"></a>00154 <span class="comment">    --board=board_name:  Force a particular board type to be used.</span>
<a name="l00155"></a>00155 <span class="comment">    --envfile=&lt;environment filename&gt;: Reads the u-boot environment data from</span>
<a name="l00156"></a>00156 <span class="comment">              the specified file, loads it into DRAM for u-boot to use.  The u-boot</span>
<a name="l00157"></a>00157 <span class="comment">              image must be configured to use this environment.  The format of the file</span>
<a name="l00158"></a>00158 <span class="comment">              is one environment variable per line:</span>
<a name="l00159"></a>00159 <span class="comment">              env_var=env_val\n</span>
<a name="l00160"></a>00160 <span class="comment">              each line must be ended with a single &apos;\n&apos;</span>
<a name="l00161"></a>00161 <span class="comment">    --scantwsi: Scan twsi bus and exit.</span>
<a name="l00162"></a>00162 <span class="comment">    --dumpspd: Dump SPD contents when scanning twsi bus.</span>
<a name="l00163"></a>00163 <span class="comment"></span>
<a name="l00164"></a>00164 <span class="comment">    The following options are to support booting the generic ram based u-boot image, and</span>
<a name="l00165"></a>00165 <span class="comment">    are not used for normal operation.</span>
<a name="l00166"></a>00166 <span class="comment">    --ddr0spd=&lt;twsi_addr[,twsi_addr]|filename[,filename]&gt;: SPD addresses or files for DIMMS on interface 0.  Specify multiple times</span>
<a name="l00167"></a>00167 <span class="comment">               if multiple dimms are present.  For 128 bit wide DDR interaces (CN38XX/CN58XX)</span>
<a name="l00168"></a>00168 <span class="comment">               comma separated pairs off addresses must be used.(only required for generic board type.)</span>
<a name="l00169"></a>00169 <span class="comment">    --ddr1spd=&lt;twsi_addr|filename&gt;: SPD addresses or files for DIMMS on DDR interface 1.  Only valid for Chips</span>
<a name="l00170"></a>00170 <span class="comment">               with 2 DDR controllers.  Specify multiple times for multiple DIMMS.(only required for generic board type.)</span>
<a name="l00171"></a>00171 <span class="comment">    --ddr0spd=&lt;twsi addrs&gt;: SPD addresses for DIMMS on interface 0.  Specify multiple times</span>
<a name="l00172"></a>00172 <span class="comment">               if multiple dimms are present.  For 128 bit wide DDR interaces (CN38XX/CN58XX)</span>
<a name="l00173"></a>00173 <span class="comment">               comma separated pairs off addresses must be used. (only required for generic board type.)</span>
<a name="l00174"></a>00174 <span class="comment">    --ddr1spd=&lt;twsi addrs&gt;: SPD addresses for DIMMS on DDR interface 1.  Only valid for Chips</span>
<a name="l00175"></a>00175 <span class="comment">               with 2 DDR controllers, such as CN56XX.  Specify multiple times for multiple DIMMS.</span>
<a name="l00176"></a>00176 <span class="comment"></span>
<a name="l00177"></a>00177 <span class="comment">    --cpu_ref_hz=&lt;NNN&gt;: CPU reference clock in Hz.  (only requried for generic board type.)</span>
<a name="l00178"></a>00178 <span class="comment">    --ddr_ref_hz=&lt;NNN&gt;: DDR reference clock in Hz.  (only requried for generic board type.)</span>
<a name="l00179"></a>00179 <span class="comment">    --ddr_clock_hz=&lt;NNN&gt;: DDR clock in Hz.  (only requried for generic board type.)</span>
<a name="l00180"></a>00180 <span class="comment">    --board_delay=&lt;NNN&gt;: board delay, in picoseconds. (only required for generic board type.)</span>
<a name="l00181"></a>00181 <span class="comment">    --readlevel:  Enable read leveling (auto board delay), CN52XX/CN56XX only.</span>
<a name="l00182"></a>00182 <span class="comment">    The bootloader (optionally) supplied must be built for</span>
<a name="l00183"></a>00183 <span class="comment">     booting from DRAM.  If no bootloader is specified the standard one</span>
<a name="l00184"></a>00184 <span class="comment">     for the detected or supplied board type will be chosen.</span>
<a name="l00185"></a>00185 <span class="comment"></span>
<a name="l00186"></a>00186 <span class="comment">For boards without SPD eeproms, filenames rather than SPD addresses may be specified.  The files</span>
<a name="l00187"></a>00187 <span class="comment">must contain SPD values with 1 hex value per line, and a minimum of 64 values.</span>
<a name="l00188"></a>00188 <span class="comment">@endverbatim</span>
<a name="l00189"></a>00189 <span class="comment">    Usage examples:</span>
<a name="l00190"></a>00190 <span class="comment">@verbatim</span>
<a name="l00191"></a>00191 <span class="comment">    $ sudo oct-remote-boot</span>
<a name="l00192"></a>00192 <span class="comment">    All cores in reset, skipping soft reset.</span>
<a name="l00193"></a>00193 <span class="comment">    Using bootloader image: ..../sdk/target/bin/u-boot-octeon_thunder.bin</span>
<a name="l00194"></a>00194 <span class="comment">    Initialized 2048 MBytes of DRAM</span>
<a name="l00195"></a>00195 <span class="comment">    $</span>
<a name="l00196"></a>00196 <span class="comment">@endverbatim</span>
<a name="l00197"></a>00197 <span class="comment"></span>
<a name="l00198"></a>00198 <span class="comment">@verbatim</span>
<a name="l00199"></a>00199 <span class="comment">    $ sudo oct-remote-boot my-bootloader-image.bin</span>
<a name="l00200"></a>00200 <span class="comment">    Found OCTEON on bus 0 in slot 5. BAR0=0xf8000000, BAR1=0xf0000000</span>
<a name="l00201"></a>00201 <span class="comment">    $</span>
<a name="l00202"></a>00202 <span class="comment">@endverbatim</span>
<a name="l00203"></a>00203 <span class="comment"></span>
<a name="l00204"></a>00204 <span class="comment">@verbatim</span>
<a name="l00205"></a>00205 <span class="comment">    $ sudo oct-remote-boot --scantwsi</span>
<a name="l00206"></a>00206 <span class="comment">    Scanning twsi bus...</span>
<a name="l00207"></a>00207 <span class="comment">    Twsi addr 81 (0x51) responded, DIMM SPD</span>
<a name="l00208"></a>00208 <span class="comment">    Twsi addr 82 (0x52) responded, DIMM SPD</span>
<a name="l00209"></a>00209 <span class="comment">    Twsi addr 83 (0x53) responded</span>
<a name="l00210"></a>00210 <span class="comment">    Twsi addr 104 (0x68) responded</span>
<a name="l00211"></a>00211 <span class="comment">    $</span>
<a name="l00212"></a>00212 <span class="comment">@endverbatim</span>
<a name="l00213"></a>00213 <span class="comment"></span>
<a name="l00214"></a>00214 <span class="comment">@verbatim</span>
<a name="l00215"></a>00215 <span class="comment">    $ sudo oct-remote-boot --ddr0spd=0x51,0x52 --board_delay=5000 --board=generic</span>
<a name="l00216"></a>00216 <span class="comment">    Using user supplied DDR 0 spd address(es): 0x51,0x52</span>
<a name="l00217"></a>00217 <span class="comment">    Using user supplied board delay: 5000</span>
<a name="l00218"></a>00218 <span class="comment">    Using user supplied board name: generic, number: 28</span>
<a name="l00219"></a>00219 <span class="comment">    WARNING: detected board type THUNDER (6) does no match supplied board type GENERIC (28).</span>
<a name="l00220"></a>00220 <span class="comment">    NOTICE: using default 50000000 Hz DDR reference clock.</span>
<a name="l00221"></a>00221 <span class="comment">    NOTICE: using default 50000000 Hz CPU reference clock.</span>
<a name="l00222"></a>00222 <span class="comment">    Using bootloader image: ..../sdk/target/bin/u-boot-octeon_generic_ram.bin</span>
<a name="l00223"></a>00223 <span class="comment">    Initialized 2048 MBytes of DRAM</span>
<a name="l00224"></a>00224 <span class="comment">    $</span>
<a name="l00225"></a>00225 <span class="comment">@endverbatim</span>
<a name="l00226"></a>00226 <span class="comment"></span>
<a name="l00227"></a>00227 <span class="comment"></span>
<a name="l00228"></a>00228 <span class="comment"></span>
<a name="l00229"></a>00229 <span class="comment"></span>
<a name="l00230"></a>00230 <span class="comment">@section octeon_remote_bootcmd 5. Remote Bootloader Commands (oct-remote-bootcmd)</span>
<a name="l00231"></a>00231 <span class="comment"></span>
<a name="l00232"></a>00232 <span class="comment">The bootloader can accept commands remotely.  Note that the command must</span>
<a name="l00233"></a>00233 <span class="comment">be quoted if it contains whitespace.  Also, any u-boot environment</span>
<a name="l00234"></a>00234 <span class="comment">variables that are referenced must be escaped so that the shell does not</span>
<a name="l00235"></a>00235 <span class="comment">expand them.</span>
<a name="l00236"></a>00236 <span class="comment"></span>
<a name="l00237"></a>00237 <span class="comment">For this command to work, stdin must include bootcmd.  This will likely change in</span>
<a name="l00238"></a>00238 <span class="comment">the future to requiring stdin to contain PCI.  By default, both of these are</span>
<a name="l00239"></a>00239 <span class="comment">enabled on boards that support it.</span>
<a name="l00240"></a>00240 <span class="comment"></span>
<a name="l00241"></a>00241 <span class="comment">@verbatim</span>
<a name="l00242"></a>00242 <span class="comment">    $ sudo oct-remote-bootcmd &quot;bootoct \$(fileaddr) coremask=ffff&quot;</span>
<a name="l00243"></a>00243 <span class="comment">    Found OCTEON on bus 0 in slot 5. BAR0=0xf8000000, BAR1=0xf0000000</span>
<a name="l00244"></a>00244 <span class="comment">    $</span>
<a name="l00245"></a>00245 <span class="comment">@endverbatim</span>
<a name="l00246"></a>00246 <span class="comment"></span>
<a name="l00247"></a>00247 <span class="comment"></span>
<a name="l00248"></a>00248 <span class="comment"></span>
<a name="l00249"></a>00249 <span class="comment"></span>
<a name="l00250"></a>00250 <span class="comment">@section octeon_remote_console 6. Remote Console (oct-remote-console)</span>
<a name="l00251"></a>00251 <span class="comment"></span>
<a name="l00252"></a>00252 <span class="comment">The bootloader, simple executive applications, and Linux can direct their</span>
<a name="l00253"></a>00253 <span class="comment">consoles over remote protocols to the oct-remote-console utility.  This</span>
<a name="l00254"></a>00254 <span class="comment">allows interaction with programs running on OCTEON without a serial</span>
<a name="l00255"></a>00255 <span class="comment">connection.  Multiple separate consoles can be used, so for example each</span>
<a name="l00256"></a>00256 <span class="comment">core could have its own console if it is running linux.</span>
<a name="l00257"></a>00257 <span class="comment"></span>
<a name="l00258"></a>00258 <span class="comment">@note Applications that do not link against this simple executive library</span>
<a name="l00259"></a>00259 <span class="comment">cannot use the remote console.</span>
<a name="l00260"></a>00260 <span class="comment">@note U-boot, and many of the CVMX APIs refer to remote consoles support as</span>
<a name="l00261"></a>00261 <span class="comment">&quot;PCI Console&quot;. Historically, PCI was the first protocol supported. Later PCIe</span>
<a name="l00262"></a>00262 <span class="comment">and EJTAG were added.</span>
<a name="l00263"></a>00263 <span class="comment"></span>
<a name="l00264"></a>00264 <span class="comment">Bootloader usage:</span>
<a name="l00265"></a>00265 <span class="comment"></span>
<a name="l00266"></a>00266 <span class="comment">By default on boards that support it, stdin will support the remote console</span>
<a name="l00267"></a>00267 <span class="comment">but stdout and stderr will not.  If a remote console is connected and output</span>
<a name="l00268"></a>00268 <span class="comment">is desired to the console then issue the command:</span>
<a name="l00269"></a>00269 <span class="comment"></span>
<a name="l00270"></a>00270 <span class="comment">@verbatim</span>
<a name="l00271"></a>00271 <span class="comment">$ sudo oct-remote-bootcmd &quot;setenv stdout serial,pci; setenv stderr serial,pci&quot;</span>
<a name="l00272"></a>00272 <span class="comment">@endverbatim</span>
<a name="l00273"></a>00273 <span class="comment"></span>
<a name="l00274"></a>00274 <span class="comment">Adding serial is optional but enables simultaneous output to the serial</span>
<a name="l00275"></a>00275 <span class="comment">console.</span>
<a name="l00276"></a>00276 <span class="comment"></span>
<a name="l00277"></a>00277 <span class="comment">Additionally, the above command may be typed in blind into the remote console</span>
<a name="l00278"></a>00278 <span class="comment">and once entered correctly output should appear.</span>
<a name="l00279"></a>00279 <span class="comment"></span>
<a name="l00280"></a>00280 <span class="comment">The console data structures are initialized by the bootloader at boot time</span>
<a name="l00281"></a>00281 <span class="comment">if configured.  If the bootloader does not initialize the data structures,</span>
<a name="l00282"></a>00282 <span class="comment">console functionality will not be available.  The &apos;pci_console_count&apos; and</span>
<a name="l00283"></a>00283 <span class="comment">&apos;pci_console_size&apos; are used to control the number of consoles and the size</span>
<a name="l00284"></a>00284 <span class="comment">of each console&apos;s buffers.  By default the console structures are not</span>
<a name="l00285"></a>00285 <span class="comment">initialized.  Setting the &apos;pci_console_count&apos; to a non-zero value will</span>
<a name="l00286"></a>00286 <span class="comment">cause the data structures to be initialized.  If this variable is saved in</span>
<a name="l00287"></a>00287 <span class="comment">the environment, then the data structures will be initialized at boot time as well.</span>
<a name="l00288"></a>00288 <span class="comment">The console data structures will be configured, but the remote console will</span>
<a name="l00289"></a>00289 <span class="comment">not be used by the bootloader unless the &apos;pci_console_active&apos; environment</span>
<a name="l00290"></a>00290 <span class="comment">variable is set.  If only the &apos;pci_console_active&apos; variable is set, then</span>
<a name="l00291"></a>00291 <span class="comment">the default of 1 console with 1024 byte buffers will be used.  The</span>
<a name="l00292"></a>00292 <span class="comment">bootloader always uses remote console 0, so the following command (run as</span>
<a name="l00293"></a>00293 <span class="comment">root) will connect to it:</span>
<a name="l00294"></a>00294 <span class="comment"></span>
<a name="l00295"></a>00295 <span class="comment">@verbatim</span>
<a name="l00296"></a>00296 <span class="comment">    $ oct-remote-console 0</span>
<a name="l00297"></a>00297 <span class="comment">    Found OCTEON on bus 3 in slot 2. BAR0=0xe7fff000, BAR1=0xd8000000</span>
<a name="l00298"></a>00298 <span class="comment">    Connecting to PCI console 0</span>
<a name="l00299"></a>00299 <span class="comment">    Using raw terminal mode, escape character is ^A, use ^A D  to exit, ^A A to send ^A</span>
<a name="l00300"></a>00300 <span class="comment">    $</span>
<a name="l00301"></a>00301 <span class="comment">@endverbatim</span>
<a name="l00302"></a>00302 <span class="comment"></span>
<a name="l00303"></a>00303 <span class="comment">Simple Executive usage:</span>
<a name="l00304"></a>00304 <span class="comment"></span>
<a name="l00305"></a>00305 <span class="comment">If the bootloader is configured to use the remote console, the simple</span>
<a name="l00306"></a>00306 <span class="comment">executive applications will also use console 0.</span>
<a name="l00307"></a>00307 <span class="comment"></span>
<a name="l00308"></a>00308 <span class="comment">Linux usage:</span>
<a name="l00309"></a>00309 <span class="comment"></span>
<a name="l00310"></a>00310 <span class="comment">Linux uses a command line argument to select a remote console.  The argument</span>
<a name="l00311"></a>00311 <span class="comment">&apos;console=pciN&apos; should be added to the command line, with N being replaced</span>
<a name="l00312"></a>00312 <span class="comment">with the number of the console to be used.</span>
<a name="l00313"></a>00313 <span class="comment"></span>
<a name="l00314"></a>00314 <span class="comment">oct-remote-console utility usage:</span>
<a name="l00315"></a>00315 <span class="comment">@verbatim</span>
<a name="l00316"></a>00316 <span class="comment">    Usage: oct-remote-console [--noraw] &lt;CONSOLE_NUMBER&gt;</span>
<a name="l00317"></a>00317 <span class="comment">@endverbatim</span>
<a name="l00318"></a>00318 <span class="comment"></span>
<a name="l00319"></a>00319 <span class="comment">The oct-remote-console utility takes the console number to connect to as</span>
<a name="l00320"></a>00320 <span class="comment">an argument.  By default it put the terminal in raw mode so that control</span>
<a name="l00321"></a>00321 <span class="comment">characters are passed through to OCTEON.  The escape character is ^A, and</span>
<a name="l00322"></a>00322 <span class="comment">to exit type ^A D.  The utility can also be invoked with the &apos;--noraw&apos;</span>
<a name="l00323"></a>00323 <span class="comment">mode in which case control characters like ^C and ^Z are not passed</span>
<a name="l00324"></a>00324 <span class="comment">through, but cause signals to be sent to the oct-remote-console utility.</span>
<a name="l00325"></a>00325 <span class="comment">In &apos;noraw&apos; mode, ^C causes the utility to exit.</span>
<a name="l00326"></a>00326 <span class="comment"></span>
<a name="l00327"></a>00327 <span class="comment">@note Because the oct-remote-console utility polls OCTEON, if OCTEON is</span>
<a name="l00328"></a>00328 <span class="comment">reset while the console is connected there is a good chance that the</span>
<a name="l00329"></a>00329 <span class="comment">entire machine will lock up.  (The lockup is due to OCTEON being</span>
<a name="l00330"></a>00330 <span class="comment">non-responsive to the PCI accesses while it is in reset.) The</span>
<a name="l00331"></a>00331 <span class="comment">oct-remote-console utility should be exited before reseting the OCTEON.</span>
<a name="l00332"></a>00332 <span class="comment">The one exception to this is that oct-remote-reset and oct-remote-boot can</span>
<a name="l00333"></a>00333 <span class="comment">be used while the pci console is active since they coordinate with</span>
<a name="l00334"></a>00334 <span class="comment">oct-remote-console to ensure that no accesses happen while the OCTEON is</span>
<a name="l00335"></a>00335 <span class="comment">non-responsive.</span>
<a name="l00336"></a>00336 <span class="comment"></span>
<a name="l00337"></a>00337 <span class="comment"></span>
<a name="l00338"></a>00338 <span class="comment"></span>
<a name="l00339"></a>00339 <span class="comment"></span>
<a name="l00340"></a>00340 <span class="comment">@section octeon_remote_core 7. Read CPU Core State (oct-remote-core)</span>
<a name="l00341"></a>00341 <span class="comment"></span>
<a name="l00342"></a>00342 <span class="comment">The general purpose registers, coprocessor 0 state, and TLB can be read</span>
<a name="l00343"></a>00343 <span class="comment">remotely using oct-remote-core.  A single argument specifies the OCTEON</span>
<a name="l00344"></a>00344 <span class="comment">core number to read.</span>
<a name="l00345"></a>00345 <span class="comment"></span>
<a name="l00346"></a>00346 <span class="comment">@note Some registers are not available through some remote protocols.</span>
<a name="l00347"></a>00347 <span class="comment">These registers will show as 0x0bad0bad0bad0bad.</span>
<a name="l00348"></a>00348 <span class="comment"></span>
<a name="l00349"></a>00349 <span class="comment">@verbatim</span>
<a name="l00350"></a>00350 <span class="comment">Usage: ./oct-remote-core &lt;core&gt;</span>
<a name="l00351"></a>00351 <span class="comment">    Display the state of an OCTEON core.</span>
<a name="l00352"></a>00352 <span class="comment"></span>
<a name="l00353"></a>00353 <span class="comment">    core - OCTEON core to display.</span>
<a name="l00354"></a>00354 <span class="comment">@endverbatim</span>
<a name="l00355"></a>00355 <span class="comment"></span>
<a name="l00356"></a>00356 <span class="comment">Sample output from core 0 in U-boot</span>
<a name="l00357"></a>00357 <span class="comment">@verbatim</span>
<a name="l00358"></a>00358 <span class="comment">Core 0</span>
<a name="l00359"></a>00359 <span class="comment">CPU registers:</span>
<a name="l00360"></a>00360 <span class="comment">   zero (r0)    0x0000000000000000         s0 (r0)      0x0000000000000001</span>
<a name="l00361"></a>00361 <span class="comment">     at (r1)    0x0000000000000000         s1 (r1)      0xffffffff800bfa48</span>
<a name="l00362"></a>00362 <span class="comment">     v0 (r2)    0x0000000000000000         s2 (r2)      0xffffffff800a50a8</span>
<a name="l00363"></a>00363 <span class="comment">     v1 (r3)    0x8001180000000828         s3 (r3)      0x0000000000000010</span>
<a name="l00364"></a>00364 <span class="comment">     a0 (r4)    0x0000000000000001         s4 (r4)      0xffffffff800a0000</span>
<a name="l00365"></a>00365 <span class="comment">     a1 (r5)    0xffffffff800b06e0         s5 (r5)      0xffffffff8005ff24</span>
<a name="l00366"></a>00366 <span class="comment">     a2 (r6)    0x0000000000000000         s6 (r6)      0x0000000000024108</span>
<a name="l00367"></a>00367 <span class="comment">     a3 (r7)    0xffffffff800b06e0         s7 (r7)      0x6f513832dea27065</span>
<a name="l00368"></a>00368 <span class="comment">     a4 (r8)    0x0000000000000000         t8 (r8)      0x0000000000000000</span>
<a name="l00369"></a>00369 <span class="comment">     a5 (r9)    0xffffffffffffffd0         t9 (r9)      0xffffffff8008542c</span>
<a name="l00370"></a>00370 <span class="comment">     a6 (r10)   0x0000000000000002         k0 (r10)     0xffffffff8005ff24</span>
<a name="l00371"></a>00371 <span class="comment">     a7 (r11)   0xffffffff800b05a0         k1 (r11)     0xfffffffffffffffe</span>
<a name="l00372"></a>00372 <span class="comment">     t0 (r12)   0xffffffff800b06e0         gp (r12)     0xffffffff800b06e0</span>
<a name="l00373"></a>00373 <span class="comment">     t1 (r13)   0xffffffff800ad3b0         sp (r13)     0xffffffff8005bd10</span>
<a name="l00374"></a>00374 <span class="comment">     t2 (r14)   0x0000000000000020      s8/fp (r14)     0xa89c196f513832de</span>
<a name="l00375"></a>00375 <span class="comment">     t3 (r15)   0xffffffff800b06e0         ra (r15)     0xffffffff80075584</span>
<a name="l00376"></a>00376 <span class="comment">     lo         0x0000000000000ea6         hi           0x0000000000000000</span>
<a name="l00377"></a>00377 <span class="comment">Coprocessor 0 registers:</span>
<a name="l00378"></a>00378 <span class="comment">  ($ 0,0) Index     0xffffffff80000000  ($18,1) WatchLo1       0x0bad0bad0bad0bad</span>
<a name="l00379"></a>00379 <span class="comment">  ($ 1,0) Random    0x000000000000003f  ($19,0) WatchHi0       0xffffffff80000000</span>
<a name="l00380"></a>00380 <span class="comment">  ($ 2,0) EntryLo0  0x0000000000000000  ($19,1) WatchHi1       0x0bad0bad0bad0bad</span>
<a name="l00381"></a>00381 <span class="comment">  ($ 3,0) EntryLo1  0x0000000000000000  ($20,0) XContext       0x0000000000000000</span>
<a name="l00382"></a>00382 <span class="comment">  ($ 4,0) Context   0x0000000000000000  ($23,0) Debug          0x000000004011fc20</span>
<a name="l00383"></a>00383 <span class="comment">  ($ 5,0) PageMask  0x0000000000000000  ($25,0) PerfControl0   0xffffffffc0000000</span>
<a name="l00384"></a>00384 <span class="comment">  ($ 5,1) PageGrain 0x0000000020000000  ($25,2) PerfControl1   0x0000000040000000</span>
<a name="l00385"></a>00385 <span class="comment">  ($ 6,0) Wired     0x0000000000000000  ($24,0) DEPC           0xffffffff80075560</span>
<a name="l00386"></a>00386 <span class="comment">  ($ 7,0) HWREna    0xffffffffc000000f  ($25,1) PerfCount0     0x0000000000000000</span>
<a name="l00387"></a>00387 <span class="comment">  ($ 8,0) BadVAddr  0x0000000000000000  ($25,3) PerfCount0     0x0000000000000000</span>
<a name="l00388"></a>00388 <span class="comment">  ($ 9,0) Count     0xffffffffee38d00c  ($27,0) IcacheError    0x007f7f0000001850</span>
<a name="l00389"></a>00389 <span class="comment">  ($10,0) EntryHi   0xc001ffff9007e000  ($27,1) DcacheError    0x00000000000019d0</span>
<a name="l00390"></a>00390 <span class="comment">  ($11,0) Compare   0x0000000000000000  ($28,0) IcacheTagLo    0xcff1ffffe1f81281</span>
<a name="l00391"></a>00391 <span class="comment">  ($12,0) Status    0x00000000504000e5  ($28,1) IcacheDataLo   0x5f7c42f1cb820613</span>
<a name="l00392"></a>00392 <span class="comment">  ($12,1) IntCtl    0xfffffffffc000000  ($28,2) DcacheTagLo    0x0000000000000000</span>
<a name="l00393"></a>00393 <span class="comment">  ($12,2) SRSCtl    0x0000000000000000  ($28,3) DcacheDataLo   0x0000000000000060</span>
<a name="l00394"></a>00394 <span class="comment">  ($13,0) Cause     0x0000000040008000  ($29,1) IcacheDataHi   0x0000000000000000</span>
<a name="l00395"></a>00395 <span class="comment">  ($14,0) EPC       0x27178f42b6d265de  ($29,2) DcacheTagHi    0x0000000000000000</span>
<a name="l00396"></a>00396 <span class="comment">  ($15,0) PRId      0x00000000000d0708  ($29,3) DcacheDataHi   0x0000000000000000</span>
<a name="l00397"></a>00397 <span class="comment">  ($15,1) Ebase     0xffffffff80000000  ($30,0) ErrorEPC       0xffffffffff200e3c</span>
<a name="l00398"></a>00398 <span class="comment">  ($16,0) Config    0xffffffff8000c48a  ($31,0) DESAVE         0x0000000000000000</span>
<a name="l00399"></a>00399 <span class="comment">  ($16,1) Config1   0xfffffffffe3303da  ($ 9,7) CvmCtl         0x00000000b00043f0</span>
<a name="l00400"></a>00400 <span class="comment">  ($16,2) Config2   0xffffffff80000367  ($11,7) CvmMemCt       0x0000000000046104</span>
<a name="l00401"></a>00401 <span class="comment">  ($16,3) Config3   0x0000000000001080  ($ 9,6) CvmCount       0x000000015d5c0520</span>
<a name="l00402"></a>00402 <span class="comment">  ($18,0) WatchLo0  0x0000000000000000  ($22,0) MultiCoreDebug 0x0bad0bad0bad0bad</span>
<a name="l00403"></a>00403 <span class="comment">TLB:</span>
<a name="l00404"></a>00404 <span class="comment"> 0: Virtual=0xffffffff9007e000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00405"></a>00405 <span class="comment"> 1: Virtual=0xffffffff9007c000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00406"></a>00406 <span class="comment"> 2: Virtual=0xffffffff9007a000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00407"></a>00407 <span class="comment"> 3: Virtual=0xffffffff90078000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00408"></a>00408 <span class="comment"> 4: Virtual=0xffffffff90076000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00409"></a>00409 <span class="comment"> 5: Virtual=0xffffffff90074000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00410"></a>00410 <span class="comment"> 6: Virtual=0xffffffff90072000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00411"></a>00411 <span class="comment"> 7: Virtual=0xffffffff90070000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00412"></a>00412 <span class="comment"> 8: Virtual=0xffffffff9006e000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00413"></a>00413 <span class="comment"> 9: Virtual=0xffffffff9006c000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00414"></a>00414 <span class="comment">10: Virtual=0xffffffff9006a000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00415"></a>00415 <span class="comment">11: Virtual=0xffffffff90068000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00416"></a>00416 <span class="comment">12: Virtual=0xffffffff90066000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00417"></a>00417 <span class="comment">13: Virtual=0xffffffff90064000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00418"></a>00418 <span class="comment">14: Virtual=0xffffffff90062000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00419"></a>00419 <span class="comment">15: Virtual=0xffffffff90060000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00420"></a>00420 <span class="comment">16: Virtual=0xffffffff9005e000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00421"></a>00421 <span class="comment">17: Virtual=0xffffffff9005c000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00422"></a>00422 <span class="comment">18: Virtual=0xffffffff9005a000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00423"></a>00423 <span class="comment">19: Virtual=0xffffffff90058000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00424"></a>00424 <span class="comment">20: Virtual=0xffffffff90056000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00425"></a>00425 <span class="comment">21: Virtual=0xffffffff90054000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00426"></a>00426 <span class="comment">22: Virtual=0xffffffff90052000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00427"></a>00427 <span class="comment">23: Virtual=0xffffffff90050000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00428"></a>00428 <span class="comment">24: Virtual=0xffffffff9004e000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00429"></a>00429 <span class="comment">25: Virtual=0xffffffff9004c000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00430"></a>00430 <span class="comment">26: Virtual=0xffffffff9004a000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00431"></a>00431 <span class="comment">27: Virtual=0xffffffff90048000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00432"></a>00432 <span class="comment">28: Virtual=0xffffffff90046000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00433"></a>00433 <span class="comment">29: Virtual=0xffffffff90044000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00434"></a>00434 <span class="comment">30: Virtual=0xffffffff90042000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00435"></a>00435 <span class="comment">31: Virtual=0xffffffff90040000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00436"></a>00436 <span class="comment">32: Virtual=0xffffffff9003e000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00437"></a>00437 <span class="comment">33: Virtual=0xffffffff9003c000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00438"></a>00438 <span class="comment">34: Virtual=0xffffffff9003a000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00439"></a>00439 <span class="comment">35: Virtual=0xffffffff90038000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00440"></a>00440 <span class="comment">36: Virtual=0xffffffff90036000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00441"></a>00441 <span class="comment">37: Virtual=0xffffffff90034000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00442"></a>00442 <span class="comment">38: Virtual=0xffffffff90032000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00443"></a>00443 <span class="comment">39: Virtual=0xffffffff90030000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00444"></a>00444 <span class="comment">40: Virtual=0xffffffff9002e000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00445"></a>00445 <span class="comment">41: Virtual=0xffffffff9002c000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00446"></a>00446 <span class="comment">42: Virtual=0xffffffff9002a000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00447"></a>00447 <span class="comment">43: Virtual=0xffffffff90028000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00448"></a>00448 <span class="comment">44: Virtual=0xffffffff90026000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00449"></a>00449 <span class="comment">45: Virtual=0xffffffff90024000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00450"></a>00450 <span class="comment">46: Virtual=0xffffffff90022000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00451"></a>00451 <span class="comment">47: Virtual=0xffffffff90020000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00452"></a>00452 <span class="comment">48: Virtual=0xffffffff9001e000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00453"></a>00453 <span class="comment">49: Virtual=0xffffffff9001c000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00454"></a>00454 <span class="comment">50: Virtual=0xffffffff9001a000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00455"></a>00455 <span class="comment">51: Virtual=0xffffffff90018000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00456"></a>00456 <span class="comment">52: Virtual=0xffffffff90016000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00457"></a>00457 <span class="comment">53: Virtual=0xffffffff90014000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00458"></a>00458 <span class="comment">54: Virtual=0xffffffff90012000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00459"></a>00459 <span class="comment">55: Virtual=0xffffffff90010000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00460"></a>00460 <span class="comment">56: Virtual=0xffffffff9000e000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00461"></a>00461 <span class="comment">57: Virtual=0xffffffff9000c000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00462"></a>00462 <span class="comment">58: Virtual=0xffffffff9000a000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00463"></a>00463 <span class="comment">59: Virtual=0xffffffff90008000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00464"></a>00464 <span class="comment">60: Virtual=0xffffffff90006000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00465"></a>00465 <span class="comment">61: Virtual=0xffffffff90004000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00466"></a>00466 <span class="comment">62: Virtual=0xffffffff90002000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00467"></a>00467 <span class="comment">63: Virtual=0xffffffff90000000 Page0=0x00000000,C=0,D=0,V=0,G=0 Page1=0x00000000,C=0,D=0,V=0,G=0 ASID=  0 Size=4KB</span>
<a name="l00468"></a>00468 <span class="comment">@endverbatim</span>
<a name="l00469"></a>00469 <span class="comment"></span>
<a name="l00470"></a>00470 <span class="comment"></span>
<a name="l00471"></a>00471 <span class="comment">@section octeon_remote_csr 8. CSR Access (oct-remote-csr)</span>
<a name="l00472"></a>00472 <span class="comment"></span>
<a name="l00473"></a>00473 <span class="comment">OCTEON CSRs may be read or written directly from a remote host.  The</span>
<a name="l00474"></a>00474 <span class="comment">utility &lt;b&gt;oct-remote-csr&lt;/b&gt; may be used to access any 64bit CSR</span>
<a name="l00475"></a>00475 <span class="comment">available on OCTEON.</span>
<a name="l00476"></a>00476 <span class="comment"></span>
<a name="l00477"></a>00477 <span class="comment">@verbatim</span>
<a name="l00478"></a>00478 <span class="comment">Usage: ./oct-remote-csr CSR [value] [CSR [value] ...]</span>
<a name="l00479"></a>00479 <span class="comment">    Read or write a CSR by name.</span>
<a name="l00480"></a>00480 <span class="comment"></span>
<a name="l00481"></a>00481 <span class="comment">    CSR     Name of CSR to read or write. Case is ignored.</span>
<a name="l00482"></a>00482 <span class="comment">    value   If present, write this value to the CSR. Otherwise do a read.</span>
<a name="l00483"></a>00483 <span class="comment">            The value can be in decimal of hex (0x...).</span>
<a name="l00484"></a>00484 <span class="comment"></span>
<a name="l00485"></a>00485 <span class="comment">    If CSR is a partial name, the list of CSRs starting with it are displayed.</span>
<a name="l00486"></a>00486 <span class="comment">@endverbatim</span>
<a name="l00487"></a>00487 <span class="comment"></span>
<a name="l00488"></a>00488 <span class="comment">    Here is an example of reading the CIU enable register for Core 0 interrupt</span>
<a name="l00489"></a>00489 <span class="comment">    line 2:</span>
<a name="l00490"></a>00490 <span class="comment"></span>
<a name="l00491"></a>00491 <span class="comment">@verbatim</span>
<a name="l00492"></a>00492 <span class="comment">$ ./oct-remote-csr CIU_INT0_EN0</span>
<a name="l00493"></a>00493 <span class="comment">CIU_INT0_EN0(0x0001070000000200) = 0x4100410300000000</span>
<a name="l00494"></a>00494 <span class="comment">  [   63] BOOTDMA              =          0 (0x0)</span>
<a name="l00495"></a>00495 <span class="comment">  [   62] MII                  =          1 (0x1)</span>
<a name="l00496"></a>00496 <span class="comment">  [   61] IPDPPTHR             =          0 (0x0)</span>
<a name="l00497"></a>00497 <span class="comment">  [   60] POWIQ                =          0 (0x0)</span>
<a name="l00498"></a>00498 <span class="comment">  [   59] TWSI2                =          0 (0x0)</span>
<a name="l00499"></a>00499 <span class="comment">  [58:57] RESERVED_57_58       =          0 (0x0)</span>
<a name="l00500"></a>00500 <span class="comment">  [   56] USB                  =          1 (0x1)</span>
<a name="l00501"></a>00501 <span class="comment">  [55:52] TIMER                =          0 (0x0)</span>
<a name="l00502"></a>00502 <span class="comment">  [   51] RESERVED_51_51       =          0 (0x0)</span>
<a name="l00503"></a>00503 <span class="comment">  [   50] IPD_DRP              =          0 (0x0)</span>
<a name="l00504"></a>00504 <span class="comment">  [   49] RESERVED_49_49       =          0 (0x0)</span>
<a name="l00505"></a>00505 <span class="comment">  [   48] GMX_DRP              =          0 (0x0)</span>
<a name="l00506"></a>00506 <span class="comment">  [   47] TRACE                =          0 (0x0)</span>
<a name="l00507"></a>00507 <span class="comment">  [   46] RML                  =          1 (0x1)</span>
<a name="l00508"></a>00508 <span class="comment">  [   45] TWSI                 =          0 (0x0)</span>
<a name="l00509"></a>00509 <span class="comment">  [   44] RESERVED_44_44       =          0 (0x0)</span>
<a name="l00510"></a>00510 <span class="comment">  [43:40] PCI_MSI              =          1 (0x1)</span>
<a name="l00511"></a>00511 <span class="comment">  [39:36] PCI_INT              =          0 (0x0)</span>
<a name="l00512"></a>00512 <span class="comment">  [35:34] UART                 =          0 (0x0)</span>
<a name="l00513"></a>00513 <span class="comment">  [33:32] MBOX                 =          3 (0x3)</span>
<a name="l00514"></a>00514 <span class="comment">  [31:16] GPIO                 =          0 (0x0)</span>
<a name="l00515"></a>00515 <span class="comment">  [15: 0] WORKQ                =          0 (0x0)</span>
<a name="l00516"></a>00516 <span class="comment">@endverbatim</span>
<a name="l00517"></a>00517 <span class="comment"></span>
<a name="l00518"></a>00518 <span class="comment"></span>
<a name="l00519"></a>00519 <span class="comment"></span>
<a name="l00520"></a>00520 <span class="comment"></span>
<a name="l00521"></a>00521 <span class="comment">@section octeon_remote_ddr 9. Quickly Test Memory (oct-remote-ddr)</span>
<a name="l00522"></a>00522 <span class="comment"></span>
<a name="l00523"></a>00523 <span class="comment">A very simple, and not thorough, memory test can be run remotely using</span>
<a name="l00524"></a>00524 <span class="comment">oct-remote-ddr.  This utility should only be used as a basic alive test.</span>
<a name="l00525"></a>00525 <span class="comment">The DRAM controller on OCTEON must be already configured before this test</span>
<a name="l00526"></a>00526 <span class="comment">can be run.</span>
<a name="l00527"></a>00527 <span class="comment"></span>
<a name="l00528"></a>00528 <span class="comment">@verbatim</span>
<a name="l00529"></a>00529 <span class="comment">$ oct-remote-ddr -h</span>
<a name="l00530"></a>00530 <span class="comment">OCTEON DDR2 memory test over a remote interface</span>
<a name="l00531"></a>00531 <span class="comment">Note: Requires use of oct-*-boot to configure memory controller</span>
<a name="l00532"></a>00532 <span class="comment">Usage:</span>
<a name="l00533"></a>00533 <span class="comment">    ./oct-remote-ddr  &lt;Mbytes to test&gt;</span>
<a name="l00534"></a>00534 <span class="comment">@endverbatim</span>
<a name="l00535"></a>00535 <span class="comment"></span>
<a name="l00536"></a>00536 <span class="comment"></span>
<a name="l00537"></a>00537 <span class="comment"></span>
<a name="l00538"></a>00538 <span class="comment">@section octeon_remote_load 10. Loading Files into Memory (oct-remote-load)</span>
<a name="l00539"></a>00539 <span class="comment"></span>
<a name="l00540"></a>00540 <span class="comment">Any file may be loaded into OCTEON memory using the oct-remote-load</span>
<a name="l00541"></a>00541 <span class="comment">utility.  This utility makes a great alternative to Kermit or the compact</span>
<a name="l00542"></a>00542 <span class="comment">flash for loading programs.  The example below loads the passthrough</span>
<a name="l00543"></a>00543 <span class="comment">example into OCTEON memory.  The address of 0 causes the oct-remote-load</span>
<a name="l00544"></a>00544 <span class="comment">utility to determine the address of memory reserved for loading by the</span>
<a name="l00545"></a>00545 <span class="comment">bootloader and use that address for loading the file.  A fixed (non 0)</span>
<a name="l00546"></a>00546 <span class="comment">address may also be given.</span>
<a name="l00547"></a>00547 <span class="comment"></span>
<a name="l00548"></a>00548 <span class="comment">For this command to work, stdin must include bootcmd.  This will likely change in</span>
<a name="l00549"></a>00549 <span class="comment">the future to requiring stdin to contain PCI.  By default, both of these are</span>
<a name="l00550"></a>00550 <span class="comment">enabled on boards that support it.</span>
<a name="l00551"></a>00551 <span class="comment"></span>
<a name="l00552"></a>00552 <span class="comment">@verbatim</span>
<a name="l00553"></a>00553 <span class="comment">    $ sudo oct-remote-load 0 passthrough</span>
<a name="l00554"></a>00554 <span class="comment">    Found OCTEON on bus 0 in slot 5. BAR0=0xf8000000, BAR1=0xf0000000</span>
<a name="l00555"></a>00555 <span class="comment">    $</span>
<a name="l00556"></a>00556 <span class="comment">@endverbatim</span>
<a name="l00557"></a>00557 <span class="comment"></span>
<a name="l00558"></a>00558 <span class="comment">    At this point you can start passthrough with the bootloader command:</span>
<a name="l00559"></a>00559 <span class="comment"></span>
<a name="l00560"></a>00560 <span class="comment">@verbatim</span>
<a name="l00561"></a>00561 <span class="comment">    $ sudo oct-remote-bootcmd &quot;bootoct 0 numcores=16&quot;</span>
<a name="l00562"></a>00562 <span class="comment">@endverbatim</span>
<a name="l00563"></a>00563 <span class="comment"></span>
<a name="l00564"></a>00564 <span class="comment"></span>
<a name="l00565"></a>00565 <span class="comment"></span>
<a name="l00566"></a>00566 <span class="comment"></span>
<a name="l00567"></a>00567 <span class="comment">@section octeon_remote_memory 11. Read / Write a 64 bit Memory Location (oct-remote-memory)</span>
<a name="l00568"></a>00568 <span class="comment"></span>
<a name="l00569"></a>00569 <span class="comment">Read or write a single 64bit value from OCTEON&apos;s memory.</span>
<a name="l00570"></a>00570 <span class="comment"></span>
<a name="l00571"></a>00571 <span class="comment">@verbatim</span>
<a name="l00572"></a>00572 <span class="comment">$ ./oct-remote-memory</span>
<a name="l00573"></a>00573 <span class="comment">Usage: ./oct-remote-memory address [value]</span>
<a name="l00574"></a>00574 <span class="comment">    Read or write 8 bytes at a  memory address.</span>
<a name="l00575"></a>00575 <span class="comment"></span>
<a name="l00576"></a>00576 <span class="comment">    address Address of memory to read or write.</span>
<a name="l00577"></a>00577 <span class="comment">    value   If present, write this value to the address. Otherwise do a read.</span>
<a name="l00578"></a>00578 <span class="comment">@endverbatim</span>
<a name="l00579"></a>00579 <span class="comment"></span>
<a name="l00580"></a>00580 <span class="comment"></span>
<a name="l00581"></a>00581 <span class="comment"></span>
<a name="l00582"></a>00582 <span class="comment"></span>
<a name="l00583"></a>00583 <span class="comment">@section octeon_remote_pow 12. Displaying OCTEON POW state (oct-remote-pow)</span>
<a name="l00584"></a>00584 <span class="comment"></span>
<a name="l00585"></a>00585 <span class="comment">The state of the OCTEON POW can be captured and displayed through the</span>
<a name="l00586"></a>00586 <span class="comment"></span>
<a name="l00587"></a>00587 <span class="comment">remote interface.  &lt;b&gt;oct-remote-pow&lt;/b&gt; captures the state of all the</span>
<a name="l00588"></a>00588 <span class="comment">input queues, de-schedue lists, no-schedule lists, the external memory</span>
<a name="l00589"></a>00589 <span class="comment">queue pointers, and the complete state of each core.  Without any</span>
<a name="l00590"></a>00590 <span class="comment">arguments &lt;b&gt;oct-remote-pow&lt;/b&gt; attempts to capture the state without</span>
<a name="l00591"></a>00591 <span class="comment">disturbing the running system.  This can cause the resulting capture state</span>
<a name="l00592"></a>00592 <span class="comment">to be inconsistent due to changes while the capture was running.  The</span>
<a name="l00593"></a>00593 <span class="comment">&lt;b&gt;-s,--stop-cores&lt;/b&gt; option tells the utility to temporarily stop the</span>
<a name="l00594"></a>00594 <span class="comment">cores during the capture.  By placing the OCTEON cores into debug mode the</span>
<a name="l00595"></a>00595 <span class="comment">captured state is normally consistent for the time required to make the</span>
<a name="l00596"></a>00596 <span class="comment">capture.  Here is a list of the important items shown in the state</span>
<a name="l00597"></a>00597 <span class="comment">capture:</span>
<a name="l00598"></a>00598 <span class="comment"></span>
<a name="l00599"></a>00599 <span class="comment">    - The POW internal freelist head and tail pointers</span>
<a name="l00600"></a>00600 <span class="comment">    - The tag state of each core including any pending tag switches and work</span>
<a name="l00601"></a>00601 <span class="comment">    requests. Each core also has the previous and next pointer for tags in</span>
<a name="l00602"></a>00602 <span class="comment">    ordered and atomic lists.</span>
<a name="l00603"></a>00603 <span class="comment">    - The queue head and tail pointers for each group&apos;s no-schedule list.</span>
<a name="l00604"></a>00604 <span class="comment">    - The queue head and tail pointers for each group&apos;s de-schedule list.</span>
<a name="l00605"></a>00605 <span class="comment">    - The queue head and tail pointers for each of the 8 input queues.</span>
<a name="l00606"></a>00606 <span class="comment">    - The queue head and tail pointers for each of the 8 input queue memory</span>
<a name="l00607"></a>00607 <span class="comment">    lists. Each input queue has two memory lists (a/b).</span>
<a name="l00608"></a>00608 <span class="comment">    - The current tag type, tag, group, work queue pointer, and next link</span>
<a name="l00609"></a>00609 <span class="comment">    pointer for every internal POW entry. Also each entry is marked with</span>
<a name="l00610"></a>00610 <span class="comment">    the queue it is currently in. Entries on the no-schedule and</span>
<a name="l00611"></a>00611 <span class="comment">    de-schedule lists also contain pending tag switch information.</span>
<a name="l00612"></a>00612 <span class="comment"></span>
<a name="l00613"></a>00613 <span class="comment"></span>
<a name="l00614"></a>00614 <span class="comment"></span>
<a name="l00615"></a>00615 <span class="comment">@section octeon_remote_reset 14. Resetting OCTEON (oct-remote-reset)</span>
<a name="l00616"></a>00616 <span class="comment"></span>
<a name="l00617"></a>00617 <span class="comment">A soft reset of OCTEON can be performed remotely using the @b</span>
<a name="l00618"></a>00618 <span class="comment">oct-remote-reset utility.  Here is an example:</span>
<a name="l00619"></a>00619 <span class="comment"></span>
<a name="l00620"></a>00620 <span class="comment">@verbatim</span>
<a name="l00621"></a>00621 <span class="comment">    $ sudo oct-remote-reset</span>
<a name="l00622"></a>00622 <span class="comment">    Found Octeon on bus 0 in slot 5. BAR0=0xf8000000, BAR1=0xf0000000</span>
<a name="l00623"></a>00623 <span class="comment">    $</span>
<a name="l00624"></a>00624 <span class="comment">@endverbatim</span>
<a name="l00625"></a>00625 <span class="comment"></span>
<a name="l00626"></a>00626 <span class="comment"></span>
<a name="l00627"></a>00627 <span class="comment"></span>
<a name="l00628"></a>00628 <span class="comment"></span>
<a name="l00629"></a>00629 <span class="comment">@section octeon_remote_save 15. Saving Memory to a file (oct-remote-save)</span>
<a name="l00630"></a>00630 <span class="comment"></span>
<a name="l00631"></a>00631 <span class="comment">A contiguous region of DDR may be saved to a file using the</span>
<a name="l00632"></a>00632 <span class="comment">oct-remote-save utility.  The example below saves the low 8 Mbytes of DDR</span>
<a name="l00633"></a>00633 <span class="comment">to a file.</span>
<a name="l00634"></a>00634 <span class="comment"></span>
<a name="l00635"></a>00635 <span class="comment">@verbatim</span>
<a name="l00636"></a>00636 <span class="comment">    $ sudo oct-remote-save 0x0 0x800000 low-mem.bin</span>
<a name="l00637"></a>00637 <span class="comment">    Found Octeon on bus 0 in slot 5. BAR0=0xf8000000, BAR1=0xf0000000</span>
<a name="l00638"></a>00638 <span class="comment">    $</span>
<a name="l00639"></a>00639 <span class="comment">@endverbatim</span>
<a name="l00640"></a>00640 <span class="comment"></span>
<a name="l00641"></a>00641 <span class="comment"></span>
<a name="l00642"></a>00642 <span class="comment"></span>
<a name="l00643"></a>00643 <span class="comment"></span>
<a name="l00644"></a>00644 <span class="comment">@section octeon_remote_tra 16. Tracing using the OCTEON Trace Buffer (oct-remote-tra)</span>
<a name="l00645"></a>00645 <span class="comment"></span>
<a name="l00646"></a>00646 <span class="comment">L2 transactions and CSR accesses can be traced using oct-remote-tra.</span>
<a name="l00647"></a>00647 <span class="comment"></span>
<a name="l00648"></a>00648 <span class="comment">@verbatim</span>
<a name="l00649"></a>00649 <span class="comment">$ ./oct-remote-tra -H</span>
<a name="l00650"></a>00650 <span class="comment"></span>
<a name="l00651"></a>00651 <span class="comment">Cavium OCTEON TRA Analyzer</span>
<a name="l00652"></a>00652 <span class="comment"></span>
<a name="l00653"></a>00653 <span class="comment">Usage:</span>
<a name="l00654"></a>00654 <span class="comment">    ./oct-remote-tra [options]</span>
<a name="l00655"></a>00655 <span class="comment"></span>
<a name="l00656"></a>00656 <span class="comment">Supported Options:</span>
<a name="l00657"></a>00657 <span class="comment">    -h --help</span>
<a name="l00658"></a>00658 <span class="comment">    -H --long-help</span>
<a name="l00659"></a>00659 <span class="comment">    -f --filter=&lt;match&gt;</span>
<a name="l00660"></a>00660 <span class="comment">        Set the filter for the events to record. The default</span>
<a name="l00661"></a>00661 <span class="comment">        records nothing.</span>
<a name="l00662"></a>00662 <span class="comment">    -w --wrap</span>
<a name="l00663"></a>00663 <span class="comment">        Overwrite old samples when buffer overflows. When</span>
<a name="l00664"></a>00664 <span class="comment">        samples are written faster than we can read them, the</span>
<a name="l00665"></a>00665 <span class="comment">        new samples will overwrite old samples.</span>
<a name="l00666"></a>00666 <span class="comment">    -m --trig-mode=[none|start|stop|both]</span>
<a name="l00667"></a>00667 <span class="comment">        Set the mode of how triggers are used.</span>
<a name="l00668"></a>00668 <span class="comment">        none = Triggers are ignored. This is the default.</span>
<a name="l00669"></a>00669 <span class="comment">        start = Both triggers signal when TRA should start.</span>
<a name="l00670"></a>00670 <span class="comment">        stop = Both triggers signal when TRA should stop.</span>
<a name="l00671"></a>00671 <span class="comment">        both = Trigger 1 starts tracing, trigger 2 stops it.</span>
<a name="l00672"></a>00672 <span class="comment">    -0 --trig0=&lt;match&gt;</span>
<a name="l00673"></a>00673 <span class="comment">    -1 --trig1=&lt;match&gt;</span>
<a name="l00674"></a>00674 <span class="comment">    -d --mcd0</span>
<a name="l00675"></a>00675 <span class="comment">        Pulse MCD0 to stop cores when the TRA is full. This</span>
<a name="l00676"></a>00676 <span class="comment">        gives this program a change to catch up. Once the TRA</span>
<a name="l00677"></a>00677 <span class="comment">        buffer is emptied, the cores will be restarted.</span>
<a name="l00678"></a>00678 <span class="comment">    -o --output=name</span>
<a name="l00679"></a>00679 <span class="comment">        Write TRA output to binary file &quot;name&quot;. This file can</span>
<a name="l00680"></a>00680 <span class="comment">        be read later using the &quot;-i&quot; option.</span>
<a name="l00681"></a>00681 <span class="comment">    -i --input=name</span>
<a name="l00682"></a>00682 <span class="comment">        Read from binary file &quot;name&quot; instead of the hardware.</span>
<a name="l00683"></a>00683 <span class="comment">        This should be used to read a file created with the &quot;-o&quot;</span>
<a name="l00684"></a>00684 <span class="comment">        option.</span>
<a name="l00685"></a>00685 <span class="comment">    -t --tra=&lt;No. of Trace Control Unit&gt;</span>
<a name="l00686"></a>00686 <span class="comment">        Enter the TRA no. to display the output from a specific</span>
<a name="l00687"></a>00687 <span class="comment">        TRA buffer.</span>
<a name="l00688"></a>00688 <span class="comment"></span>
<a name="l00689"></a>00689 <span class="comment">&lt;match&gt;=&lt;commands&gt;,&lt;sources&gt;,&lt;destinations&gt;,&lt;address&gt;,&lt;mask&gt;</span>
<a name="l00690"></a>00690 <span class="comment">&lt;commands&gt; is a list of the following separated by &apos;+&apos;:</span>
<a name="l00691"></a>00691 <span class="comment">    dwb, pl2, psl1, ldd, ldi, ldt, stc, stf, stp, stt, iobld8,</span>
<a name="l00692"></a>00692 <span class="comment">    iobld16, iobld32, iobld64, iobst, iobdma, or all</span>
<a name="l00693"></a>00693 <span class="comment">&lt;sources&gt; is a list of the following separated by &apos;+&apos;:</span>
<a name="l00694"></a>00694 <span class="comment">    dwb, iobreq, pko, pki, pp0-pp15, or all</span>
<a name="l00695"></a>00695 <span class="comment">&lt;destinations&gt; is a list of the following separated by &apos;+&apos;:</span>
<a name="l00696"></a>00696 <span class="comment">    pow, rng, zip, dfa, fpa, key, pci, mio, or all</span>
<a name="l00697"></a>00697 <span class="comment">&lt;address&gt; is a physical address to match</span>
<a name="l00698"></a>00698 <span class="comment">&lt;mask&gt; Each bits set is a bit that is checked in &lt;address&gt;</span>
<a name="l00699"></a>00699 <span class="comment"></span>
<a name="l00700"></a>00700 <span class="comment">Brief description of the &lt;commands&gt;:</span>
<a name="l00701"></a>00701 <span class="comment">    dwb     - Don&apos;t-Write-Back: Clear the dirty bit in the L2</span>
<a name="l00702"></a>00702 <span class="comment">              tags if the cache block is present in the L2</span>
<a name="l00703"></a>00703 <span class="comment">              cache. This is an ADD-only transaction on the CMB.</span>
<a name="l00704"></a>00704 <span class="comment">    pl2     - Prefetch Into L2: The cache block will be put</span>
<a name="l00705"></a>00705 <span class="comment">              into the L2 cache. This is an ADD-only</span>
<a name="l00706"></a>00706 <span class="comment">              transaction on the CMB. These transactions are</span>
<a name="l00707"></a>00707 <span class="comment">              only issued by cores.</span>
<a name="l00708"></a>00708 <span class="comment">    psl1    - Data Cache Fill-Through: The cache block is filled</span>
<a name="l00709"></a>00709 <span class="comment">              from L2/DRAM. The block will be filled into the</span>
<a name="l00710"></a>00710 <span class="comment">              dcache of the requesting core. A subsequent store</span>
<a name="l00711"></a>00711 <span class="comment">              from another core or IOB will cause an invalidate.</span>
<a name="l00712"></a>00712 <span class="comment">              The block will not be put into the L2 cache. These</span>
<a name="l00713"></a>00713 <span class="comment">              transactions can only be issued by cores.</span>
<a name="l00714"></a>00714 <span class="comment">    ldd     - Data Cache Fill: The cache block is filled from</span>
<a name="l00715"></a>00715 <span class="comment">              L2/DRAM. The block will be filled into the dcache</span>
<a name="l00716"></a>00716 <span class="comment">              of the requesting core. A subsequent store from</span>
<a name="l00717"></a>00717 <span class="comment">              another core or IOB will cause an invalidate. The</span>
<a name="l00718"></a>00718 <span class="comment">              block is put into the L2 cache. These transactions</span>
<a name="l00719"></a>00719 <span class="comment">              can only be issued by cores.</span>
<a name="l00720"></a>00720 <span class="comment">    ldi     - Instruction Cache / IO Fill: The cache block is</span>
<a name="l00721"></a>00721 <span class="comment">              filled from L2/DRAM. The block is put into the L2</span>
<a name="l00722"></a>00722 <span class="comment">              cache. These transactions can be issued either by</span>
<a name="l00723"></a>00723 <span class="comment">              cores or by the IOB. A subsequent store from</span>
<a name="l00724"></a>00724 <span class="comment">              another core or IOB will NOT cause an invalidate.</span>
<a name="l00725"></a>00725 <span class="comment">    ldt     - Instruction Cache / IO Fill-Through: The cache</span>
<a name="l00726"></a>00726 <span class="comment">              block is filled from L2/DRAM. The block will not</span>
<a name="l00727"></a>00727 <span class="comment">              be put into the L2 cache. These transactions can</span>
<a name="l00728"></a>00728 <span class="comment">              be issued either by cores or by the IOB.</span>
<a name="l00729"></a>00729 <span class="comment">    stc     - Store-Conditional: Store to either 32 or 64-bits</span>
<a name="l00730"></a>00730 <span class="comment">              if the block is currently held in the data cache</span>
<a name="l00731"></a>00731 <span class="comment">              of the requesting core. If the block is in the</span>
<a name="l00732"></a>00732 <span class="comment">              data cache of the requesting core, the store</span>
<a name="l00733"></a>00733 <span class="comment">              happens and a commit indication is returned. All</span>
<a name="l00734"></a>00734 <span class="comment">              data cache copies of the block will be invalidated</span>
<a name="l00735"></a>00735 <span class="comment">              in the other cores. If the block is not in the</span>
<a name="l00736"></a>00736 <span class="comment">              data cache of the requesting core, a failure</span>
<a name="l00737"></a>00737 <span class="comment">              indication is returned, no invalidate occurs,</span>
<a name="l00738"></a>00738 <span class="comment">              neither does the store. The cache block will be</span>
<a name="l00739"></a>00739 <span class="comment">              put into the L2 cache. These transactions are</span>
<a name="l00740"></a>00740 <span class="comment">              only issued by cores.</span>
<a name="l00741"></a>00741 <span class="comment">    stf     - Store-Full: Store to all bytes in the cache block.</span>
<a name="l00742"></a>00742 <span class="comment">              The value of the bytes in the cache block that are</span>
<a name="l00743"></a>00743 <span class="comment">              not transferred on the STORE bus or are masked off</span>
<a name="l00744"></a>00744 <span class="comment">              will be written to zero. All data cache copies of</span>
<a name="l00745"></a>00745 <span class="comment">              the block will be invalidated, except for the data</span>
<a name="l00746"></a>00746 <span class="comment">              cache of an initiating core. The cache block will</span>
<a name="l00747"></a>00747 <span class="comment">              be put into the L2 cache. These transactions are</span>
<a name="l00748"></a>00748 <span class="comment">              issued either by cores or by the IOB.</span>
<a name="l00749"></a>00749 <span class="comment">    stp     - Store-Partial: Some of the bytes in the cache</span>
<a name="l00750"></a>00750 <span class="comment">              block will be stored. The value of the bytes in</span>
<a name="l00751"></a>00751 <span class="comment">              the cache block that are not transferred on the</span>
<a name="l00752"></a>00752 <span class="comment">              STORE bus or are masked off are not modified. All</span>
<a name="l00753"></a>00753 <span class="comment">              data cache copies of the block will be invalidated,</span>
<a name="l00754"></a>00754 <span class="comment">              except for the data cache of an initiating core.</span>
<a name="l00755"></a>00755 <span class="comment">              The cache block will be put into the L2 cache.</span>
<a name="l00756"></a>00756 <span class="comment">              These transactions are issued either by cores or</span>
<a name="l00757"></a>00757 <span class="comment">              by the IOB.</span>
<a name="l00758"></a>00758 <span class="comment">    stt     - Store-Through: Store to all bytes in the cache</span>
<a name="l00759"></a>00759 <span class="comment">              block. The value of the bytes in the cache block</span>
<a name="l00760"></a>00760 <span class="comment">              that are not transferred on the STORE bus or are</span>
<a name="l00761"></a>00761 <span class="comment">              masked off will be written to zero. All data cache</span>
<a name="l00762"></a>00762 <span class="comment">              copies of the block will be invalidated, except</span>
<a name="l00763"></a>00763 <span class="comment">              for the data cache of an initiating core. The</span>
<a name="l00764"></a>00764 <span class="comment">              cache block will not be put into the L2 cache.</span>
<a name="l00765"></a>00765 <span class="comment">              These transactions are only issued by the IOB.</span>
<a name="l00766"></a>00766 <span class="comment">    iobld8  - Load Reflection 8bit: An ADD cycle will be</span>
<a name="l00767"></a>00767 <span class="comment">              reflected onto the FILL bus. This is used for</span>
<a name="l00768"></a>00768 <span class="comment">              communication from the cores to the IOB. A load</span>
<a name="l00769"></a>00769 <span class="comment">              reflection transaction is generated by the cores</span>
<a name="l00770"></a>00770 <span class="comment">              to transfer a load to IOB.</span>
<a name="l00771"></a>00771 <span class="comment">    iobld16 - Load Reflection 16bit.</span>
<a name="l00772"></a>00772 <span class="comment">    iobld32 - Load Reflection 32bit.</span>
<a name="l00773"></a>00773 <span class="comment">    iobld64 - Load Reflection 64bit.</span>
<a name="l00774"></a>00774 <span class="comment">    iobst   - Store Reflection: Reflect an ADD cycle and</span>
<a name="l00775"></a>00775 <span class="comment">              corresponding STORE cycle(s) onto the FILL bus.</span>
<a name="l00776"></a>00776 <span class="comment">              This is used for core IOB communication. A store</span>
<a name="l00777"></a>00777 <span class="comment">              reflection transaction is generated by the cores</span>
<a name="l00778"></a>00778 <span class="comment">              to transfer a store/IOBDMA to IOB. An IOBDMA must</span>
<a name="l00779"></a>00779 <span class="comment">              have exactly 64 bits of (aligned) STORE data. A</span>
<a name="l00780"></a>00780 <span class="comment">              store may have 64, 32, 16, or 8 bits of aligned</span>
<a name="l00781"></a>00781 <span class="comment">              STORE data. These transactions are destined to</span>
<a name="l00782"></a>00782 <span class="comment">              IOB.</span>
<a name="l00783"></a>00783 <span class="comment">    iobdma  - A store reflection transaction is generated</span>
<a name="l00784"></a>00784 <span class="comment">              by the IOB to respond to a prior load/IOBDMA</span>
<a name="l00785"></a>00785 <span class="comment">              request from a core. A load response always</span>
<a name="l00786"></a>00786 <span class="comment">              contains exactly 64 bits of (aligned) STORE</span>
<a name="l00787"></a>00787 <span class="comment">              data. An individual IOBDMA response contains</span>
<a name="l00788"></a>00788 <span class="comment">              between one and sixteen 64 bit (aligned) words</span>
<a name="l00789"></a>00789 <span class="comment">              of data. These transactions are destined to a core.</span>
<a name="l00790"></a>00790 <span class="comment">    all     - All of the above commands added together.</span>
<a name="l00791"></a>00791 <span class="comment">Brief description of the &lt;sources&gt;:</span>
<a name="l00792"></a>00792 <span class="comment">    dwb     - Indicates a DWB from the DWB engine in IOB.</span>
<a name="l00793"></a>00793 <span class="comment">    iobreq  - Indicates a FPA, TIM, DFA, PCI, ZIP, or POW</span>
<a name="l00794"></a>00794 <span class="comment">              read/write, or a PKO write.</span>
<a name="l00795"></a>00795 <span class="comment">    pko     - Indicates a PKO read.</span>
<a name="l00796"></a>00796 <span class="comment">    pki     - Indicates a PIP/IPD write.</span>
<a name="l00797"></a>00797 <span class="comment">    pp0-pp15- Indicates a particular core.</span>
<a name="l00798"></a>00798 <span class="comment">    all     - All of the sources added together.</span>
<a name="l00799"></a>00799 <span class="comment">Brief description of the &lt;destinations&gt;:</span>
<a name="l00800"></a>00800 <span class="comment">    pow     - Indicates a destination of POW (get work, add</span>
<a name="l00801"></a>00801 <span class="comment">              work, status/memory/index loads, NULLRd loads,</span>
<a name="l00802"></a>00802 <span class="comment">              CSRs).</span>
<a name="l00803"></a>00803 <span class="comment">    rng     - Indicates a destination of RNG (loads/IOBDMAs).</span>
<a name="l00804"></a>00804 <span class="comment">    zip     - Indicates a destination of ZIP (doorbells).</span>
<a name="l00805"></a>00805 <span class="comment">    dfa     - Indicates a destination of DFA (CSR&apos;s, doorbells,</span>
<a name="l00806"></a>00806 <span class="comment">              and other operations).</span>
<a name="l00807"></a>00807 <span class="comment">    fpa     - Indicates a destination of FPA (free pool</span>
<a name="l00808"></a>00808 <span class="comment">              allocates / frees).</span>
<a name="l00809"></a>00809 <span class="comment">    key     - Indicates a destination of KEY (reads/writes).</span>
<a name="l00810"></a>00810 <span class="comment">    pci     - Indicates a destination of PCI (access to RSL-type</span>
<a name="l00811"></a>00811 <span class="comment">              CSRs from many CN38XX blocks, PCI bus operations,</span>
<a name="l00812"></a>00812 <span class="comment">              and PCI CSRs).</span>
<a name="l00813"></a>00813 <span class="comment">    mio     - Indicates a destination of CIU or GPIO (for CSRs).</span>
<a name="l00814"></a>00814 <span class="comment">    all     - Matches all destinations.</span>
<a name="l00815"></a>00815 <span class="comment">Examples:</span>
<a name="l00816"></a>00816 <span class="comment">    ./oct-remote-tra -f &quot;ldi,all&quot;</span>
<a name="l00817"></a>00817 <span class="comment">        Trace all Icache loads.</span>
<a name="l00818"></a>00818 <span class="comment">    ./oct-remote-tra -f &quot;stc+stf+stp+stt,pp5+pp4,all&quot;</span>
<a name="l00819"></a>00819 <span class="comment">        Trace all stores from Core 4 and 5.</span>
<a name="l00820"></a>00820 <span class="comment">    ./oct-remote-tra -f &quot;stc+stf+stp+stt,all,all,0,0xffffffffffff0000&quot;</span>
<a name="l00821"></a>00821 <span class="comment">        Trace all stores to the first 64KB of memory (exception vectors).</span>
<a name="l00822"></a>00822 <span class="comment">    ./oct-remote-tra -t 1,3 -f &quot;ldi,all&quot;</span>
<a name="l00823"></a>00823 <span class="comment">    Trace all Icache loads from cores traced by TRA units 1 and 3</span>
<a name="l00824"></a>00824 <span class="comment">@endverbatim</span>
<a name="l00825"></a>00825 <span class="comment"></span>
<a name="l00826"></a>00826 <span class="comment"></span>
<a name="l00827"></a>00827 <span class="comment"></span>
<a name="l00828"></a>00828 <span class="comment"></span>
<a name="l00829"></a>00829 <span class="comment">@section pci_target_gdb 17. Debugging using GDB</span>
<a name="l00830"></a>00830 <span class="comment"></span>
<a name="l00831"></a>00831 <span class="comment">    For debugging an application over PCI, use the Simple Executive</span>
<a name="l00832"></a>00832 <span class="comment">    Debugger.  This uses the oct-debug-agent to connect to the OCTEON</span>
<a name="l00833"></a>00833 <span class="comment">    board over PCI.  This program is located in the host/debug-agent directory</span>
<a name="l00834"></a>00834 <span class="comment">    and depends on the host/remote-lib library like all other remote-utils applications.</span>
<a name="l00835"></a>00835 <span class="comment">    Once the application is built invoke the Simple Executive debugger as mentioned below:</span>
<a name="l00836"></a>00836 <span class="comment"></span>
<a name="l00837"></a>00837 <span class="comment">@verbatim</span>
<a name="l00838"></a>00838 <span class="comment">    $ mipsisa64-octeon-elf-gdb -q passthrough</span>
<a name="l00839"></a>00839 <span class="comment">    (Core#0-gdb) target octeonpci bootoct $(fileaddr) coremask=ffff</span>
<a name="l00840"></a>00840 <span class="comment">    Sending bootloader command:  bootoct $(fileaddr) coremask=ffff debug</span>
<a name="l00841"></a>00841 <span class="comment"></span>
<a name="l00842"></a>00842 <span class="comment">    Listening on port: 44625</span>
<a name="l00843"></a>00843 <span class="comment">    Connected to peer: 127.0.0.1</span>
<a name="l00844"></a>00844 <span class="comment">    Remote target octeon connected to tcp::44625</span>
<a name="l00845"></a>00845 <span class="comment">    (Core#0-gdb)</span>
<a name="l00846"></a>00846 <span class="comment">@endverbatim</span>
<a name="l00847"></a>00847 <span class="comment"></span>
<a name="l00848"></a>00848 <span class="comment">    The boot command should be passed as an argument to the target octeonpci command.</span>
<a name="l00849"></a>00849 <span class="comment">    Note that @b debug option is automatically added to the boot command by GDB.  This</span>
<a name="l00850"></a>00850 <span class="comment">    will make the program enter into the debug exception handler.</span>
<a name="l00851"></a>00851 <span class="comment"></span>
<a name="l00852"></a>00852 <span class="comment">    After the target command you can insert breakpoints and continue debugging.</span>
<a name="l00853"></a>00853 <span class="comment"></span>
<a name="l00854"></a>00854 <span class="comment">@verbatim</span>
<a name="l00855"></a>00855 <span class="comment">    (Core#0-gdb) b main</span>
<a name="l00856"></a>00856 <span class="comment">    Breakpoint 1 at 0x10000290: file passthrough.c, line 379.</span>
<a name="l00857"></a>00857 <span class="comment">    (Core#0-gdb) set step-all on</span>
<a name="l00858"></a>00858 <span class="comment">    (Core#0-gdb) set active-cores</span>
<a name="l00859"></a>00859 <span class="comment">    (Core#0-gdb) c</span>
<a name="l00860"></a>00860 <span class="comment">    Continuing.</span>
<a name="l00861"></a>00861 <span class="comment"></span>
<a name="l00862"></a>00862 <span class="comment">    Breakpoint 1, main () at passthrough.c:379</span>
<a name="l00863"></a>00863 <span class="comment">    379         cvmx_user_app_init();</span>
<a name="l00864"></a>00864 <span class="comment">    (Core#0-gdb)</span>
<a name="l00865"></a>00865 <span class="comment">@endverbatim</span>
<a name="l00866"></a>00866 <span class="comment"></span>
<a name="l00867"></a>00867 <span class="comment">    @note Please refer to Simple Executive Debugger for the meaning of</span>
<a name="l00868"></a>00868 <span class="comment">    &quot;set step-all on&quot; and &quot;set active-cores&quot; commands.</span>
<a name="l00869"></a>00869 <span class="comment"></span>
<a name="l00870"></a>00870 <span class="comment">    These are the additional Cavium specific GDB commands that are supported</span>
<a name="l00871"></a>00871 <span class="comment">    only while debugging over PCI.</span>
<a name="l00872"></a>00872 <span class="comment"></span>
<a name="l00873"></a>00873 <span class="comment">- show core-state: Displays the state of the core by dumping all the general</span>
<a name="l00874"></a>00874 <span class="comment">    purpose registers, COP0 registers and 32 TLB entries.</span>
<a name="l00875"></a>00875 <span class="comment"></span>
<a name="l00876"></a>00876 <span class="comment">- set/show pci-bootcmd: A shell command for booting over PCI. The default value is set</span>
<a name="l00877"></a>00877 <span class="comment">    is &quot;oct-remote-reset&quot;. The &quot;target octeonpci&quot; command basically resets the board before</span>
<a name="l00878"></a>00878 <span class="comment">    loading the program. For the boards that don&apos;t have boot flash,</span>
<a name="l00879"></a>00879 <span class="comment">    one needs to load the bootloader after reset. Pass the bootloader needed</span>
<a name="l00880"></a>00880 <span class="comment">    for PCI boot through &quot;pci-bootcmd&quot; before invoking &quot;target octeonpci&quot; command.</span>
<a name="l00881"></a>00881 <span class="comment"></span>
<a name="l00882"></a>00882 <span class="comment">    Here is an example on how to set pci-bootcmd.</span>
<a name="l00883"></a>00883 <span class="comment"></span>
<a name="l00884"></a>00884 <span class="comment">@verbatim</span>
<a name="l00885"></a>00885 <span class="comment">    $ mipsisa64-octeon-elf-gdb -q passthrough</span>
<a name="l00886"></a>00886 <span class="comment">    (Core#0-gdb) set pci-bootcmd oct-remote-boot</span>
<a name="l00887"></a>00887 <span class="comment">    (Core#0-gdb) target octeonpci bootoct $(fileaddr) coremask=ffff</span>
<a name="l00888"></a>00888 <span class="comment">    Found Octeon on bus 3 in slot 2. BAR0=0xe7fff000, BAR1=0xd8000000</span>
<a name="l00889"></a>00889 <span class="comment">    Using bootloader image: /home/creese/work/octsw/sdk/target/bin/u-boot-pciboot-ebt3000.bin</span>
<a name="l00890"></a>00890 <span class="comment">    Found Octeon on bus 3 in slot 2. BAR0=0xe7fff000, BAR1=0xd8000000</span>
<a name="l00891"></a>00891 <span class="comment"></span>
<a name="l00892"></a>00892 <span class="comment">    Sending bootloader command: bootoct $(fileaddr) coremask=ffff debug</span>
<a name="l00893"></a>00893 <span class="comment"></span>
<a name="l00894"></a>00894 <span class="comment">    0x10000018 in _init ()</span>
<a name="l00895"></a>00895 <span class="comment">    (Core#0-gdb)</span>
<a name="l00896"></a>00896 <span class="comment">@endverbatim</span>
<a name="l00897"></a>00897 <span class="comment"></span>
<a name="l00898"></a>00898 <span class="comment">    You can also attach to a program that is already running on the board by invoking the</span>
<a name="l00899"></a>00899 <span class="comment">    target octeonpci command with no arguments.  After the target command the cores are</span>
<a name="l00900"></a>00900 <span class="comment">    stopped.</span>
<a name="l00901"></a>00901 <span class="comment"></span>
<a name="l00902"></a>00902 <span class="comment">@verbatim</span>
<a name="l00903"></a>00903 <span class="comment">    $ mipsisa64-octeon-elf-gdb -q passthrough</span>
<a name="l00904"></a>00904 <span class="comment">    (Core#0-gdb) target octeonpci</span>
<a name="l00905"></a>00905 <span class="comment">    Found Octeon on bus 3 in slot 2. BAR0=0xe7fff000, BAR1=0xd8000000</span>
<a name="l00906"></a>00906 <span class="comment">    (Core#0-gdb) bt</span>
<a name="l00907"></a>00907 <span class="comment">    #0  main () at /home/anemet/octsw/sdk/target/include/cvmx-pow.h:360</span>
<a name="l00908"></a>00908 <span class="comment">@endverbatim</span>
<a name="l00909"></a>00909 <span class="comment"></span>
<a name="l00910"></a>00910 <span class="comment">    The detach command or exiting GDB resumes execution of the program.</span>
<a name="l00911"></a>00911 <span class="comment"></span>
<a name="l00912"></a>00912 <span class="comment">    You can use a different remote protocol by changing how the target command is</span>
<a name="l00913"></a>00913 <span class="comment">    used.  Example:</span>
<a name="l00914"></a>00914 <span class="comment">@verbatim</span>
<a name="l00915"></a>00915 <span class="comment">    $ mipsisa64-octeon-elf-gdb -q passthrough</span>
<a name="l00916"></a>00916 <span class="comment">    (Core#0-gdb) target octeon LINUX</span>
<a name="l00917"></a>00917 <span class="comment">@endverbatim</span>
<a name="l00918"></a>00918 <span class="comment"></span>
<a name="l00919"></a>00919 <span class="comment">    You can invoke oct-debug-agent manually to be able to debug oct-debug-agent or</span>
<a name="l00920"></a>00920 <span class="comment">    be able to run the debugger on another computer.  Example:</span>
<a name="l00921"></a>00921 <span class="comment">@verbatim</span>
<a name="l00922"></a>00922 <span class="comment">    $ oct-debug-agent ./passthrough -q --target PCI --listen 38026 --pci-bootcmd oct-pci-boot -- bootoct 0 coremask=ffff</span>
<a name="l00923"></a>00923 <span class="comment">@endverbatim</span>
<a name="l00924"></a>00924 <span class="comment"></span>
<a name="l00925"></a>00925 <span class="comment">@verbatim</span>
<a name="l00926"></a>00926 <span class="comment">Usage: oct-debug-agent &lt;exec_file&gt; &lt;option(s)&gt; [&lt;boot commands&gt;]</span>
<a name="l00927"></a>00927 <span class="comment"></span>
<a name="l00928"></a>00928 <span class="comment"> Listen on &lt;port&gt; for incoming connection fro GDB and perform the</span>
<a name="l00929"></a>00929 <span class="comment"> corresponding operation over the &lt;comm&gt; debug interface.</span>
<a name="l00930"></a>00930 <span class="comment"></span>
<a name="l00931"></a>00931 <span class="comment"> Possible values for &lt;option(s)&gt; are:</span>
<a name="l00932"></a>00932 <span class="comment">  -l, --listen &lt;num&gt;  Port number to listen for GDB connection</span>
<a name="l00933"></a>00933 <span class="comment">  -t, --target &lt; targetstr &gt; (Required)</span>
<a name="l00934"></a>00934 <span class="comment">  -d, --debug         Print debug messages during execution</span>
<a name="l00935"></a>00935 <span class="comment">  -b, --pci-bootcmd &lt;exec&gt;  Set boot command needed for PCI booting</span>
<a name="l00936"></a>00936 <span class="comment">  -q, --quiet         Quiet during execution</span>
<a name="l00937"></a>00937 <span class="comment">  -h, --help          Display help message</span>
<a name="l00938"></a>00938 <span class="comment">@endverbatim</span>
<a name="l00939"></a>00939 <span class="comment"></span>
<a name="l00940"></a>00940 <span class="comment">@section oct-remote-app-ctl 18. Remote controlling hotplugable SE applications.</span>
<a name="l00941"></a>00941 <span class="comment">@verbatim</span>
<a name="l00942"></a>00942 <span class="comment">    This utility is used for start/add_cores/delete_cores/shutdown hotplugable</span>
<a name="l00943"></a>00943 <span class="comment">    SE applications running on Octeon PCIe connected (LiquidIO) card(s) from x86</span>
<a name="l00944"></a>00944 <span class="comment">    HOST computer. Its CLI is same as the &apos;oct-app-ctl&apos; utility CLI present in</span>
<a name="l00945"></a>00945 <span class="comment">    Linux rpm, which can run in Octeon Linux user space on one of the Octeon CPU</span>
<a name="l00946"></a>00946 <span class="comment">    cores on LiquidIO card. However this utility was specially designed per</span>
<a name="l00947"></a>00947 <span class="comment">    customer request in order to free all available Octeon CPU cores for runiing</span>
<a name="l00948"></a>00948 <span class="comment">    data-plane applications. The following lines come from oct-app-ctl README.txt</span>
<a name="l00949"></a>00949 <span class="comment">    file and are valid for both oct-app-ctl and oct-remote-app-ctl utilities.</span>
<a name="l00950"></a>00950 <span class="comment"></span>
<a name="l00951"></a>00951 <span class="comment">    The utility supports 5 basic operations which are described below.</span>
<a name="l00952"></a>00952 <span class="comment">    The specific operation may be either specified in the first argument.</span>
<a name="l00953"></a>00953 <span class="comment"></span>
<a name="l00954"></a>00954 <span class="comment">STARTING APPS</span>
<a name="l00955"></a>00955 <span class="comment">    - # oct-app-ctl boot &lt;options&gt; &lt;app_file_name&gt; [&lt;app_arguments&gt;]</span>
<a name="l00956"></a>00956 <span class="comment"></span>
<a name="l00957"></a>00957 <span class="comment">    &lt;options&gt; are optional, and include these options:</span>
<a name="l00958"></a>00958 <span class="comment"></span>
<a name="l00959"></a>00959 <span class="comment">    -verbose=&lt;num&gt;  Increase verbosity level of the program up to the value of 3</span>
<a name="l00960"></a>00960 <span class="comment">            Default is 0.(LiquidIO)</span>
<a name="l00961"></a>00961 <span class="comment">    -numcores=&lt;N&gt;   The number of CPU cores to start the application on.</span>
<a name="l00962"></a>00962 <span class="comment">            Default is 1.</span>
<a name="l00963"></a>00963 <span class="comment">    -mask=&lt;hex-number&gt;  The coremask of CPUs that the application should be started on.</span>
<a name="l00964"></a>00964 <span class="comment">    -heapsize=&lt;bytes&gt;   Set the size of the heap memory allocated per CPU core.</span>
<a name="l00965"></a>00965 <span class="comment">            Default is 3 Megabytes.</span>
<a name="l00966"></a>00966 <span class="comment">    -stacksize=&lt;bytes&gt;  Set the size of the stack memory allocated per CPU cure.</span>
<a name="l00967"></a>00967 <span class="comment">            Default is 1 Megabytes.</span>
<a name="l00968"></a>00968 <span class="comment"></span>
<a name="l00969"></a>00969 <span class="comment">NOTES:</span>
<a name="l00970"></a>00970 <span class="comment">    Any SE application can be started this way, whether it supports</span>
<a name="l00971"></a>00971 <span class="comment">    hot-plugging or not, but the remaining operations require the support of</span>
<a name="l00972"></a>00972 <span class="comment">    hot-plugging in the application.  The core-mask argument only supports up</span>
<a name="l00973"></a>00973 <span class="comment">    to 64 cores, and should be abandoned in favour of the -numcores argument.</span>
<a name="l00974"></a>00974 <span class="comment">    If the core-mask argument is specified is contains cores that are not</span>
<a name="l00975"></a>00975 <span class="comment">    presently available, the unavailable cores will be replaced with the</span>
<a name="l00976"></a>00976 <span class="comment">    same number of available cores to at least satisfy the core count in</span>
<a name="l00977"></a>00977 <span class="comment">    the requested mask, if possible.</span>
<a name="l00978"></a>00978 <span class="comment"></span>
<a name="l00979"></a>00979 <span class="comment">DISPLAYING STATUS</span>
<a name="l00980"></a>00980 <span class="comment"></span>
<a name="l00981"></a>00981 <span class="comment">    -# oct-app-ctl info</span>
<a name="l00982"></a>00982 <span class="comment"></span>
<a name="l00983"></a>00983 <span class="comment">    The information displayed indicates which SE applications are currently</span>
<a name="l00984"></a>00984 <span class="comment">    running on which cores. It does not specify which cores are being</span>
<a name="l00985"></a>00985 <span class="comment">    currently used by Linux itself. In order to control and display the</span>
<a name="l00986"></a>00986 <span class="comment">    CPU cores running Linux please refer to the Linux CPU hot-plugging</span>
<a name="l00987"></a>00987 <span class="comment">    documentation.</span>
<a name="l00988"></a>00988 <span class="comment"></span>
<a name="l00989"></a>00989 <span class="comment">    The &quot;Active&quot; core mask indicates which applications are capable of</span>
<a name="l00990"></a>00990 <span class="comment">    supporting hot-plugging, which is required for the following operations.</span>
<a name="l00991"></a>00991 <span class="comment"></span>
<a name="l00992"></a>00992 <span class="comment">    The first column displays an index for every instance of an application,</span>
<a name="l00993"></a>00993 <span class="comment">    which is useful for performing any of the remaining operations on</span>
<a name="l00994"></a>00994 <span class="comment">    a specific instance of an applications, should there be multiple</span>
<a name="l00995"></a>00995 <span class="comment">    applications started from the same executable file and thus having the</span>
<a name="l00996"></a>00996 <span class="comment">    same name.</span>
<a name="l00997"></a>00997 <span class="comment"></span>
<a name="l00998"></a>00998 <span class="comment">    The last item displayed by this operation is the coremask of the CPU</span>
<a name="l00999"></a>00999 <span class="comment">    coremask that are presently not utilized, and are thus available for</span>
<a name="l01000"></a>01000 <span class="comment">    starting new applications, or adding into existing ones.</span>
<a name="l01001"></a>01001 <span class="comment"></span>
<a name="l01002"></a>01002 <span class="comment">SHUTTING DOWN APPLICATIONS</span>
<a name="l01003"></a>01003 <span class="comment"></span>
<a name="l01004"></a>01004 <span class="comment">    -# oct-app-ctl shutdown &lt;options&gt; {-index=&lt;app-index&gt; | &lt;app-name&gt;}</span>
<a name="l01005"></a>01005 <span class="comment"></span>
<a name="l01006"></a>01006 <span class="comment">    &lt;options&gt; are optional, and include these options:</span>
<a name="l01007"></a>01007 <span class="comment"></span>
<a name="l01008"></a>01008 <span class="comment">    -verbose=&lt;num&gt;  Increase verbosity level of the program up to</span>
<a name="l01009"></a>01009 <span class="comment">            the value of 3. Default is 0.</span>
<a name="l01010"></a>01010 <span class="comment"></span>
<a name="l01011"></a>01011 <span class="comment">    This operation will shut down a running application on all the CPU cores</span>
<a name="l01012"></a>01012 <span class="comment">    it runs.</span>
<a name="l01013"></a>01013 <span class="comment"></span>
<a name="l01014"></a>01014 <span class="comment">    The above operation as well as all the subsequently described operations</span>
<a name="l01015"></a>01015 <span class="comment">    only work if the application supports hot-plugging, and has installed</span>
<a name="l01016"></a>01016 <span class="comment">    call-back routines to be notified of the request of relinquishing or add</span>
<a name="l01017"></a>01017 <span class="comment">    resources. Please see the example program in &quot;sdk/examples/hotplug_app&quot;</span>
<a name="l01018"></a>01018 <span class="comment">    for additional information.</span>
<a name="l01019"></a>01019 <span class="comment"></span>
<a name="l01020"></a>01020 <span class="comment">    The application effected must be identified either by its name, which is</span>
<a name="l01021"></a>01021 <span class="comment">    identical to the name of the executable object file that was used to start</span>
<a name="l01022"></a>01022 <span class="comment">    the application, or by means of the application instance index number.</span>
<a name="l01023"></a>01023 <span class="comment"></span>
<a name="l01024"></a>01024 <span class="comment">    Note that the executable file needs not be present in the current</span>
<a name="l01025"></a>01025 <span class="comment">    (or any other) directory for this operation to succeed, as it is not</span>
<a name="l01026"></a>01026 <span class="comment">    accessed for any operation other than the &quot;boot&quot; operation.</span>
<a name="l01027"></a>01027 <span class="comment"></span>
<a name="l01028"></a>01028 <span class="comment">ADDING CORES TO AN APPLICATIONS</span>
<a name="l01029"></a>01029 <span class="comment"></span>
<a name="l01030"></a>01030 <span class="comment">    - # oct-app-ctl add &lt;options&gt; {-index= &lt;app-index&gt; | &lt;app-name&gt;}</span>
<a name="l01031"></a>01031 <span class="comment"></span>
<a name="l01032"></a>01032 <span class="comment">    &lt;options&gt; are optional, and include these options:</span>
<a name="l01033"></a>01033 <span class="comment"></span>
<a name="l01034"></a>01034 <span class="comment">    -verbose=&lt;num&gt;  Increase verbosity level of the program up to</span>
<a name="l01035"></a>01035 <span class="comment">            the value of 3. Default is 0.</span>
<a name="l01036"></a>01036 <span class="comment">    -numcores=&lt;N&gt;   The number of CPU cores to start the application on.</span>
<a name="l01037"></a>01037 <span class="comment">            Default is 1.</span>
<a name="l01038"></a>01038 <span class="comment">    -mask=&lt;hex-number&gt;  The coremask of CPUs that the application should be</span>
<a name="l01039"></a>01039 <span class="comment">            started on.</span>
<a name="l01040"></a>01040 <span class="comment"></span>
<a name="l01041"></a>01041 <span class="comment">NOTES:</span>
<a name="l01042"></a>01042 <span class="comment">    The core-mask argument only supports up to 64 cores, and should be abandoned</span>
<a name="l01043"></a>01043 <span class="comment">    in favour of the -numcores argument.</span>
<a name="l01044"></a>01044 <span class="comment"></span>
<a name="l01045"></a>01045 <span class="comment">    If the core-mask argument is specified is contains cores that are not</span>
<a name="l01046"></a>01046 <span class="comment">    presently available, the unavailable cores will be replaced with the</span>
<a name="l01047"></a>01047 <span class="comment">    same number of available cores to at least satisfy the core count in</span>
<a name="l01048"></a>01048 <span class="comment">    the requested mask, if possible.</span>
<a name="l01049"></a>01049 <span class="comment"></span>
<a name="l01050"></a>01050 <span class="comment">DELETING CORES FROM AN APPLICATIONS</span>
<a name="l01051"></a>01051 <span class="comment"></span>
<a name="l01052"></a>01052 <span class="comment">    -# oct-app-ctl del &lt;options&gt; {-index= &lt;app-index&gt; | &lt;app-name&gt;}</span>
<a name="l01053"></a>01053 <span class="comment"></span>
<a name="l01054"></a>01054 <span class="comment">    &lt;options&gt; are optional, and include these options:</span>
<a name="l01055"></a>01055 <span class="comment"></span>
<a name="l01056"></a>01056 <span class="comment">    -verbose=&lt;num&gt;  Increase verbosity level of the program up to</span>
<a name="l01057"></a>01057 <span class="comment">            the value of 3. Default is 0.</span>
<a name="l01058"></a>01058 <span class="comment">    -numcores=&lt;N&gt;   The number of CPU cores to relinquish. Default is 1.</span>
<a name="l01059"></a>01059 <span class="comment">    -mask=&lt;hex-number&gt;  The coremask of CPUs that should be stopped.</span>
<a name="l01060"></a>01060 <span class="comment"></span>
<a name="l01061"></a>01061 <span class="comment">NOTES:</span>
<a name="l01062"></a>01062 <span class="comment">    This operation will refuse to delete the initial core running</span>
<a name="l01063"></a>01063 <span class="comment">    the application, which is the lowest-numbered core that the application</span>
<a name="l01064"></a>01064 <span class="comment">    was initially started on. All other cores, which could be numerically</span>
<a name="l01065"></a>01065 <span class="comment">    lower than the initial core of these where added subsequently to starting</span>
<a name="l01066"></a>01066 <span class="comment">    the application with the aforementioned &quot;add&quot; operation, can be deleted.</span>
<a name="l01067"></a>01067 <span class="comment"></span>
<a name="l01068"></a>01068 <span class="comment">    If a core-mask is specified in the command line, but it includes some</span>
<a name="l01069"></a>01069 <span class="comment">    cores that are not running said application instance, or if the mask</span>
<a name="l01070"></a>01070 <span class="comment">    specifies the initial core, the actual mask will be modified to stop</span>
<a name="l01071"></a>01071 <span class="comment">    the same number of cores as requested in the mask, if possible.</span>
<a name="l01072"></a>01072 <span class="comment"></span>
<a name="l01073"></a>01073 <span class="comment">LIMITATIONS:</span>
<a name="l01074"></a>01074 <span class="comment"></span>
<a name="l01075"></a>01075 <span class="comment">    The utility has only been tested with big-endian executables host,</span>
<a name="l01076"></a>01076 <span class="comment">    and does not presently support little-endian variants of either.</span>
<a name="l01077"></a>01077 <span class="comment"></span>
<a name="l01078"></a>01078 <span class="comment">USE CASES</span>
<a name="l01079"></a>01079 <span class="comment"></span>
<a name="l01080"></a>01080 <span class="comment">    There are many use cases for controlling stand-alone SE applications</span>
<a name="l01081"></a>01081 <span class="comment">    from x86 HOST. One such case is LiquidIO customer request for &apos;live update&apos;,</span>
<a name="l01082"></a>01082 <span class="comment">    where currently running data-plane SE application could be replaced</span>
<a name="l01083"></a>01083 <span class="comment">    dynamically (delete_cores/shutdown the current SE app and boot/add_cores to</span>
<a name="l01084"></a>01084 <span class="comment">    another SE app on the same core(s)) with its next improved version.</span>
<a name="l01085"></a>01085 <span class="comment">    There is a shell script (burn_hp.sh) demonstarting this feature, which also</span>
<a name="l01086"></a>01086 <span class="comment">    is used for testing.</span>
<a name="l01087"></a>01087 <span class="comment">    In the most simple case, it allows packaging the entire</span>
<a name="l01088"></a>01088 <span class="comment">    application, including control and data plane in a single embedded</span>
<a name="l01089"></a>01089 <span class="comment">    root file system, or enabling a &quot;live&quot; upgrade of the data-plane</span>
<a name="l01090"></a>01090 <span class="comment">    portion wuthout rebooting the control plane.</span>
<a name="l01091"></a>01091 <span class="comment"></span>
<a name="l01092"></a>01092 <span class="comment">    Other use cases include the dynamic load balancing where the number</span>
<a name="l01093"></a>01093 <span class="comment">    of CPU cores can be shiften between data-plane SE application to match</span>
<a name="l01094"></a>01094 <span class="comment">    changing load patterns dynamically.</span>
<a name="l01095"></a>01095 <span class="comment">@endverbatim</span>
<a name="l01096"></a>01096 <span class="comment">*/</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 27 Oct 2017 for Octeon Software Development Kit by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
