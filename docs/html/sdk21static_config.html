<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Octeon Software Development Kit: A Static Configuration Scheme in SDK-2.1 (Experimental)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="sdk21static_config">A Static Configuration Scheme in SDK-2.1 (Experimental) </a></h1><ul>
<li><a class="el" href="sdk21static_config.html#sdk21stcfg_intro">1. Introduction</a></li>
<li><a class="el" href="sdk21static_config.html#sdk21stcfg_iface">2. Interface and port</a></li>
<li><a class="el" href="sdk21static_config.html#sdk21stcfg_file">3. The cvmx-ucfg config file</a></li>
<li><a class="el" href="sdk21static_config.html#sdk21stcfg_ucfgpy">4. cvmx-ucfg.py</a></li>
</ul>
<h2><a class="anchor" id="sdk21stcfg_intro">
1. Introduction</a></h2>
<p>The cvmx-ucfg tool allows the OCTEON SDK user to allocate resource statically. The need for this is partly introduced by the OCTEON CN68XX.</p>
<p>The examples in this manual are based on the default hw configuration in the OCTEON CN68XX simulator.</p>
<p>Note that this tool is not officially supported.</p>
<h2><a class="anchor" id="sdk21stcfg_iface">
2. Interface and port</a></h2>
<p>The following interfaces are valid for CN68XX </p>
<div class="fragment"><pre class="fragment">
	"gmx0"
	"gmx1"
	"gmx2"
	"gmx3"
	"gmx4"
	"ilk0"
	"ilk1"
	"npi"
	"loop"
</pre></div><p>A port on an interface is uniquely identified by the (interface, index) pair, where the index's value is in the range of [0, max number of ports on the interface).</p>
<p>The max number of ports (<b>max_nport</b>) on an interface is fixed for npi(32), ilk(8), and loop(8). It is determined by the interface's mode in the case of the gmx (4 for SGMII and 1 for XAUI/RXAUI).</p>
<p>In this manual, we sometimes use <b>physical port</b> to mean a port on an interface and to differentiate from other ports, e.g., the PKO internal port which is also known as the PKO port.</p>
<h2><a class="anchor" id="sdk21stcfg_file">
3. The cvmx-ucfg config file</a></h2>
<p>The user configuration file is a Python source file that defines one or more of the following entities.</p>
<p>3.1. cvmx_ucfg_pko_nport{}</p>
<p>This dictionary maps an interface name to a vector of <b>pko_nport</b> values for all the ports (from 0 to max_nport). A pko_nport specifies the number of PKO internal ports assigned to a physical port.</p>
<p>cvmx_ucfg_pko_nport{} is optional. If it is defined, it does not have to include all the interfaces. If an interface is present in the dictionary, pko_nport values for its ports are assigned sequentially. For the physical ports not assigned a pko_nport explicitly, the default value is 1.</p>
<p>For example, </p>
<div class="fragment"><pre class="fragment">
	cvmx_ucfg_pko_nport = {
	    'gmx3' : [1, 3, 3, 1],
	}
</pre></div><p> defines that the four physical ports on gmx3 have one, three, three, and one PKO ports, respectively.</p>
<p>3.2. cvmx_ucfg_pko_nqueues{}</p>
<p>This dictionary maps an interface name to a dictionary. The 2nd dictionary maps the index of a physical port to a vector of numbers of PKO queues (<b>pko_nqueue</b>) assigned to the port's PKO ports.</p>
<p>cvmx_ucfg_pko_nqueue{} does not have to be defined. If it is, it does not have to include all the interfaces. If an interface is present, the user does not have to assign pko_nqueues for the PKO ports on each physical port. If a physical port is present, pko_nqueues are assigned sequentially for the PKO ports of the physical port. For the PKO ports not explicitly assigned, each is given one PKO queues.</p>
<p>For example, </p>
<div class="fragment"><pre class="fragment">
	cvmx_ucfg_pko_nqueue = {
	    'gmx0' : { 0 : [32] },
	}
</pre></div><p> specifies that the first PKO port on the first port of the gmx0 interface has 32 queues. Each of the other assigned PKO ports has by default one PKO queue.</p>
<p><b>Note that if cvmx_ucfg_pko_nport and cvmx_ucfg_pko_nqueue indicate different numbers of PKO ports for a physical port, the smaller one prevails.</b> This means if the user specifies pko_nqueues for more PKO ports than assigned to a physical port, the extra pko_nqueues are ignored.</p>
<h2><a class="anchor" id="sdk21stcfg_ucfgpy">
4. cvmx-ucfg.py</a></h2>
<p>This program parses the config file specified in the environment variable CVMX_UCFG_FILE and generates the code for customer configuration to be included in __cvmx_helper_cfg_init(). Here are the steps.</p>
<div class="fragment"><pre class="fragment">
   1. Specify the configuration in a file using the syntax as defined
      above and set the environment variable CVMX_UCFG_FILE to be the
      path of this file.

   2. Run cvmx-ucfg.py and redirect the output to 
      config/cvmx-helper-cfg-init.c. This is to be included in the
      __cvmx_helper_cfg_init() function and therefore subject to the C
      preprocessing rules.

   3. Define CVMX_USER_DEFINED_HELPER_CONFIG_INIT in the application's
      config/executive-config.h.

</pre></div> </div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 27 Oct 2017 for Octeon Software Development Kit by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
